[{"content":" æœ¬æ–‡åªè®°å½•ä¸€äº›ä¸ªäººè§‰å¾—æ¯”è¾ƒå®¹æ˜“é—å¿˜æˆ–éœ€è¦æ³¨æ„çš„ç‚¹ï¼ŒæŠ‘æˆ–æ˜¯ä¸€äº›è·Ÿæœ¬äººæ¥è§¦è¿‡çš„å…¶ä»–é™æ€è¯­è¨€ä¸å¤ªä¸€æ ·çš„è¯­æ³•ï¼Œå¹¶ä¸æ˜¯ä¸€ä»½å®Œæ•´çš„å­¦ä¹ æ•™ç¨‹ã€‚\n\u0026nbsp;å‡½æ•°ç±»å‹çš„ä¹¦å†™ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // å‡½æ•°ç±»å‹ function info(username: string, age: number): number { return age; } type Func = (username: string, age: number) =\u0026gt; number; let info: Func = function (username, age) { return age; }; let info = (username: string, age: number): number =\u0026gt; { return age; }; // æ¥å£å½“åå­—çš„å‡½æ•°ç±»å‹ interface ActionContext { (state: any, commit: any): void; } let actionContext: ActionContext = (state, commit) =\u0026gt; { console.log(state); }; \u0026nbsp;å¼‚æ­¥å‡½æ•°ã€Generator å‡½æ•°ç­‰ç±»å‹ç­¾å 1 2 3 4 5 async function asyncFunc(): Promise\u0026lt;void\u0026gt; {} function* genFunc(): Iterable\u0026lt;void\u0026gt; {} async function* asyncGenFunc(): AsyncIterable\u0026lt;void\u0026gt; {} \u0026nbsp;objectã€Object ä»¥åŠ { } åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œä½ éƒ½ä¸åº”è¯¥ä½¿ç”¨ Objectã€String ç­‰è¿™äº›è£…ç®±ç±»å‹\nobject çš„å¼•å…¥å°±æ˜¯ä¸ºäº†è§£å†³å¯¹ Object ç±»å‹çš„é”™è¯¯ä½¿ç”¨ï¼Œå®ƒä»£è¡¨æ‰€æœ‰éåŸå§‹ç±»å‹çš„ç±»å‹ï¼Œå³æ•°ç»„ã€å¯¹è±¡ä¸å‡½æ•°ç±»å‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 //åœ¨ TypeScript ä¸­å°±è¡¨ç°ä¸º Object åŒ…å«äº†æ‰€æœ‰çš„ç±»å‹: const tmp1: Object = undefined; const tmp2: Object = null; const tmp3: Object = void 0; const tmp4: Object = \u0026#34;zzydev\u0026#34;; const tmp5: Object = 233; const tmp6: Object = { name: \u0026#34;zzydev\u0026#34; }; const tmp7: Object = () =\u0026gt; {}; const tmp8: Object = []; /* å’Œ Object ç±»ä¼¼çš„è¿˜æœ‰ Booleanã€Numberã€Stringã€Symbolï¼Œè¿™å‡ ä¸ªè£…ç®±ç±»å‹åŒæ ·åŒ…å«äº†ä¸€äº›è¶…å‡ºé¢„æœŸçš„ç±»å‹ã€‚ ä»¥ String ä¸ºä¾‹ï¼Œå®ƒåŒæ ·åŒ…æ‹¬ undefinedã€nullã€voidï¼Œä»¥åŠä»£è¡¨çš„æ‹†ç®±ç±»å‹stringï¼Œ ä½†å¹¶ä¸åŒ…æ‹¬å…¶ä»–è£…ç®±ç±»å‹å¯¹åº”çš„æ‹†ç®±ç±»å‹ï¼Œå¦‚booleanä¸åŸºæœ¬å¯¹è±¡ç±»å‹ï¼Œ */ const tmp9: String = undefined; const tmp10: String = null; const tmp11: String = void 0; const tmp12: String = \u0026#34;zzydev\u0026#34;; const tmp13: String = 233; // â const tmp14: String = { name: \u0026#34;zzydev\u0026#34; }; // â const tmp15: String = () =\u0026gt; {}; // â const tmp16: String = []; // â //{}ä½œä¸ºç±»å‹ç­¾åå°±æ˜¯ä¸€ä¸ªåˆæ³•çš„ï¼Œä½†å†…éƒ¨æ— å±æ€§å®šä¹‰çš„ç©ºå¯¹è±¡ï¼Œè¿™ç±»ä¼¼äºObjectï¼Œâš ï¸å®ƒæ„å‘³ç€ä»»ä½•énull/undefinedçš„å€¼ï¼š const tmp25: {} = undefined; // â const tmp26: {} = null; // â const tmp27: {} = void 0; // â const tmp28: {} = \u0026#34;zzydev\u0026#34;; const tmp29: {} = 233; const tmp30: {} = { name: \u0026#34;zzydev\u0026#34; }; const tmp31: {} = () =\u0026gt; {}; const tmp32: {} = []; //âš ï¸ è™½ç„¶èƒ½å¤Ÿå°†å…¶ä½œä¸ºå˜é‡çš„ç±»å‹ï¼Œä½†ä½ å®é™…ä¸Šæ— æ³•å¯¹è¿™ä¸ªå˜é‡è¿›è¡Œä»»ä½•èµ‹å€¼æ“ä½œï¼š const tmp30: {} = { name: \u0026#34;zzydev\u0026#34; }; tmp30.age = 18; // â ç±»å‹â€œ{}â€ä¸Šä¸å­˜åœ¨å±æ€§â€œageâ€ã€‚ const tmp31: Object = { name: \u0026#34;zzydev\u0026#34; }; tmp31.age = 18; // â å±æ€§nameä¸å­˜åœ¨äºç±»å‹Objectä¸Š å½“ä½ ä¸ç¡®å®šæŸä¸ªå˜é‡çš„å…·ä½“ç±»å‹ï¼Œä½†èƒ½ç¡®å®šå®ƒä¸æ˜¯åŸå§‹ç±»å‹ï¼Œæ¨è ğŸ‘ ä½¿ç”¨ Record\u0026lt;string, unknown\u0026gt; æˆ– Record\u0026lt;string, any\u0026gt; è¡¨ç¤ºå¯¹è±¡ï¼Œunknown[] æˆ– any[] è¡¨ç¤ºæ•°ç»„ï¼Œ(...args: any[]) =\u0026gt; anyè¡¨ç¤ºå‡½æ•°è¿™æ ·ã€‚åŒæ ·è¦é¿å…ä½¿ç”¨{}ã€‚{}æ„å‘³ç€ä»»ä½•énull/undefinedçš„å€¼ï¼Œä»è¿™ä¸ªå±‚é¢ä¸Šçœ‹ï¼Œä½¿ç”¨å®ƒå’Œä½¿ç”¨anyä¸€æ ·æ¶åŠ£ã€‚\n\u0026nbsp;å¯¹è±¡å–å€¼çš„å‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 let obj = {username: \u0026#34;zzy\u0026#34;, age: 18} // ç±»å‹æ¨å¯¼ obj[\u0026#34;username\u0026#34;] // âœ… //let å£°æ˜ï¼Œåªéœ€è¦æ¨å¯¼è‡³è¿™ä¸ªå€¼ä»å±çš„ç±»å‹å³å¯ã€‚ usernameåœ¨è¿™é‡Œæ˜¯stringç±»å‹ let username = \u0026#34;username\u0026#34; obj[username] // â //è€Œ const å£°æ˜çš„åŸå§‹ç±»å‹å˜é‡å°†ä¸å†å¯å˜ï¼Œå› æ­¤ç±»å‹å¯ä»¥ç›´æ¥ä¸€æ­¥åˆ°ä½æ”¶çª„åˆ°æœ€ç²¾ç¡®çš„å­—é¢é‡ç±»å‹ // usernameåœ¨è¿™é‡Œæ˜¯â€usernameâ€œå­—é¢é‡ç±»å‹ const username = \u0026#34;username\u0026#34; obj[username] // âœ… -------------------------------------------------- let obj:object | Object = {username: \u0026#34;zzy\u0026#34;, age: 18} const username = \u0026#34;username\u0026#34; let res = obj[username] // â let res = (obj as any)[username] // âœ… å¯¹äº let å£°æ˜ï¼Œåªéœ€è¦æ¨å¯¼è‡³è¿™ä¸ªå€¼ä»å±çš„ç±»å‹å³å¯ã€‚è€Œ const å£°æ˜çš„åŸå§‹ç±»å‹å˜é‡å°†ä¸å†å¯å˜ï¼Œå› æ­¤ç±»å‹å¯ä»¥ç›´æ¥ä¸€æ­¥åˆ°ä½æ”¶çª„åˆ°æœ€ç²¾ç¡®çš„å­—é¢é‡ç±»å‹ï¼Œä½†å¯¹è±¡ç±»å‹å˜é‡ä»å¯å˜ï¼ˆä½†åŒæ ·ä¼šè¦æ±‚å…¶å±æ€§å€¼ç±»å‹ä¿æŒä¸€è‡´ï¼‰ã€‚ \u0026nbsp;è”åˆç±»å‹ ä»¬è¿˜å¯ä»¥å°†å„ç§ç±»å‹æ··åˆåˆ°ä¸€èµ·:\n1 2 3 interface Tmp { mixed: true | string | 599 | {} | (() =\u0026gt; {}) | (1 | 2); } è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„ï¼š\nå¯¹äºè”åˆç±»å‹ä¸­çš„å‡½æ•°ç±»å‹ï¼Œéœ€è¦ä½¿ç”¨æ‹¬å·()åŒ…è£¹èµ·æ¥ å‡½æ•°ç±»å‹å¹¶ä¸å­˜åœ¨å­—é¢é‡ç±»å‹ï¼Œå› æ­¤è¿™é‡Œçš„ (() =\u0026gt; {}) å°±æ˜¯ä¸€ä¸ªåˆæ³•çš„å‡½æ•°ç±»å‹ ä½ å¯ä»¥åœ¨è”åˆç±»å‹ä¸­è¿›ä¸€æ­¥åµŒå¥—è”åˆç±»å‹ï¼Œä½†è¿™äº›åµŒå¥—çš„è”åˆç±»å‹æœ€ç»ˆéƒ½ä¼šè¢«å±•å¹³åˆ°ç¬¬ä¸€çº§ä¸­ è”åˆç±»å‹çš„å¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯é€šè¿‡å¤šä¸ªå¯¹è±¡ç±»å‹çš„è”åˆï¼Œæ¥å®ç°æ‰‹åŠ¨çš„äº’æ–¥å±æ€§ï¼Œå³è¿™ä¸€å±æ€§å¦‚æœæœ‰å­—æ®µ 1ï¼Œé‚£å°±æ²¡æœ‰å­—æ®µ 2ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 interface Tmp { user: | { vip: true; expires: string; } | { vip: false; promotion: string; }; } declare var tmp: Tmp; if (tmp.user.vip) { console.log(tmp.user.expires); } \u0026nbsp;never never ç±»å‹ä¸æºå¸¦ä»»ä½•çš„ç±»å‹ä¿¡æ¯ï¼Œå› æ­¤ä¼šåœ¨è”åˆç±»å‹ä¸­è¢«ç›´æ¥ç§»é™¤ void å’Œ never çš„ç±»å‹å…¼å®¹æ€§ï¼š never æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ï¼Œä½†åªæœ‰ never ç±»å‹çš„å˜é‡èƒ½å¤Ÿèµ‹å€¼ç»™å¦ä¸€ä¸ª never ç±»å‹å˜é‡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 declare let v1: never; declare let v2: void; v1 = v2; // â ç±»å‹ void ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ never v2 = v1; //æŠ›å‡ºé”™è¯¯çš„å‡½æ•°è¿”å›neverç±»å‹ function justThrow(): never { throw new Error(); } //åœ¨ç±»å‹æµçš„åˆ†æä¸­ï¼Œä¸€æ—¦ä¸€ä¸ªè¿”å›å€¼ç±»å‹ä¸ºneverçš„å‡½æ•°è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆä¸‹æ–¹çš„ä»£ç éƒ½ä¼šè¢«è§†ä¸ºæ— æ•ˆçš„ä»£ç ï¼ˆå³æ— æ³•æ‰§è¡Œåˆ°ï¼‰ï¼š function foo(input: number) { if (input \u0026gt; 1) { justThrow(); // ç­‰åŒäº return è¯­å¥åçš„ä»£ç ï¼Œå³ Dead Code const name = \u0026#34;zzydev\u0026#34;; } } never çš„åº”ç”¨åœºæ™¯ä¹‹ä¸€ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // dataFlowAnalysisWithNever æ–¹æ³•ç©·å°½äº† DataFlow çš„æ‰€æœ‰å¯èƒ½ç±»å‹ã€‚ // ä½¿ç”¨ never é¿å…å‡ºç°æœªæ¥æ‰©å±•æ–°çš„ç±»æ²¡æœ‰å¯¹åº”ç±»å‹çš„å®ç°, ç›®çš„å°±æ˜¯å†™å‡ºç±»å‹ç»å¯¹å®‰å…¨çš„ä»£ç ã€‚ type DataFlow = string | number; function dataFlowAnalysisWithNever(dataFlow: DataFlow) { if (typeof dataFlow === \u0026#34;string\u0026#34;) { console.log(\u0026#34;å­—ç¬¦ä¸²ç±»å‹:\u0026#34;, dataFlow.length); } else if (typeof dataFlow === \u0026#34;number\u0026#34;) { console.log(\u0026#34;æ•°å€¼ç±»å‹:\u0026#34;, dataFlow.toFixed(2)); } else { let data = dataFlow; // dataç°åœ¨ä¸ºneverç±»å‹ï¼Œå‡å¦‚ä»¥åDateFlowçš„ç±»å‹åŠ ä¸Šboolean,é‚£dataå°±å˜æˆbooleanç±»å‹ } } dataFlowAnalysisWithNever(\u0026#34;zzy\u0026#34;); dataFlowAnalysisWithNever(3.1415926); \u0026nbsp;æ•°å­—æšä¸¾å’Œå­—ç¬¦ä¸²æšä¸¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 //æ•°å­—æšä¸¾ enum A { A = 10, B = 12, // æ²¡æœ‰å†™å€¼ï¼Œé»˜è®¤ä»¥ä¸Šä¸€ä¸ªå€¼è‡ªå¢1 C, D, } console.log(A[\u0026#34;B\u0026#34;]); // 12 æ•°å­—æšä¸¾ å¯ä»¥åŒé‡æ˜ å°„ ç”±é”®åˆ°å€¼ï¼Œä¹Ÿå¯ä»¥ç”±å€¼åˆ°é”® console.log(A[10]); // A // åœ¨æ•°å­—å‹æšä¸¾ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å»¶è¿Ÿæ±‚å€¼çš„æšä¸¾å€¼: const returnNum = () =\u0026gt; 100 + 499; enum Items { Foo = returnNum(), Bar = 599, Baz, } //âš ï¸æ³¨æ„ï¼Œå»¶è¿Ÿæ±‚å€¼çš„æšä¸¾å€¼æ˜¯æœ‰æ¡ä»¶çš„ã€‚ //å¦‚æœä½ ä½¿ç”¨äº†å»¶è¿Ÿæ±‚å€¼ï¼Œé‚£ä¹ˆæ²¡æœ‰ä½¿ç”¨å»¶è¿Ÿæ±‚å€¼çš„æšä¸¾æˆå‘˜å¿…é¡»æ”¾åœ¨ä½¿ç”¨å¸¸é‡æšä¸¾å€¼å£°æ˜çš„æˆå‘˜ä¹‹åï¼Œæˆ–è€…æ”¾åœ¨ç¬¬ä¸€ä½ï¼š enum Items { First, // ç¬¬ä¸€ä½ Foo = returnNum(), //è¿™é‡Œä¸èƒ½æ”¾æœªèµ‹å€¼æˆå‘˜ Bar = 599, Baz, // å¸¸é‡æšä¸¾æˆå‘˜ä¹‹å } // å¸¸é‡æšä¸¾ const enum Items { Foo, Bar, Baz, } //å¯¹äºå¸¸é‡æšä¸¾ï¼Œä½ åªèƒ½é€šè¿‡æšä¸¾æˆå‘˜è®¿é—®æšä¸¾å€¼ï¼ˆè€Œä¸èƒ½é€šè¿‡å€¼è®¿é—®æˆå‘˜ï¼‰ const fooValue = Items.Foo; // ç¼–è¯‘äº§ç‰©: const fooValue = 0 /* Foo */; // 0 // å­—ç¬¦ä¸²æšä¸¾ enum WeekEnd { Monday = \u0026#34;monday\u0026#34;, Tuesday = \u0026#34;tuesday\u0026#34;, Wensday = \u0026#34;wensday\u0026#34;, ThirsDay = \u0026#34;thirsDay\u0026#34;, Friday = \u0026#34;friday\u0026#34;, Sarturday = \u0026#34;sarturday\u0026#34;, Sunday = \u0026#34;sunday\u0026#34;, } console.log(WeekEnd.Monday); console.log(WeekEnd[\u0026#34;Monday\u0026#34;]); console.log(WeekEnd[\u0026#34;monday\u0026#34;]); // â ä¸èƒ½åå‘æ˜ å°„ console.log(weekEnd[1]); // â \u0026nbsp;æšä¸¾çš„ç¼–è¯‘æˆES5çš„çœŸé¢ç›® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 //è¿™å°±æ˜¯æ•°å­—æšä¸¾åŒå‘æ˜ å°„çš„åŸå›  var A; (function (A) { A[(A[\u0026#34;A\u0026#34;] = 10)] = \u0026#34;A\u0026#34;; A[(A[\u0026#34;B\u0026#34;] = 12)] = \u0026#34;B\u0026#34;; A[(A[\u0026#34;C\u0026#34;] = 13)] = \u0026#34;C\u0026#34;; A[(A[\u0026#34;D\u0026#34;] = 14)] = \u0026#34;D\u0026#34;; })(A || (A = {})); var WeekEnd; (function (WeekEnd) { WeekEnd[\u0026#34;Monday\u0026#34;] = \u0026#34;monday\u0026#34;; WeekEnd[\u0026#34;Tuesday\u0026#34;] = \u0026#34;tuesday\u0026#34;; WeekEnd[\u0026#34;Wensday\u0026#34;] = \u0026#34;wensday\u0026#34;; WeekEnd[\u0026#34;ThirsDay\u0026#34;] = \u0026#34;thirsDay\u0026#34;; WeekEnd[\u0026#34;Friday\u0026#34;] = \u0026#34;friday\u0026#34;; WeekEnd[\u0026#34;Sarturday\u0026#34;] = \u0026#34;sarturday\u0026#34;; WeekEnd[\u0026#34;Sunday\u0026#34;] = \u0026#34;sunday\u0026#34;; })(WeekEnd || (WeekEnd = {})); \u0026nbsp;å¯é€‰å‚æ•°ä¸restå‚æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // åœ¨å‡½æ•°é€»è¾‘ä¸­æ³¨å…¥å¯é€‰å‚æ•°é»˜è®¤å€¼ //âš ï¸å¯é€‰å‚æ•°å¿…é¡»ä½äºå¿…é€‰å‚æ•°ä¹‹å function foo1(name: string, age?: number): number { const inputAge = age || 18; // ä½¿ç”¨ age æˆ–è€… 18 return name.length + inputAge; } // ç›´æ¥ä¸ºå¯é€‰å‚æ•°å£°æ˜é»˜è®¤å€¼ function foo2(name: string, age: number = 18): number { const inputAge = age; return name.length + inputAge; } // restå‚æ•° function foo(arg1: string, ...rest: any[]) {} // ä½¿ç”¨å…ƒç»„ç±»å‹è¿›è¡Œæ ‡æ³¨ function foo(arg1: string, ...rest: [number, boolean]) {} \u0026nbsp;å‡½æ•°é‡è½½ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 type MessageType = \u0026#34;image\u0026#34; | \u0026#34;audio\u0026#34; | string; //å¾®ä¿¡æ¶ˆæ¯ç±»å‹ type Message = { id: number; type: MessageType; sendmessage: string; }; let messages: Message[] = [ //let messages: Array\u0026lt;Message\u0026gt; = [ { id: 1, type: \u0026#34;image\u0026#34;, sendmessage: \u0026#34;æˆ‘è¦æ¶©æ¶©.png\u0026#34;, }, { id: 2, type: \u0026#34;audio\u0026#34;, sendmessage: \u0026#34;æ·±å¤œåœ¨æµ…è‰²åºŠå•ç—›å“­å¤±å£°.mp4\u0026#34;, }, { id: 3, type: \u0026#34;audio\u0026#34;, sendmessage: \u0026#34;ä½ å¹²å˜›~(ikunçº¯äº«ç‰ˆ).flac\u0026#34;, }, { id: 4, type: \u0026#34;image\u0026#34;, sendmessage: \u0026#34;ä¸å¯ä»¥æ¶©æ¶©.png\u0026#34;, }, { id: 5, type: \u0026#34;image\u0026#34;, sendmessage: \u0026#34;åŒ»ä¸šä¸çœŸï¼Œé‰´å®šä¸ºä¹åå‰²å‡ æŠŠ.png\u0026#34;, }, ]; //ä¸ç”¨å‡½æ•°é‡è½½æ¥å®ç° //å‡½æ•°ç»“æ„ä¸åˆ†æ˜,å¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§å˜å·® function getMessage( value: number | MessageType ): Message | undefined | Array\u0026lt;Message\u0026gt; { if (typeof value === \u0026#34;number\u0026#34;) { return messages.find((msg) =\u0026gt; value === msg.id); } else { return messages.filter((msg) =\u0026gt; value === msg.type); } } console.log(getMessage(\u0026#34;audio\u0026#34;)); // TSæ²¡æœ‰åŠæ³•è¿è¡Œä¹‹å‰æ ¹æ®ä¼ é€’çš„å€¼æ¥æ¨å¯¼æ–¹æ³•æœ€ç»ˆè¿”å›çš„æ•°æ®çš„æ•°æ®ç±»å‹ // åªå¯ä»¥æ ¹æ®æ–¹æ³•å®šä¹‰çš„ç±»å‹å±•ç° //let msg=getMessage(1) //âš ï¸ console.log(msg.sendMessage)//é”™è¯¯ ç±»å‹â€œMessage | Message[]â€ä¸Šä¸å­˜åœ¨å±æ€§â€œsendMessageâ€ã€‚ // ç±»å‹â€œMessageâ€ä¸Šå­˜åœ¨å±æ€§â€œsendMessageâ€ let msg = (\u0026lt;Message\u0026gt;getMessage(1)).sendmessage; console.log(\u0026#34;msg:\u0026#34;, msg); function getMessage(value: number): Message; //ç¬¬ä¸€ä¸ªæ ¹æ®æ•°å­—idæ¥æŸ¥è¯¢å•ä¸ªæ¶ˆæ¯çš„é‡è½½ç­¾å function getMessage(value: MessageType, readRecordCount: number): Message[]; //ç¬¬äºŒä¸ªæ ¹æ®æ¶ˆæ¯ç±»å‹æ¥æŸ¥è¯¢æ¶ˆæ¯æ•°ç»„çš„é‡è½½ç­¾å //å®ç°ç­¾åå‚æ•°ä¸ªæ•°å¯ä»¥å°‘äºé‡è½½ç­¾åçš„å‚æ•°ä¸ªæ•°ï¼Œä½†å®ç°ç­¾åå¦‚æœå‡†å¤‡åŒ…å«é‡è½½ç­¾åçš„æŸä¸ªä½ç½®çš„å‚æ•° ï¼Œé‚£å®ç°ç­¾åå°±å¿…é¡»å…¼å®¹æ‰€æœ‰é‡è½½ç­¾åè¯¥ä½ç½®çš„å‚æ•°ç±»å‹ã€è”åˆç±»å‹æˆ– any æˆ– unknown ç±»å‹çš„ä¸€ç§ã€‘ã€‚ //ä¸ç®¡é‡è½½ç­¾åè¿”å›å€¼ç±»å‹æ˜¯ä½•ç§ç±»å‹ï¼Œå®ç°ç­¾åéƒ½å¯ä»¥è¿”å› any ç±»å‹ æˆ– unknownç±»å‹ï¼Œå½“ç„¶ä¸€èˆ¬æˆ‘ä»¬ä¸¤è€…éƒ½ä¸é€‰æ‹©ï¼Œè®© TS é»˜è®¤ä¸ºå®ç°ç­¾åè‡ªåŠ¨æ¨å¯¼è¿”å›å€¼ç±»å‹ã€‚ //ç”±äºå®ç°ç­¾åç¬¬äºŒä¸ªå‚æ•°æœ‰é»˜è®¤å€¼ï¼Œæ‰€ä»¥è¿™é‡Œçš„é‡è½½ç­¾åå¯ä»¥æ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥åœ¨å®ç°ç­¾åçš„å‚æ•°åŠ ä¸Šå¯é€‰? function getMessage(value: any, value2: any = 1) { // function getMessage(value: any, value2?: any) { if (typeof value === \u0026#34;number\u0026#34;) { return messages.find((msg) =\u0026gt; { return msg === msg.id; }); } else { return messages.filter((msg) =\u0026gt; value === msg.type).splice(0, value2); } } getMessage(1); \u0026nbsp;ç±»å£°æ˜å’Œç±»è¡¨è¾¾å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 // ç±»å£°æ˜ class Foo { // =========é€šè¿‡æ„é€ å‡½æ•°ä¸ºç±»æˆå‘˜èµ‹å€¼ ================ private prop: string; constructor(inputProp: string) { this.prop = inputProp; } // ============================================== // ä¸Šé¢ä»£ç å¯ä»¥ç®€å†™ä¸ºè¿™ä¸€è¡Œï¼š constructor(private prop: string) {} protected print(addon: string): void { console.log(`${this.prop} and ${addon}`); } public get propA(): string { return `${this.prop}+A`; } // âš ï¸ setter æ–¹æ³•ä¸å…è®¸è¿›è¡Œè¿”å›å€¼çš„ç±»å‹æ ‡æ³¨ public set propA(value: string) { this.prop = `${value}+A`; } } // ç±»è¡¨è¾¾å¼ const Foo = class { prop: string; constructor(inputProp: string) { this.prop = inputProp; } print(addon: string): void { console.log(`${this.prop} and ${addon}`); } // ... }; \u0026nbsp;staticä¸å•ä»¶è®¾è®¡æ¨¡å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 // ç¬¬ä¸€æ­¥ï¼šæŠŠæ„é€ å™¨è®¾ç½®ä¸ºç§æœ‰çš„ï¼Œä¸å…è®¸å¤–éƒ¨æ¥åˆ›å»ºç±»çš„å¯¹è±¡ // ç¬¬äºŒæ­¥: è‡³å°‘åº”è¯¥æä¾›ä¸€ä¸ªå¤–éƒ¨è®¿é—®çš„æ–¹æ³•æˆ–å±æ€§ï¼Œå¤–éƒ¨å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æˆ–å±æ€§æ¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ // æ‰€ä»¥åº”è¯¥æŠŠè¿™ä¸ªæ–¹æ³•è®¾ç½®ä¸ºé™æ€æ–¹æ³• // ç¬¬ä¸‰æ­¥ï¼šå¤–éƒ¨è°ƒç”¨ç¬¬äºŒæ­¥æä¾›çš„é™æ€æ–¹æ³•æ¥è·å–ä¸€ä¸ªå¯¹è±¡ // æ‡’æ±‰å¼ export default class MyLocalStorage { static localstorage: MyLocalStorage//é™æ€å¼•ç”¨å±æ€§ static count: number = 3;//é™æ€çš„åŸºæœ¬ç±»å‹å±æ€§ private constructor() { console.log(\u0026#34;è¿™æ˜¯TSçš„å•ä»¶è®¾è®¡æ¨¡å¼çš„é™æ€æ–¹æ³•çš„æ„é€ å™¨\u0026#34;); } // æä¾›ä¸€ä¸ªå¤–éƒ¨è®¿é—®çš„æ–¹æ³•, // é€šè¿‡è¿™ä¸ªæ–¹æ³•ç”¨æ¥æä¾›å¤–éƒ¨å¾—åˆ°ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³• // 1. å¸¦staticå…³é”®å­—çš„æ–¹æ³•å°±æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³• // 2. é™æ€æ–¹æ³•å’Œå¯¹è±¡æ— å…³ï¼Œå¤–éƒ¨çš„å¯¹è±¡å˜é‡ä¸èƒ½è°ƒç”¨é™æ€æ–¹æ³•å’Œé™æ€å±æ€§ï¼Œ // 3. å¤–éƒ¨å¯ä»¥é€šè¿‡ç±»åæ¥è°ƒç”¨ // é™æ€æ–¹æ³•ä¸å¯ä»¥è®¿é—®å®ä¾‹å±æ€§æˆ–å®ä¾‹æ–¹æ³• public static getInstance() { // é™æ€æ–¹æ³•é€šè¿‡thisæ¥è·å–é™æ€æˆå‘˜ if (!this.localstorage) {//å¦‚æœé™æ€å¯¹è±¡å±æ€§æŒ‡å‘åˆ›å»ºå¯¹è±¡ console.log(\u0026#34;æˆ‘æ˜¯ä¸€ä¸ªundefinedçš„é™æ€å±æ€§ï¼Œç”¨æ¥æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ç©ºé—´çš„é™æ€å±æ€§\u0026#34;) this.localstorage = new MyLocalStorage() } return this.localstorage } public setItem(key: string, value: any) { localStorage.setItem(key, JSON.stringify(value)) } public getItem(key: string) { let value = localStorage.getItem(key) return value != null ? JSON.parse(value) : null; } } /* let oo = new MyLocalStorage.getInstance(); //â é”™è¯¯ TSå·²ç»å±è”½äº†å»newä¸€ä¸ªç±»ä¸­çš„æ–¹æ³• MyLocalStorage.prototype.newFn = function () {} //â é”™è¯¯ TSç±»å¯ä»¥è®¿é—®prototypeåŸå‹å¯¹è±¡å±æ€§ï¼Œä½†æ— æ³•åœ¨prototypeåŸå‹å¯¹è±¡å±æ€§å¢åŠ æ–°çš„æ–¹æ³•æˆ–å±æ€§ MyLocalStorage.prototype.setItem = function () {} //âœ… æ­£ç¡® ä½†æ˜¯å¯ä»¥è¦†ç›–ç±»ä¸Šå·²ç»å­˜åœ¨çš„æ–¹æ³• */ ç¼–è¯‘æˆ javaScript çš„ä»£ç ï¼š\né™æ€æˆå‘˜ç›´æ¥è¢«æŒ‚è½½åœ¨å‡½æ•°ä½“ä¸Šï¼Œè€Œå®ä¾‹æˆå‘˜æŒ‚è½½åœ¨åŸå‹ä¸Š\né™æ€æˆå‘˜ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œå®ƒå§‹ç»ˆåªå±äºå½“å‰å®šä¹‰çš„è¿™ä¸ªç±»ï¼ˆä»¥åŠå…¶å­ç±»ï¼‰ã€‚è€ŒåŸå‹å¯¹è±¡ä¸Šçš„å®ä¾‹æˆå‘˜åˆ™ä¼šæ²¿ç€åŸå‹é“¾è¿›è¡Œä¼ é€’ï¼Œä¹Ÿå°±æ˜¯èƒ½å¤Ÿè¢«ç»§æ‰¿ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 \u0026#34;use strict\u0026#34;; exports.__esModule = true; var MyLocalStorage = /** @class */ (function () { function MyLocalStorage() { console.log(\u0026#34;è¿™æ˜¯TSçš„å•ä»¶è®¾è®¡æ¨¡å¼çš„é™æ€æ–¹æ³•çš„æ„é€ å™¨\u0026#34;); } MyLocalStorage.getInstance = function () { if (!this.localstorage) { console.log( \u0026#34;æˆ‘æ˜¯ä¸€ä¸ªundefinedçš„é™æ€å±æ€§ï¼Œç”¨æ¥æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ç©ºé—´çš„é™æ€å±æ€§\u0026#34; ); this.localstorage = new MyLocalStorage(); } return this.localstorage; }; MyLocalStorage.prototype.setItem = function (key, value) { localStorage.setItem(key, JSON.stringify(value)); }; MyLocalStorage.prototype.getItem = function (key) { var value = localStorage.getItem(key); return value != null ? JSON.parse(value) : null; }; MyLocalStorage.count = 3; return MyLocalStorage; })(); exports[\u0026#34;default\u0026#34;] = MyLocalStorage; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // é¥¿æ±‰å¼ class MyLocalStorage { static localstorage: MyLocalStorage = new MyLocalStorage(); static count: number = 3; private constructor() { console.log(\u0026#34;è¿™æ˜¯TSçš„å•ä»¶è®¾è®¡æ¨¡å¼çš„é™æ€æ–¹æ³•çš„æ„é€ å™¨\u0026#34;); } public setItem(key: string, value: any) { localStorage.setItem(key, JSON.stringify(value)); } public getItem(key: string) { let value = localStorage.getItem(key); return value != null ? JSON.parse(value) : null; } } æ— è®ºä½ æ˜¯å¦åˆ›å»ºå¯¹è±¡ï¼Œåˆ›å»ºå¤šå°‘ä¸ªå¯¹è±¡ï¼Œæ˜¯å¦è°ƒç”¨è¯¥é™æ€æ–¹æ³•æˆ–é™æ€å±æ€§ï¼ŒTS éƒ½ä¼šä¸ºè¿™ä¸ªé™æ€æ–¹æ³•æˆ–é™æ€å±æ€§åˆ†é…å†…å­˜ç©ºé—´ï¼Œæ³¨æ„ï¼šé™æ€æˆå‘˜å’Œå¯¹è±¡æ— å…³ã€‚\nä¸€æ—¦ä¸ºé™æ€æ–¹æ³•æˆ–é™æ€å±æ€§åˆ†é…å¥½ç©ºé—´ï¼Œå°±ä¸€ç›´ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œç›´åˆ°æœåŠ¡å™¨é‡å¯æˆ–è€…æ§åˆ¶å°ç¨‹åºæ‰§è¡Œç»“æŸæ‰è¢«é‡Šæ”¾ã€‚\n\u0026nbsp;TSç»§æ‰¿ å›é¡¾æ‰‹å†™ JS ç»§æ‰¿\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 class Base { print() {} } class Derived extends Base { //æ´¾ç”Ÿç±»å¯¹åŸºç±»æˆå‘˜çš„è®¿é—®ä¸è¦†ç›–æ“ä½œ print() { super.print(); // ... } //override å…³é”®å­—ï¼Œæ¥ç¡®ä¿æ´¾ç”Ÿç±»å°è¯•è¦†ç›–çš„æ–¹æ³•ä¸€å®šåœ¨åŸºç±»ä¸­å­˜åœ¨å®šä¹‰ //åœ¨è¿™é‡Œ TS å°†ä¼šç»™å‡ºé”™è¯¯ï¼Œå› ä¸ºå°è¯•è¦†ç›–çš„æ–¹æ³•å¹¶æœªåœ¨åŸºç±»ä¸­å£°æ˜ã€‚ override say() {} } //âš ï¸ åœ¨TypeScriptä¸­æ— æ³•å£°æ˜é™æ€çš„æŠ½è±¡æˆå‘˜ //æŠ½è±¡ç±» abstract class LoginHandler { abstract handler(): void; } // å…¶å® interface ä¹Ÿå¯ä»¥æè¿°ç±»çš„ç»“æ„ interface LoginHandler { hander(): void; } class WeChatLoginHandler implements LoginHandler { handler() {} } class TaoBaoLoginHandler implements LoginHandler { handler() {} } class TikTokLoginHandler implements LoginHandler { handler() {} } class Login { public static handlerMap: Record\u0026lt;LoginType, LoginHandler\u0026gt; = { [LoginType.TaoBao]: new TaoBaoLoginHandler(), [LoginType.TikTok]: new TikTokLoginHandler(), [LoginType.WeChat]: new WeChatLoginHandler(), }; public static handler(type: LoginType) { Login.handlerMap[type].handler(); } } //ä½¿ç”¨ Newable Interface æ¥æè¿°ä¸€ä¸ªç±»çš„ç»“æ„ï¼ˆç±»ä¼¼äºæè¿°å‡½æ•°ç»“æ„çš„ Callable Interfaceï¼‰ï¼š class Foo {} interface FooStruct { new (): Foo; } declare const NewableFoo: FooStruct; const foo = new NewableFoo(); // ä»€ä¹ˆæ˜¯ Callable Interface interface FuncFooStruct { (name: string): number; } \u0026nbsp;any unknown unknown ç±»å‹å’Œ any ç±»å‹æœ‰äº›ç±»ä¼¼ï¼Œä¸€ä¸ª unknown ç±»å‹çš„å˜é‡å¯ä»¥å†æ¬¡èµ‹å€¼ä¸ºä»»æ„å…¶å®ƒç±»å‹ï¼Œä½†åªèƒ½èµ‹å€¼ç»™ any ä¸ unknown ç±»å‹çš„å˜é‡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 let unknownVar: unknown = \u0026#34;zzy\u0026#34;; unknownVar = false; unknownVar = \u0026#34;zzy\u0026#34;; unknownVar = { site: \u0026#34;zzy\u0026#34;, }; unknownVar = () =\u0026gt; {}; const val1: string = unknownVar; // â const val2: number = unknownVar; // â const val3: () =\u0026gt; {} = unknownVar; // â const val4: {} = unknownVar; // â const val5: any = unknownVar; const val6: unknown = unknownVar; 1 2 3 4 let unknownVar: unknown; unknownVar.foo(); // æŠ¥é”™ï¼šå¯¹è±¡ç±»å‹ä¸º unknown //ç±»å‹æ–­è¨€ (unknownVar as { foo: () =\u0026gt; {} }).foo(); \u0026nbsp;ç±»å‹æ–­è¨€ ç±»å‹æ–­è¨€çš„æ­£ç¡®ä½¿ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨ TypeScript ç±»å‹åˆ†æä¸æ­£ç¡®æˆ–ä¸ç¬¦åˆé¢„æœŸæ—¶ï¼Œå°†å…¶æ–­è¨€ä¸ºæ­¤å¤„çš„æ­£ç¡®ç±»å‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 interface IFoo { name: string; } declare const obj: { foo: IFoo; }; const { foo = {} } = obj; //è¿™é‡Œfooçš„ç±»å‹æ˜¯{} //foo.name â const { foo = {} as IFoo } = obj; //è¿™é‡Œfooçš„ç±»å‹æ˜¯IFoo foo.name; åŒé‡æ–­è¨€ ä½ çš„æ–­è¨€ç±»å‹å’ŒåŸç±»å‹çš„å·®å¼‚å¤ªå¤§ï¼Œéœ€è¦å…ˆæ–­è¨€åˆ°ä¸€ä¸ªé€šç”¨çš„ç±»ï¼Œå³ any/unknownã€‚è¿™ä¸€é€šç”¨ç±»å‹åŒ…å«äº†æ‰€æœ‰å¯èƒ½çš„ç±»å‹ï¼Œå› æ­¤æ–­è¨€åˆ°å®ƒå’Œä»å®ƒæ–­è¨€åˆ°å¦ä¸€ä¸ªç±»å‹å·®å¼‚ä¸å¤§ã€‚\n1 2 3 4 5 6 7 const str: string = \u0026#34;linbudu\u0026#34;; // ä» X ç±»å‹ åˆ° Y ç±»å‹çš„æ–­è¨€å¯èƒ½æ˜¯é”™è¯¯çš„ ... (str as { handler: () =\u0026gt; {} }).handler(); (str as unknown as { handler: () =\u0026gt; {} }).handler(); // ä½¿ç”¨å°–æ‹¬å·æ–­è¨€ (\u0026lt;{ handler: () =\u0026gt; {} }\u0026gt;(\u0026lt;unknown\u0026gt;str)).handler(); éç©ºæ–­è¨€ éç©ºæ–­è¨€å…¶å®æ˜¯ç±»å‹æ–­è¨€çš„ç®€åŒ–ï¼Œå®ƒä½¿ç”¨ ! è¯­æ³•ï¼Œå³obj!.func()!.propçš„å½¢å¼æ ‡è®°å‰é¢çš„ä¸€ä¸ªå£°æ˜ä¸€å®šæ˜¯éç©ºçš„ï¼ˆå®é™…ä¸Šå°±æ˜¯å‰”é™¤äº† null å’Œ undefined ç±»å‹ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 declare const foo: { func?: () =\u0026gt; { prop?: number | null; }; }; foo.func!().prop!.toFixed(); //å…¶åº”ç”¨ä½ç½®ç±»ä¼¼äºå¯é€‰é“¾ï¼š foo.func?.().prop?.toFixed(); /* ä½†ä¸åŒçš„æ˜¯ï¼Œéç©ºæ–­è¨€çš„è¿è¡Œæ—¶ä»ç„¶ä¼šä¿æŒè°ƒç”¨é“¾ï¼Œå› æ­¤åœ¨è¿è¡Œæ—¶å¯èƒ½ä¼šæŠ¥é”™ã€‚ è€Œå¯é€‰é“¾åˆ™ä¼šåœ¨æŸä¸€ä¸ªéƒ¨åˆ†æ”¶åˆ° undefined æˆ– null æ—¶ç›´æ¥çŸ­è·¯æ‰ï¼Œä¸ä¼šå†å‘ç”Ÿåé¢çš„è°ƒç”¨ã€‚ */ //éç©ºæ–­è¨€çš„å¸¸è§åœºæ™¯è¿˜æœ‰ document.querySelectorã€Array.find æ–¹æ³•ç­‰ï¼š const element = document.querySelector(\u0026#34;#id\u0026#34;)!; const target = [1, 2, 3, 233].find((item) =\u0026gt; item === 233)!; ä¸ºä»€ä¹ˆè¯´éç©ºæ–­è¨€æ˜¯ç±»å‹æ–­è¨€çš„ç®€å†™ï¼š\n1 2 3 4 5 6 7 8 9 foo.func!().prop!.toFixed(); //ç­‰ä»·äº ( ( foo.func as () =\u0026gt; { prop?: number; } )().prop as number ).toFixed(); \u0026nbsp;äº¤å‰ç±»å‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 type Struct1 = { primitiveProp: string; objectProp: { name: string; }; }; type Struct2 = { primitiveProp: number; objectProp: { age: number; }; }; type Composed = Struct1 \u0026amp; Struct2; type PrimitivePropType = Composed[\u0026#34;primitiveProp\u0026#34;]; // never äº¤é›†ä¸ºç©ºé›† //å¯¹äºå¯¹è±¡ç±»å‹çš„äº¤å‰ç±»å‹ï¼Œå…¶å†…éƒ¨çš„åŒåå±æ€§ç±»å‹åŒæ ·ä¼šæŒ‰ç…§äº¤å‰ç±»å‹è¿›è¡Œåˆå¹¶ type ObjectPropType = Composed[\u0026#34;objectProp\u0026#34;]; // { name: string; age: number; } // åˆå¹¶åçš„ name åŒæ ·æ˜¯ never ç±»å‹ type Derived = Struct1 \u0026amp; { primitiveProp: number; }; æ‰©å±•ï¼šæ¥å£çš„åˆå¹¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 interface Struct1 { primitiveProp: string; objectProp: { name: string; }; } // æ¥å£â€œStruct2â€é”™è¯¯æ‰©å±•æ¥å£â€œStruct1â€ã€‚å±æ€§â€œprimitivePropâ€çš„ç±»å‹ä¸å…¼å®¹ã€‚ä¸èƒ½å°†ç±»å‹â€œnumberâ€åˆ†é…ç»™ç±»å‹â€œstringâ€ã€‚ interface Struct2 extends Struct1 { primitiveProp: number; objectProp: { age: number; }; } å¦‚æœä½ ç›´æ¥å£°æ˜å¤šä¸ªåŒåæ¥å£ï¼Œè™½ç„¶æ¥å£ä¼šè¿›è¡Œåˆå¹¶ï¼Œä½†è¿™äº›åŒåå±æ€§ä»ç„¶éœ€è¦å±äºåŒä¸€ç±»å‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 interface Struct1 { primitiveProp: string; objectProp: { name: string; }; } interface Struct1 { // åç»­å±æ€§å£°æ˜å¿…é¡»å±äºåŒä¸€ç±»å‹ã€‚å±æ€§â€œprimitivePropâ€çš„ç±»å‹å¿…é¡»ä¸ºâ€œstringâ€ï¼Œä½†æ­¤å¤„å´ä¸ºç±»å‹â€œnumberâ€ã€‚ primitiveProp: number; // ç±»ä¼¼çš„æŠ¥é”™ objectProp: { age: number; }; } \u0026nbsp;ç´¢å¼•ç±»å‹ ç´¢å¼•ç­¾åç±»å‹ä¸»è¦æŒ‡çš„æ˜¯åœ¨æ¥å£æˆ–ç±»å‹åˆ«åä¸­ï¼Œé€šè¿‡ä»¥ä¸‹è¯­æ³•æ¥å¿«é€Ÿå£°æ˜ä¸€ä¸ªé”®å€¼ç±»å‹ä¸€è‡´çš„ç±»å‹ç»“æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 interface AllStringTypes { [key: string]: string; } type AllStringTypes = { [key: string]: string; }; /* ä½†ç”±äº JavaScript ä¸­ï¼Œå¯¹äº obj[prop] å½¢å¼çš„è®¿é—®ä¼šå°†æ•°å­—ç´¢å¼•è®¿é—®è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç´¢å¼•è®¿é—®ã€‚ æ‰€ä»¥obj[233] å’Œ obj[\u0026#39;233\u0026#39;] çš„æ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚åœ¨å­—ç¬¦ä¸²ç´¢å¼•ç­¾åç±»å‹ä¸­æˆ‘ä»¬ä»ç„¶å¯ä»¥å£°æ˜æ•°å­—ç±»å‹çš„é”®ã€‚ ç±»ä¼¼çš„ï¼Œsymbol ç±»å‹ä¹Ÿæ˜¯å¦‚æ­¤ï¼š */ const foo: AllStringTypes = { zzydev: \u0026#34;233\u0026#34;, 233: \u0026#34;zzydev\u0026#34;, [Symbol(\u0026#34;zzy\u0026#34;)]: \u0026#34;symbol\u0026#34;, }; // propA å’Œ propB çš„ç±»å‹è¦ç¬¦åˆç´¢å¼•ç­¾åç±»å‹çš„å£°æ˜ interface StringOrBooleanTypes { propA: number; propB: boolean; [key: string]: number | boolean; } \u0026nbsp;ç´¢å¼•ç±»å‹æŸ¥è¯¢ä¸ç´¢å¼•ç±»å‹è®¿é—® ç´¢å¼•ç±»å‹æŸ¥è¯¢ keyofï¼š\n1 2 3 4 5 6 7 8 9 10 11 interface Foo { zzy: 1; 233: 2; } // \u0026#34;zzy\u0026#34; | 233 æ³¨æ„è¿™é‡Œçš„233ä»ç„¶æ˜¯æ•°å­— type FooKeys = keyof Foo; type Any = keyof any; //ç›¸å½“äº type Any = string | number | symbol; ç´¢å¼•ç±»å‹è®¿é—®:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 interface NumberRecord { [key: string]: number; } type PropType = NumberRecord[string]; // number interface Foo { propA: number; propB: boolean; } type PropAType = Foo[\u0026#34;propA\u0026#34;]; // number type PropBType = Foo[\u0026#34;propB\u0026#34;]; // boolean type PropType = Foo[string]; // â åœ¨æœªå£°æ˜ç´¢å¼•ç­¾åç±»å‹çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½ä½¿ç”¨Foo[string]è¿™ç§æ–¹å¼è®¿é—® /* çœ‹èµ·æ¥è¿™é‡Œå°±æ˜¯æ™®é€šçš„å€¼è®¿é—®ï¼Œä½†å®é™…ä¸Šè¿™é‡Œçš„\u0026#39;propA\u0026#39;å’Œ\u0026#39;propB\u0026#39;éƒ½æ˜¯å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªJavaScriptå­—ç¬¦ä¸²å€¼ã€‚ ç´¢å¼•ç±»å‹æŸ¥è¯¢çš„æœ¬è´¨å…¶å®å°±æ˜¯ï¼Œé€šè¿‡é”®çš„å­—é¢é‡ç±»å‹ï¼ˆ\u0026#39;propA\u0026#39;ï¼‰è®¿é—®è¿™ä¸ªé”®å¯¹åº”çš„é”®å€¼ç±»å‹ï¼ˆnumberï¼‰ã€‚ */ //âš ï¸ ç´¢å¼•ç±»å‹æŸ¥è¯¢ã€ç´¢å¼•ç±»å‹è®¿é—®é€šå¸¸ä¼šå’Œæ˜ å°„ç±»å‹ä¸€èµ·æ­é…ä½¿ç”¨ï¼Œå‰ä¸¤è€…è´Ÿè´£è®¿é—®é”®ï¼Œè€Œæ˜ å°„ç±»å‹åœ¨å…¶åŸºç¡€ä¸Šè®¿é—®é”®å€¼ç±»å‹ã€‚ interface Foo { propA: number; propB: boolean; propC: string; } // string | number | boolean type PropTypeUnion = Foo[keyof Foo]; \u0026nbsp;æ˜ å°„ç±»å‹ æ˜ å°„ç±»å‹çš„ä¸»è¦ä½œç”¨å³æ˜¯åŸºäºé”®åæ˜ å°„åˆ°é”®å€¼ç±»å‹ï¼š\n1 2 3 4 5 type stringify\u0026lt;T\u0026gt; = { [K in keyof T]: string }; type Clone\u0026lt;T\u0026gt; = { //ç´¢å¼•ç­¾åç±»å‹ : ç´¢å¼•ç±»å‹è®¿é—® [K in keyof T]: T[K]; }; \u0026nbsp;ç±»å‹æŸ¥è¯¢è¿ç®—ç¬¦typeof åœ¨é€»è¾‘ä»£ç ä¸­ä½¿ç”¨çš„ typeof ä¸€å®šä¼šæ˜¯ JavaScript ä¸­çš„ typeofï¼Œ ç±»å‹ä»£ç ï¼ˆå¦‚ç±»å‹æ ‡æ³¨ã€ç±»å‹åˆ«åä¸­ç­‰ï¼‰ä¸­çš„ä¸€å®šæ˜¯ç±»å‹æŸ¥è¯¢çš„ typeof ä¸ºäº†æ›´å¥½åœ°é¿å…è¿™ç§æƒ…å†µï¼Œä¹Ÿå°±æ˜¯éš”ç¦»ç±»å‹å±‚å’Œé€»è¾‘å±‚ï¼Œç±»å‹æŸ¥è¯¢æ“ä½œç¬¦åæ˜¯ä¸å…è®¸ä½¿ç”¨è¡¨è¾¾å¼çš„ï¼š\n1 2 3 4 const isInputValid = (input: string) =\u0026gt; { return input.length \u0026gt; 0; }; type isValid = typeof isInputValid(\u0026#34;zzy\u0026#34;); // â \u0026nbsp;â­ ç±»å‹å®ˆå« 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 //åˆ¤æ–­é€»è¾‘å°è£…èµ·æ¥æå–åˆ°å‡½æ•°å¤–éƒ¨è¿›è¡Œå¤ç”¨ function isString(input: unknown): boolean { return typeof input === \u0026#34;string\u0026#34;; } function foo(input: string | number) { if (isString(input)) { //â“ ç±»å‹â€œstring | numberâ€ä¸Šä¸å­˜åœ¨å±æ€§â€œreplaceâ€ã€‚ // è¿™é‡Œçš„ç±»å‹æ§åˆ¶æµåˆ†æåšä¸åˆ°è·¨å‡½æ•°ä¸Šä¸‹æ–‡æ¥è¿›è¡Œç±»å‹çš„ä¿¡æ¯æ”¶é›† input.replace(\u0026#34;zzy\u0026#34;, \u0026#34;233\u0026#34;); } if (typeof input === \u0026#34;number\u0026#34;) { } // ... } ä¸ºäº†è§£å†³è¿™ä¸€ç±»å‹æ§åˆ¶æµåˆ†æçš„èƒ½åŠ›ä¸è¶³ï¼ŒTypeScript å¼•å…¥äº†is å…³é”®å­—æ¥æ˜¾å¼åœ°æä¾›ç±»å‹ä¿¡æ¯ã€‚\nåœ¨è¿™é‡Œ isString å‡½æ•°ç§°ä¸ºç±»å‹å®ˆå«ï¼Œåœ¨å®ƒçš„è¿”å›å€¼ä¸­ï¼Œæˆ‘ä»¬ä¸å†ä½¿ç”¨ boolean ä½œä¸ºç±»å‹æ ‡æ³¨ï¼Œè€Œæ˜¯ä½¿ç”¨input is string å°†input is stringæ‹†å¼€ï¼š\ninput å‡½æ•°çš„æŸä¸ªå‚æ•°ï¼› is stringï¼Œå³ is å…³é”®å­— + é¢„æœŸç±»å‹ï¼Œå³å¦‚æœè¿™ä¸ªå‡½æ•°æˆåŠŸè¿”å›ä¸º trueï¼Œé‚£ä¹ˆ is å…³é”®å­—å‰è¿™ä¸ªå…¥å‚çš„ç±»å‹ï¼Œå°±ä¼šè¢«è¿™ä¸ªç±»å‹å®ˆå«è°ƒç”¨æ–¹åç»­çš„ç±»å‹æ§åˆ¶æµåˆ†ææ”¶é›†åˆ°ã€‚ 1 2 3 function isString(input: unknown): input is string { return typeof input === \u0026#34;string\u0026#34;; } å¼€å‘ä¸­å¸¸ç”¨çš„ä¸¤ä¸ªç±»å‹å®ˆå«ï¼š\n1 2 3 4 5 6 7 8 9 export type Falsy = false | \u0026#34;\u0026#34; | 0 | null | undefined; export const isFalsy = (val: unknown): val is Falsy =\u0026gt; !val; // ä¸åŒ…æ‹¬ä¸å¸¸ç”¨çš„ symbol å’Œ bigint export type Primitive = string | number | boolean | undefined; export const isPrimitive = (val: unknown): val is Primitive =\u0026gt; [\u0026#34;string\u0026#34;, \u0026#34;number\u0026#34;, \u0026#34;boolean\u0026#34;, \u0026#34;undefined\u0026#34;].includes(typeof val); é™¤äº†ä½¿ç”¨ typeof ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è®¸å¤šç±»ä¼¼çš„æ–¹å¼æ¥è¿›è¡Œç±»å‹ä¿æŠ¤ï¼Œåªè¦å®ƒèƒ½å¤Ÿåœ¨è”åˆç±»å‹çš„ç±»å‹æˆå‘˜ä¸­èµ·åˆ°ç­›é€‰ä½œç”¨ã€‚\n\u0026nbsp;åŸºäº in ä¸ instanceof çš„ç±»å‹ä¿æŠ¤ å¯ä»¥é€šè¿‡key in objectçš„æ–¹å¼æ¥åˆ¤æ–­ key æ˜¯å¦å­˜åœ¨äº object æˆ–å…¶åŸå‹é“¾ä¸Šï¼ˆè¿”å› true è¯´æ˜å­˜åœ¨ï¼‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 interface A { a: string; aOnly: string; c: string; } interface B { b: string; bOnly: string; c: string; } function check(val: A | B) { if (\u0026#34;a\u0026#34; in val) { //Property \u0026#39;aOnly\u0026#39; does not exist on type \u0026#39;A | B\u0026#39;.Property \u0026#39;aOnly\u0026#39; does not exist on type \u0026#39;B\u0026#39; val.aOnly; } else { //Property \u0026#39;bOnly\u0026#39; does not exist on type \u0026#39;never\u0026#39; val.bOnly; } } function check2(val: A | B) { if (\u0026#34;c\u0026#34; in val) { //ç±»å‹ \u0026#34;A | B\u0026#34;ä¸Šä¸å­˜åœ¨å±æ€§ \u0026#34;aOnly\u0026#34; val.aOnly; } else { val.bOnly; } } å¯è¾¨è¯†å±æ€§å¯ä»¥æ˜¯ç»“æ„å±‚é¢çš„ï¼Œæ¯”å¦‚ç»“æ„ A çš„å±æ€§ prop æ˜¯æ•°ç»„ï¼Œè€Œç»“æ„ B çš„å±æ€§ prop æ˜¯å¯¹è±¡ï¼Œæˆ–è€…ç»“æ„ A ä¸­å­˜åœ¨å±æ€§ prop è€Œç»“æ„ B ä¸­ä¸å­˜åœ¨ï¼Œæˆ–è€…å…±åŒå±æ€§å­—é¢é‡å·®å¼‚ç­‰ã€‚\nä½¿ç”¨instanceofè¿›è¡Œç±»å‹ä¿æŠ¤ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 class FooBase {} class BarBase {} class Foo extends FooBase { fooOnly() {} } class Bar extends BarBase { barOnly() {} } function handle(input: Foo | Bar) { if (input instanceof FooBase) { input.fooOnly(); } else { input.barOnly(); } } \u0026nbsp;æ–­è¨€å®ˆå« æ–­è¨€å®ˆå«å’Œç±»å‹å®ˆå«æœ€å¤§çš„ä¸åŒç‚¹åœ¨äºï¼Œåœ¨åˆ¤æ–­æ¡ä»¶ä¸é€šè¿‡æ—¶ï¼Œæ–­è¨€å®ˆå«éœ€è¦æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œç±»å‹å®ˆå«åªéœ€è¦å‰”é™¤æ‰é¢„æœŸçš„ç±»å‹\nğŸ‘ å®˜æ–¹æ–‡æ¡£ç®€æ˜æ˜“æ‡‚ï¼šassertion-functions\n\u0026nbsp;æ³›å‹çº¦æŸä¸é»˜è®¤å€¼ åœ¨æ³›å‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ extends å…³é”®å­—æ¥çº¦æŸä¼ å…¥çš„æ³›å‹å‚æ•°å¿…é¡»ç¬¦åˆè¦æ±‚ã€‚\nA = Bæˆ– A extends Bæ„å‘³ç€ B æ˜¯ A çš„å­ç±»å‹\nä¾‹å¦‚ï¼šU extends keyof Tè¡¨ç¤ºUçš„ç±»å‹è¢«çº¦æŸåœ¨è”åˆç±»å‹keyof Tçš„èŒƒå›´å†…\nextends è¿˜ç»å¸¸ç”¨äºæ¡ä»¶ç±»å‹ï¼š T extends U ? T : never,æ¡ä»¶ç±»å‹æœ‰ç‚¹åƒ JavaScript ä¸­çš„ä¸‰å…ƒè¡¨è¾¾å¼\nåœ¨æ¡ä»¶ç±»å‹ä¸­ï¼Œæœ‰ä¸€ä¸ªç‰¹åˆ«éœ€è¦æ³¨æ„çš„ä¸œè¥¿å°±æ˜¯ï¼šåˆ†å¸ƒå¼æ¡ä»¶ç±»å‹: TypeScript å¯¹è”åˆç±»å‹åœ¨æ¡ä»¶ç±»å‹ä¸­ä½¿ç”¨æ—¶çš„ç‰¹æ®Šå¤„ç†ï¼šä¼šæŠŠè”åˆç±»å‹çš„æ¯ä¸€ä¸ªå…ƒç´ å•ç‹¬ä¼ å…¥åšç±»å‹è®¡ç®—ï¼Œæœ€ååˆå¹¶ã€‚\nè¿™å’Œè”åˆç±»å‹é‡åˆ°å­—ç¬¦ä¸²æ—¶çš„å¤„ç†ä¸€æ ·ï¼š\n\u0026nbsp;å¯¹è±¡ç±»å‹ä¸­çš„æ³›å‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 //è¿™ä¸ªæ¥å£æè¿°äº†ä¸€ä¸ªé€šç”¨çš„å“åº”ç±»å‹ç»“æ„ï¼Œé¢„ç•™å‡ºäº†å®é™…å“åº”æ•°æ®çš„æ³›å‹å‘ä½ï¼Œ //ç„¶ååœ¨ä½ çš„è¯·æ±‚å‡½æ•°ä¸­å°±å¯ä»¥ä¼ å…¥ç‰¹å®šçš„å“åº”ç±»å‹äº†ï¼š interface IRes\u0026lt;TData = unknown\u0026gt; { code: number; error?: string; data: TData; } interface IUserProfileRes { name: string; homepage: string; avatar: string; } function fetchUserProfile(): Promise\u0026lt;IRes\u0026lt;IUserProfileRes\u0026gt;\u0026gt; {} type StatusSucceed = boolean; function handleOperation(): Promise\u0026lt;IRes\u0026lt;StatusSucceed\u0026gt;\u0026gt; {} //æ³›å‹åµŒå¥—çš„åœºæ™¯ä¹Ÿéå¸¸å¸¸ç”¨ï¼Œæ¯”å¦‚å¯¹å­˜åœ¨åˆ†é¡µç»“æ„çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶åˆ†é¡µçš„å“åº”ç»“æ„æŠ½ç¦»å‡ºæ¥ï¼š interface IPaginationRes\u0026lt;TItem = unknown\u0026gt; { data: TItem[]; page: number; totalCount: number; hasNextPage: boolean; } function fetchUserProfileList(): Promise\u0026lt; IRes\u0026lt;IPaginationRes\u0026lt;IUserProfileRes\u0026gt;\u0026gt; \u0026gt; {} \u0026nbsp;å‡½æ•°ä¸­çš„æ³›å‹ ç®­å¤´å‡½æ•°çš„æ³›å‹ä¹¦å†™ âœğŸ» æ–¹å¼ï¼š\n1 2 3 4 5 const handle = \u0026lt;T\u0026gt;(input: T): T =\u0026gt; {}; //éœ€è¦æ³¨æ„çš„æ˜¯åœ¨ tsx æ–‡ä»¶ä¸­æ³›å‹çš„å°–æ‹¬å·å¯èƒ½ä¼šé€ æˆæŠ¥é”™ï¼Œç¼–è¯‘å™¨æ— æ³•è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªç»„ä»¶è¿˜æ˜¯ä¸€ä¸ªæ³›å‹ï¼Œ //æ­¤æ—¶ä½ å¯ä»¥è®©å®ƒé•¿å¾—æ›´åƒæ³›å‹ä¸€äº›ï¼š const handle = \u0026lt;T extends any\u0026gt;(input: T): T =\u0026gt; {}; ä¸è¦ä¸ºäº†ç”¨æ³›å‹è€Œç”¨æ³›å‹ï¼Œæ³›å‹å‚æ•° T æ²¡æœ‰è¢«è¿”å›å€¼æ¶ˆè´¹ï¼Œä¹Ÿæ²¡æœ‰è¢«å†…éƒ¨çš„é€»è¾‘æ¶ˆè´¹ï¼Œè¿™ç§æƒ…å†µä¸‹å³ä½¿éšç€è°ƒç”¨å¡«å……äº†æ³›å‹å‚æ•°ï¼Œä¹Ÿæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚\n1 2 3 4 //è¿™é‡Œå®Œå…¨å¯ä»¥ç”¨ any æ¥è¿›è¡Œç±»å‹æ ‡æ³¨ function handle\u0026lt;T\u0026gt;(arg: T): void { console.log(arg); } \u0026nbsp;ç±»å‹ç³»ç»Ÿå±‚çº§ 1 2 3 4 5 6 type Result = String extends {} ? 1 : 2; // 1 type Result1 = {} extends object ? 1 : 2; // 1 type Result2 = object extends Object ? 1 : 2; // 1 //string extends object å¹¶ä¸æˆç«‹ type Tmp = string extends object ? 1 : 2; //âš ï¸ 2 1 2 3 type Result = Object extends any ? 1 : 2; // 1 //âš ï¸ å°†anyè°ƒè¿‡æ¥ï¼Œå€¼ç«Ÿç„¶å˜æˆäº† 1 | 2 type Result1 = any extends {} | object | Object ? 1 : 2; // 1 | 2 åŸºç¡€çš„ç±»å‹å±‚çº§é“¾ï¼šBottom Type(never) \u0026lt; å¯¹åº”çš„å­—é¢é‡ç±»å‹ \u0026lt; åŸºç¡€ç±»å‹ \u0026lt; è£…ç®±ç±»å‹ \u0026lt; é¡¶çº§ç±»å‹(Object) \u0026lt; Top Type(any/unknown)\nè¡¥å……ï¼š\n1 2 3 4 5 6 7 type Result1 = [number, string] extends number[] ? 1 : 2; // 2 // let arr: (number| string)[] = [233, \u0026#34;zzy\u0026#34;] type Result2 = [number, string] extends (number | string)[] ? 1 : 2; // 1 // [] ç­‰ä»·äº any[] type Result3 = [] extends number[] ? 1 : 2; // 1 type Result4 = [] extends unknown[] ? 1 : 2; // 1 \u0026nbsp;infer 1 2 3 4 5 6 7 8 9 10 11 12 type ArrayItemType\u0026lt;T\u0026gt; = T extends Array\u0026lt;infer ElementType\u0026gt; ? ElementType : never; // [string, number] ç­‰æ•ˆäº (string| number)[] type ArrayItemTypeResult = ArrayItemType\u0026lt;[string, number]\u0026gt;; // string | number type ReverseKeyValue\u0026lt;T extends Record\u0026lt;string, unknown\u0026gt;\u0026gt; = T extends Record\u0026lt; infer K, infer V \u0026gt; ? Record\u0026lt;V \u0026amp; string, K\u0026gt; : never; \u0026nbsp;åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ ğŸ‘ å®˜æ–¹æ–‡æ¡£ç®€æ˜æ˜“æ‡‚ Distributive Conditional Types\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿä¼šéœ€è¦åŒ…è£¹æ³›å‹å‚æ•°æ¥ç¦ç”¨æ‰åˆ†å¸ƒå¼ç‰¹æ€§ã€‚\nå¸¸è§åŒ…è£¹ç±»å‹çš„ä¹¦å†™æ–¹å¼ï¼š\n1 2 3 4 5 6 7 // åŒ…è£¹æ³›å‹â‘  é€šè¿‡æ³›å‹å‚æ•°è¢«[]åŒ…è£¹ type Wrapped\u0026lt;T\u0026gt; = [T] extends [boolean] ? \u0026#34;Y\u0026#34; : \u0026#34;N\u0026#34;; // åŒ…è£¹æ³›å‹â‘¡ export type NoDistribute\u0026lt;T\u0026gt; = T \u0026amp; {}; type Wrapped\u0026lt;T\u0026gt; = NoDistribute\u0026lt;T\u0026gt; extends [boolean] ? \u0026#34;Y\u0026#34; : \u0026#34;N\u0026#34;; 1 2 3 4 5 6 7 8 9 10 11 12 13 type NeverFalseImpl\u0026lt;T\u0026gt; = T extends never ? true : false; type res1 = NeverFalseImpl\u0026lt;never\u0026gt;; // never type res2 = NeverFalseImpl\u0026lt;any\u0026gt;; // boolean //âš ï¸ any ä½œä¸ºåˆ¤æ–­å‚æ•°æ—¶ã€ä½œä¸ºæ³›å‹å‚æ•°æ—¶éƒ½ä¼šäº§ç”Ÿè¿™ä¸€æ•ˆæœ: type Tmp1 = any extends string ? 1 : 2; // 1 | 2 type Tmp2\u0026lt;T\u0026gt; = T extends string ? 1 : 2; type Tmp2Res = Tmp2\u0026lt;any\u0026gt;; // 1 | 2 //è€Œ never ä»…åœ¨ä½œä¸ºæ³›å‹å‚æ•°æ—¶æ‰ä¼šäº§ç”Ÿï¼š(æœ‰ç‚¹ä¸­æ–­æ–½æ³•çš„æ„Ÿè§‰) type Tmp3 = never extends string ? 1 : 2; // 1 type Tmp4\u0026lt;T\u0026gt; = T extends string ? 1 : 2; type Tmp4Res = Tmp4\u0026lt;never\u0026gt;; // never ","permalink":"https://zzydev.top/posts/headfirstts/ts%E5%9F%BA%E7%A1%80%E6%8B%BE%E9%81%97/","summary":"æœ¬æ–‡åªè®°å½•ä¸€äº›ä¸ªäººè§‰å¾—æ¯”è¾ƒå®¹æ˜“é—å¿˜æˆ–éœ€è¦æ³¨æ„çš„ç‚¹ï¼ŒæŠ‘æˆ–æ˜¯ä¸€äº›è·Ÿæœ¬äººæ¥è§¦è¿‡çš„å…¶ä»–é™æ€è¯­è¨€ä¸å¤ªä¸€æ ·çš„è¯­æ³•ï¼Œå¹¶ä¸æ˜¯ä¸€ä»½å®Œæ•´çš„å­¦ä¹ æ•™ç¨‹ã€‚ \u0026nbsp;","title":"TSåŸºç¡€æ‹¾é—"},{"content":" \u0026nbsp;æ‰‹å†™ instanceof 1 2 3 4 5 6 7 8 9 function myInstanceof(Left, Right) { if (typeof Left !== \u0026#34;object\u0026#34; || Left === null) return false; let proto = Object.getPrototypeOf(Left); while (true) { if (proto == null) return false; if (proto == Right.prototype) return true; proto = Object.getPrototypeOf(proto); } } \u0026nbsp;æ‰‹å†™ getType 1 2 3 4 5 6 7 function getType(obj) { let type = typeof obj; if (type !== \u0026#34;object\u0026#34;) return type; return Object.prototype.toString .call(obj) .replace(/^\\[object (\\S+)\\]$/, \u0026#34;S1\u0026#34;); } \u0026nbsp;æ‰‹å†™æµ…æ‹·è´ 1 2 3 4 5 6 7 8 9 10 11 12 13 function shallowClone(target) { if (typeof target === \u0026#34;object\u0026#34; \u0026amp;\u0026amp; target !== null) { const cloneTarget = Array.isArray() ? [] : {}; for (let prop in target) { if (target.hasOwnProperty(prop)) { cloneTarget[prop] = target[prop]; } } return cloneTarget; } else { return target; } } \u0026nbsp;æ‰‹å†™æ·±æ‹·è´ å°æ¯\n1 2 3 4 5 6 7 8 9 10 11 function deepClone(obj) { let cloneObj = {}; for (let key in obj) { if (typeof key === \u0026#34;obj\u0026#34; \u0026amp;\u0026amp; key !== null) { cloneObj[key] = deepClone(obj[key]); } else { cloneObj[key] = obj[key]; } } return cloneObj; } è¶…å¤§æ¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 const isComplexDataType = (obj) =\u0026gt; (typeof obj === \u0026#34;object\u0026#34; || typeof obj === \u0026#34;function\u0026#34;) \u0026amp;\u0026amp; obj !== null; function deepClone(obj, hash = new WeakMap()) { if (obj instanceof Date) return +new Date(obj); if (obj instanceof RegExp) return new RegExp(obj); if (hash.has(obj)) return hash.get(obj); //è·å–å¯¹è±¡æ‰€æœ‰å±æ€§åŠå…¶å¯¹åº”çš„ç‰¹å¾ let allDesc = Object.getOwnPropertyDescriptors(obj); //ç»§æ‰¿åŸå¯¹è±¡çš„åŸå‹é“¾ let cloneObj = Object.create(Object.getPrototypeOf(obj), allDesc); hash.set(obj, cloneObj); for (let key of Reflect.ownKeys()) { cloneObj[key] = isComplexDataType(obj[key]) \u0026amp;\u0026amp; typeof obj[key] !== \u0026#34;function\u0026#34; ? deepClone(obj[key], hash) : obj[key]; } return cloneObj; } JS WeakMap åº”è¯¥ä»€ä¹ˆæ—¶å€™ä½¿ç”¨\n1 const newData = structuredClone(data); structuredClone MDN\n\u0026nbsp;æ‰‹å†™æ·±æ¯”è¾ƒ 1 2 3 4 5 6 7 8 9 10 11 12 13 const isObject = (obj) =\u0026gt; typeof obj === \u0026#34;object\u0026#34; \u0026amp;\u0026amp; obj !== null; function isEqual(obj1, obj2) { if (isObject(obj1) ^ isObject(obj2)) return false; if (obj1 === obj2) return true; const obj1Key = Object.keys(obj1); const obj2Key = Object.keys(obj2); if (obj1Key.length !== obj2Key.length) return false; for (let key in obj) { const res = isEqual(obj1[key], obj2[key]); if (!res) return false; } return true; } \u0026nbsp;æ‰‹å†™æµ…æ¯”è¾ƒ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 // æ£€æµ‹æ˜¯å¦ä¸ºå¯¹è±¡ const isObject = function isObject(obj) { return obj !== null \u0026amp;\u0026amp; /^(object|function)$/.test(typeof obj); }; // å¯¹è±¡æµ…æ¯”è¾ƒçš„æ–¹æ³• const shallowEqual = function shallowEqual(objA, objB) { if (!isObject(objA) || !isObject(objB)) return false; if (objA === objB) return true; // å…ˆæ¯”è¾ƒæˆå‘˜çš„æ•°é‡ let keysA = Reflect.ownKeys(objA), keysB = Reflect.ownKeys(objB); if (keysA.length !== keysB.length) return false; // æ•°é‡ä¸€è‡´ï¼Œå†é€ä¸€æ¯”è¾ƒå†…éƒ¨çš„æˆå‘˜ã€Œåªæ¯”è¾ƒç¬¬ä¸€çº§ï¼šæµ…æ¯”è¾ƒã€ for (let i = 0; i \u0026lt; keysA.length; i++) { let key = keysA[i]; // å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸­æœ‰è¿™ä¸ªæˆå‘˜ï¼Œä¸€ä¸ªå¯¹è±¡ä¸­æ²¡æœ‰ï¼›æˆ–è€…ï¼Œéƒ½æœ‰è¿™ä¸ªæˆå‘˜ï¼Œä½†æ˜¯æˆå‘˜å€¼ä¸ä¸€æ ·ï¼›éƒ½åº”è¯¥è¢«åˆ¤å®šä¸ºä¸ç›¸åŒï¼ï¼ if (!objB.hasOwnProperty(key) || !Object.is(objA[key], objB[key])) { return false; } } // ä»¥ä¸Šéƒ½å¤„ç†å®Œï¼Œå‘ç°æ²¡æœ‰ä¸ç›¸åŒçš„æˆå‘˜ï¼Œåˆ™è®¤ä¸ºä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ return true; }; \u0026nbsp;æ‰‹å†™å‡½æ•°AOP 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 Function.prototype.before = function (beforeFn) { const self = this; return function beforeFunc() { const args = arguments; beforeFn.apply(this, args); return self.apply(this, args); }; }; Function.prototype.after = function (afterFn) { const self = this; return function afterFunc() { const args = arguments; const result = self.apply(this, args); afterFn.apply(this, args); return result; }; }; function func() { console.log(\u0026#34;2\u0026#34;); } const newFunc = func .before(() =\u0026gt; { console.log(\u0026#34;1\u0026#34;); }) .after(() =\u0026gt; { console.log(\u0026#34;3\u0026#34;); }); newFunc(); // 1 2 3 \u0026nbsp;æ‰‹å†™æŸ¯é‡ŒåŒ– 1 2 3 4 5 6 7 8 9 10 11 12 // é€šç”¨çš„æŸ¯é‡ŒåŒ– var currying = function (fn) { var args = []; return function () { if (arguments.length == 0) { return fn.apply(this, args); } else { Array.prototype.push.apply(args, arguments); return arguments.callee; } }; }; \u0026nbsp;æ‰‹å†™ call ã€apply ã€bind 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 Function.prototype.myCall = function (context, ...args) { // xxx.myCall() thiså°±æ˜¯è¿™é‡Œçš„xxx myApplyå’ŒmyBindä¸­çš„thisåŒç† context.func = this; let res = context.func(...args); delete context.func; return res; }; Function.prototype.myBind = function () { const args = Array.from(arguments); const t = args.shift(); const self = this; return function () { return self.apply(t, args); }; }; Function.prototype.myApply = function (context, args) { context.func = this; let res = context.func(...args); delete context.func; return res; }; \u0026nbsp;æ‰‹å†™ Object.create() 1 2 3 4 5 6 //è¿™ä¸ªå‡½æ•°æ— æ³•åšåˆ°ä¸åŸç”Ÿçš„ Object.create ä¸€è‡´ï¼Œä¸€ä¸ªæ˜¯ä¸æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸æ”¯æŒ null ä½œä¸ºåŸå‹ Object.create = function (prototype) { var cls = function () {}; cls.prototype = prototype; return new cls(); }; \u0026nbsp;æ‰‹å†™ new 1 2 3 4 5 6 7 8 9 10 11 12 function myNew(...args) { // å–å‡º args æ•°ç»„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³ç›®æ ‡æ„é€ å‡½æ•° const constructor = args.shift(); // åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä¸”è¿™ä¸ªç©ºå¯¹è±¡ç»§æ‰¿æ„é€ å‡½æ•°çš„ prototype å±æ€§ // å³å®ç° obj.__proto__ = constructor.prototype const obj = Object.create(constructor.prototype); // æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå¾—åˆ°æ„é€ å‡½æ•°è¿”å›ç»“æœ // æ³¨æ„è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ applyï¼Œå°†æ„é€ å‡½æ•°å†…çš„ this æŒ‡å‘ä¸º obj const result = constructor.apply(obj, args); // å¦‚æœæ„é€ å‡½æ•°æ‰§è¡Œåï¼Œè¿”å›ç»“æœæ˜¯å¯¹è±¡ç±»å‹ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¦åˆ™è¿”å› obj å¯¹è±¡ return typeof result === \u0026#34;object\u0026#34; \u0026amp;\u0026amp; result != null ? result : obj; } \u0026nbsp;æ‰‹å†™é˜²æŠ–èŠ‚æµ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 // Throttle(äº‹ä»¶èŠ‚æµ)ï¼š ç¬¬ä¸€ä¸ªäººè¯´äº†ç®— // fnæ˜¯æˆ‘ä»¬éœ€è¦åŒ…è£…çš„äº‹ä»¶å›è°ƒ, intervalæ˜¯æ—¶é—´é—´éš”çš„é˜ˆå€¼ function throttle(fn, interval) { // lastä¸ºä¸Šä¸€æ¬¡è§¦å‘å›è°ƒçš„æ—¶é—´ let last = 0; // å°†throttleå¤„ç†ç»“æœå½“ä½œå‡½æ•°è¿”å› return function () { // ä¿ç•™è°ƒç”¨æ—¶çš„thisä¸Šä¸‹æ–‡ let context = this; // ä¿ç•™è°ƒç”¨æ—¶ä¼ å…¥çš„å‚æ•° let args = arguments; // è®°å½•æœ¬æ¬¡è§¦å‘å›è°ƒçš„æ—¶é—´ let now = new Date(); // åˆ¤æ–­ä¸Šæ¬¡è§¦å‘çš„æ—¶é—´å’Œæœ¬æ¬¡è§¦å‘çš„æ—¶é—´å·®æ˜¯å¦å°äºæ—¶é—´é—´éš”çš„é˜ˆå€¼ if (now - last \u0026gt;= interval) { // å¦‚æœæ—¶é—´é—´éš”å¤§äºæˆ‘ä»¬è®¾å®šçš„æ—¶é—´é—´éš”é˜ˆå€¼ï¼Œåˆ™æ‰§è¡Œå›è°ƒ last = now; fn.apply(context, args); } }; } // ç”¨throttleæ¥åŒ…è£…scrollçš„å›è°ƒ const better_scroll = throttle(() =\u0026gt; console.log(\u0026#34;è§¦å‘äº†æ»šåŠ¨äº‹ä»¶\u0026#34;), 1000); document.addEventListener(\u0026#34;scroll\u0026#34;, better_scroll); // Debounce(äº‹ä»¶é˜²æŠ–)ï¼š æœ€åä¸€ä¸ªäººè¯´äº†ç®— // fnæ˜¯æˆ‘ä»¬éœ€è¦åŒ…è£…çš„äº‹ä»¶å›è°ƒ, delayæ˜¯æ¯æ¬¡æ¨è¿Ÿæ‰§è¡Œçš„ç­‰å¾…æ—¶é—´ function debounce(fn, delay) { // å®šæ—¶å™¨ let timer = null; // å°†debounceå¤„ç†ç»“æœå½“ä½œå‡½æ•°è¿”å› return function () { // ä¿ç•™è°ƒç”¨æ—¶çš„thisä¸Šä¸‹æ–‡ let context = this; // ä¿ç•™è°ƒç”¨æ—¶ä¼ å…¥çš„å‚æ•° let args = arguments; // æ¯æ¬¡äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œéƒ½å»æ¸…é™¤ä¹‹å‰çš„æ—§å®šæ—¶å™¨ if (timer) { clearTimeout(timer); } // è®¾ç«‹æ–°å®šæ—¶å™¨ timer = setTimeout(function () { fn.apply(context, args); }, delay); }; } // ç”¨debounceæ¥åŒ…è£…scrollçš„å›è°ƒ const better_scroll = debounce(() =\u0026gt; console.log(\u0026#34;è§¦å‘äº†æ»šåŠ¨äº‹ä»¶\u0026#34;), 1000); document.addEventListener(\u0026#34;scroll\u0026#34;, better_scroll); \u0026nbsp;æ‰‹å†™åŸç”ŸAJAXè¯·æ±‚ åŸç”Ÿ ajax æ­¥éª¤\nåˆ›å»ºXMLHttpRequestå¯¹è±¡ ä½¿ç”¨openæ–¹æ³•è®¾ç½®å’ŒæœåŠ¡å™¨çš„äº¤äº’ä¿¡æ¯ ä½¿ç”¨sendå‘é€æ•°æ® æ³¨å†Œäº‹ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 const getJSON = function (url) { return new Promise((resolve, reject) =\u0026gt; { const xhr = XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(\u0026#34;Mscrosoft.XMLHttp\u0026#34;); xhr.open(\u0026#34;GET\u0026#34;, url, false); xhr.setRequestHeader(\u0026#34;Accept\u0026#34;, \u0026#34;application/json\u0026#34;); xhr.onreadystatechange = function () { if (xhr.readyState !== 4) return; if (xhr.status === 200 || xhr.status === 304) { resolve(xhr.responseText); } else { reject(new Error(xhr.responseText)); } }; xhr.send(); }); }; \u0026nbsp;æ‰‹å†™ String.prototype.trim 1 2 3 String.prototype.trim = function () { return this.replace(/^\\s+/, \u0026#34;\u0026#34;).replace(/\\s+$/, \u0026#34;\u0026#34;); }; \u0026nbsp;æ‰‹å†™ Array.flat 1 2 3 4 5 6 7 const flat = (arr) =\u0026gt; { const isDeep = arr.some((item) =\u0026gt; item instanceof Array); if (!isDeep) return arr; const res = Array.prototype.concat.apply([], arr); return flat(res); }; \u0026nbsp;æ‰‹å†™å»é‡ 1 2 3 4 const unique = (arr) =\u0026gt; { const set = new Set(arr); return [...arr]; }; \u0026nbsp;æ‰‹å†™ setInterval 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 const mySetInterval = (fn, delay) =\u0026gt; { let timer = null, isClear = false; function loop() { if (isClear) { isClear = false; clearTimeout(timer); return; } fn(); timer = setTimeout(loop, delay); } timer = setTimeout(loop, delay); return () =\u0026gt; { isClear = true; }; }; \u0026nbsp; æ‰‹å†™ åˆ¤æ–­ç±»æ•°ç»„ 1 2 3 4 5 6 7 8 9 10 const isArrayLikeObject = (arr) =\u0026gt; { if (typeof arr !== \u0026#34;object\u0026#34; || arr === null) return false; const lengthMaxVal = Math.pow(2, 53) - 1; if (!Object.prototype.hasOwnProperty.call(arr, \u0026#34;length\u0026#34;)) return false; if (typeof arr.length !== \u0026#34;number\u0026#34;) return false; if (!isFinite(arr.length)) return false; if (Array !== arr.constructor) return false; if (arr.length \u0026gt; 0 \u0026amp;\u0026amp; arr.length \u0026lt; lengthMaxVal) return true; return false; }; \u0026nbsp;è·å–å½“å‰ url ä¸­çš„å‚æ•°çš„å€¼ 1 2 3 4 5 const query = (name) =\u0026gt; { const search = location.search; const params = new URLSearchParams(search); return params.get(name); }; \u0026nbsp;å°† URL å‚æ•°è§£æä¸º JS å¯¹è±¡ 1 2 3 4 5 6 7 8 9 function queryToObject() { const res = {}; const search = location.search; const pList = new URLSearchParams(search); pList.forEach((key, val) =\u0026gt; { res[key] = val; }); return res; } \u0026nbsp;æ‰‹å†™JSON.Stringify JSON.stringify()å°†å€¼è½¬æ¢ä¸ºç›¸åº”çš„ JSON æ ¼å¼ï¼š\nè½¬æ¢å€¼å¦‚æœæœ‰ toJSON() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å®šä¹‰ä»€ä¹ˆå€¼å°†è¢«åºåˆ—åŒ–ã€‚\néæ•°ç»„å¯¹è±¡çš„å±æ€§ä¸èƒ½ä¿è¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºç°åœ¨åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­ã€‚\nå¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŸå§‹å€¼ã€‚\nundefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol å€¼ï¼Œåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè¢«å¿½ç•¥ï¼ˆå‡ºç°åœ¨éæ•°ç»„å¯¹è±¡çš„å±æ€§å€¼ä¸­æ—¶ï¼‰æˆ–è€…è¢«è½¬æ¢æˆ nullï¼ˆå‡ºç°åœ¨æ•°ç»„ä¸­æ—¶ï¼‰ã€‚å‡½æ•°ã€undefined è¢«å•ç‹¬è½¬æ¢æ—¶ï¼Œä¼šè¿”å› undefinedï¼Œå¦‚JSON.stringify(function(){}) or JSON.stringify(undefined).\nå¯¹åŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªç¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚\næ‰€æœ‰ä»¥ symbol ä¸ºå±æ€§é”®çš„å±æ€§éƒ½ä¼šè¢«å®Œå…¨å¿½ç•¥æ‰ï¼Œå³ä¾¿ replacer å‚æ•°ä¸­å¼ºåˆ¶æŒ‡å®šåŒ…å«äº†å®ƒä»¬ã€‚\nDate æ—¥æœŸè°ƒç”¨äº† toJSON() å°†å…¶è½¬æ¢ä¸ºäº† string å­—ç¬¦ä¸²ï¼ˆåŒ Date.toISOString()ï¼‰ï¼Œå› æ­¤ä¼šè¢«å½“åšå­—ç¬¦ä¸²å¤„ç†ã€‚\nNaN å’Œ Infinity æ ¼å¼çš„æ•°å€¼åŠ null éƒ½ä¼šè¢«å½“åš nullã€‚\nå…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ Map/Set/WeakMap/WeakSetï¼Œä»…ä¼šåºåˆ—åŒ–å¯æšä¸¾çš„å±æ€§ã€‚\n\u0026mdash;\u0026mdash;\u0026mdash; MDN\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 function jsonStringify(data) { let type = typeof data; if (type !== \u0026#34;object\u0026#34;) { let result = data; //data å¯èƒ½æ˜¯åŸºç¡€æ•°æ®ç±»å‹çš„æƒ…å†µåœ¨è¿™é‡Œå¤„ç† if (Number.isNaN(data) || data === Infinity) { //NaN å’Œ Infinity åºåˆ—åŒ–è¿”å› \u0026#34;null\u0026#34; result = \u0026#34;null\u0026#34;; } else if ( type === \u0026#34;function\u0026#34; || type === \u0026#34;undefined\u0026#34; || type === \u0026#34;symbol\u0026#34; ) { // ç”±äº function åºåˆ—åŒ–è¿”å› undefinedï¼Œå› æ­¤å’Œ undefinedã€symbol ä¸€èµ·å¤„ç† return undefined; } else if (type === \u0026#34;string\u0026#34;) { result = \u0026#39;\u0026#34;\u0026#39; + data + \u0026#39;\u0026#34;\u0026#39;; } return String(result); } else if (type === \u0026#34;object\u0026#34;) { if (data === null) { return \u0026#34;null\u0026#34;; } else if (data.toJSON \u0026amp;\u0026amp; typeof data.toJSON === \u0026#34;function\u0026#34;) { return jsonStringify(data.toJSON()); } else if (data instanceof Array) { let result = []; //å¦‚æœæ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆæ•°ç»„é‡Œé¢çš„æ¯ä¸€é¡¹ç±»å‹åˆæœ‰å¯èƒ½æ˜¯å¤šæ ·çš„ data.forEach((item, index) =\u0026gt; { if ( typeof item === \u0026#34;undefined\u0026#34; || typeof item === \u0026#34;function\u0026#34; || typeof item === \u0026#34;symbol\u0026#34; ) { result[index] = \u0026#34;null\u0026#34;; } else { result[index] = jsonStringify(item); } }); result = \u0026#34;[\u0026#34; + result + \u0026#34;]\u0026#34;; return result.replace(/\u0026#39;/g, \u0026#39;\u0026#34;\u0026#39;); } else { // å¤„ç†æ™®é€šå¯¹è±¡ let result = []; Object.keys(data).forEach((item, index) =\u0026gt; { if (typeof item !== \u0026#34;symbol\u0026#34;) { //key å¦‚æœæ˜¯ symbol å¯¹è±¡ï¼Œå¿½ç•¥ if ( data[item] !== undefined \u0026amp;\u0026amp; typeof data[item] !== \u0026#34;function\u0026#34; \u0026amp;\u0026amp; typeof data[item] !== \u0026#34;symbol\u0026#34; ) { //é”®å€¼å¦‚æœæ˜¯ undefinedã€functionã€symbol ä¸ºå±æ€§å€¼ï¼Œå¿½ç•¥ result.push( \u0026#39;\u0026#34;\u0026#39; + item + \u0026#39;\u0026#34;\u0026#39; + \u0026#34;:\u0026#34; + jsonStringify(data[item]) ); } } }); return (\u0026#34;{\u0026#34; + result + \u0026#34;}\u0026#34;).replace(/\u0026#39;/g, \u0026#39;\u0026#34;\u0026#39;); } } } \u0026nbsp;æ‰‹å†™runGenerator \u0026nbsp;æ‰‹å†™Promise 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 const PENDING = \u0026#34;PENDING\u0026#34;; const FULFILLED = \u0026#34;FULFILLED\u0026#34;; const REJECTED = \u0026#34;REJECTED\u0026#34;; // åˆ©ç”¨xçš„å€¼æ¥åˆ¤æ–­æ˜¯è°ƒç”¨promise2çš„resolveè¿˜æ˜¯reject function resolvePromise(promise2, x, resolve, reject) { // æ ¸å¿ƒæµç¨‹ if (promise2 === x) { return reject(new TypeError(\u0026#34;é”™è¯¯\u0026#34;)); } // æˆ‘å¯èƒ½å†™çš„promise è¦å’Œåˆ«äººçš„promiseå…¼å®¹ï¼Œè€ƒè™‘ä¸æ˜¯è‡ªå·±å†™çš„promiseæƒ…å†µ if ((typeof x === \u0026#34;object\u0026#34; \u0026amp;\u0026amp; x !== null) || typeof x === \u0026#34;function\u0026#34;) { // æœ‰å¯èƒ½æ˜¯promise // åˆ«äººçš„promiseå¯èƒ½è°ƒç”¨æˆåŠŸå è¿˜èƒ½è°ƒç”¨å¤±è´¥~~~ ç¡®ä¿äº†åˆ«äººpromiseç¬¦åˆè§„èŒƒ let called = false; try { // æœ‰å¯èƒ½thenæ–¹æ³•æ˜¯é€šè¿‡definePropertyæ¥å®ç°çš„ å–å€¼æ—¶å¯èƒ½ä¼šå‘ç”Ÿå¼‚å¸¸ let then = x.then; if (typeof then === \u0026#34;function\u0026#34;) { // è¿™é‡Œæˆ‘å°±è®¤ä¸ºä½ æ˜¯promiseäº† x.then è¿™æ ·å†™ä¼šè§¦å‘getterå¯èƒ½ä¼šå‘ç”Ÿå¼‚å¸¸ then.call( x, (y) =\u0026gt; { if (called) return; called = true; resolvePromise(promise2, y, resolve, reject); // ç›´åˆ°è§£æä»–ä¸æ˜¯promiseä½ç½® }, (r) =\u0026gt; { // reason if (called) return; called = true; reject(r); } ); } else { // {} {then:{}} resolve(x); // å¸¸é‡ } } catch (e) { if (called) return; called = true; reject(e); } } else { resolve(x); // è¯´æ˜è¿”å›çš„æ˜¯ä¸€ä¸ªæ™®é€šå€¼ ç›´æ¥å°†ä»–æ”¾åˆ°promise2.resolveä¸­ } } class Promise { constructor(executor) { this.status = PENDING; // promiseé»˜è®¤çš„çŠ¶æ€ this.value = undefined; // æˆåŠŸçš„åŸå›  this.reason = undefined; // å¤±è´¥çš„åŸå›  this.onResolvedCallbacks = []; // å­˜æ”¾æˆåŠŸçš„å›è°ƒæ–¹æ³• this.onRejectedCallbacks = []; // å­˜æ”¾å¤±è´¥çš„å›è°ƒæ–¹æ³• const resolve = (value) =\u0026gt; { // æˆåŠŸresolveå‡½æ•° if (value instanceof Promise) { return value.then(resolve, reject); } if (this.status === PENDING) { this.value = value; this.status = FULFILLED; // ä¿®æ”¹çŠ¶æ€ // å‘å¸ƒ this.onResolvedCallbacks.forEach((fn) =\u0026gt; fn()); } }; const reject = (reason) =\u0026gt; { // å¤±è´¥çš„rejectå‡½æ•° if (this.status === PENDING) { this.reason = reason; this.status = REJECTED; // ä¿®æ”¹çŠ¶æ€ this.onRejectedCallbacks.forEach((fn) =\u0026gt; fn()); } }; try { executor(resolve, reject); } catch (e) { reject(e); } } // thenä¸­çš„å‚æ•°æ˜¯å¯é€‰çš„ then(onFulfilled, onRejected) { // onFulfilled, onRejected onFulfilled = typeof onFulfilled === \u0026#34;function\u0026#34; ? onFulfilled : (v) =\u0026gt; v; onRejected = typeof onRejected === \u0026#34;function\u0026#34; ? onRejected : (err) =\u0026gt; { throw err; }; // ç”¨äºå®ç°é“¾å¼è°ƒç”¨ let promise2 = new Promise((resolve, reject) =\u0026gt; { // è®¢é˜…æ¨¡å¼ if (this.status == FULFILLED) { // æˆåŠŸè°ƒç”¨æˆåŠŸæ–¹æ³• setTimeout(() =\u0026gt; { try { let x = onFulfilled(this.value); // æ­¤x å¯èƒ½æ˜¯ä¸€ä¸ªpromiseï¼Œ å¦‚æœæ˜¯promiseéœ€è¦çœ‹ä¸€ä¸‹è¿™ä¸ªpromiseæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ .then ,å¦‚æœæˆåŠŸåˆ™æŠŠæˆåŠŸçš„ç»“æœ è°ƒç”¨promise2çš„resolveä¼ é€’è¿›å»ï¼Œå¦‚æœå¤±è´¥åˆ™åŒç† // æ€»ç»“ xçš„å€¼ å†³å®šæ˜¯è°ƒç”¨promise2çš„ resolveè¿˜æ˜¯rejectï¼Œå¦‚æœæ˜¯promiseåˆ™å–ä»–çš„çŠ¶æ€ï¼Œå¦‚æœæ˜¯æ™®é€šå€¼åˆ™ç›´æ¥è°ƒç”¨resolve resolvePromise(promise2, x, resolve, reject); } catch (e) { reject(e); } }, 0); } if (this.status === REJECTED) { // å¤±è´¥è°ƒç”¨å¤±è´¥æ–¹æ³• setTimeout(() =\u0026gt; { try { let x = onRejected(this.reason); resolvePromise(promise2, x, resolve, reject); } catch (e) { reject(e); } }, 0); } if (this.status == PENDING) { // ä»£ç æ˜¯å¼‚æ­¥è°ƒç”¨resolveæˆ–è€…rejectçš„ this.onResolvedCallbacks.push(() =\u0026gt; { // åˆ‡ç‰‡ç¼–ç¨‹ AOP setTimeout(() =\u0026gt; { try { // todo... let x = onFulfilled(this.value); resolvePromise(promise2, x, resolve, reject); } catch (e) { reject(e); } }, 0); }); this.onRejectedCallbacks.push(() =\u0026gt; { setTimeout(() =\u0026gt; { try { // todo... let x = onRejected(this.reason); resolvePromise(promise2, x, resolve, reject); } catch (e) { reject(e); } }, 0); }); } }); return promise2; } static resolve(value) { return new Promise((resolve, reject) =\u0026gt; { resolve(value); }); } static reject(value) { return new Promise((resolve, reject) =\u0026gt; { reject(value); }); } catch(errorFn) { return this.then(null, errorFn); } } // npm install promises-aplus-tests -g // å»¶è¿Ÿå¯¹è±¡ å¸®æˆ‘ä»¬å‡å°‘ä¸€æ¬¡å¥—ç”¨ ï¼š é’ˆå¯¹ç›®å‰æ¥è¯´ åº”ç”¨ä¸æ˜¯å¾ˆå¹¿æ³› Promise.deferred = function () { let dfd = {}; dfd.promise = new Promise((resolve, reject) =\u0026gt; { dfd.resolve = resolve; dfd.reject = reject; }); return dfd; }; module.exports = Promise; \u0026nbsp;æ‰‹å†™Promise.race 1 2 3 4 5 6 7 8 9 10 11 Promise.race = function (arr) { return new Promise(function (resolve, reject) { if (!Array.isArray(arr)) { return reject(new TypeError(\u0026#34;Promise.race accepts an array\u0026#34;)); } for (var i = 0, len = arr.length; i \u0026lt; len; i++) { Promise.resolve(arr[i]).then(resolve, reject); } }); }; \u0026nbsp;æ‰‹å†™Promise.all 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 static all = function (promises) { return new Promise((resolve, reject) =\u0026gt; { let result = []; let times = 0; const processSuccess = (index, val) =\u0026gt; { result[index] = val; if (++times === promises.length) { resolve(result); } }; for (let i = 0; i \u0026lt; promises.length; i++) { // å¹¶å‘ å¤šä¸ªè¯·æ±‚ä¸€èµ·æ‰§è¡Œçš„ let p = promises[i]; if (p \u0026amp;\u0026amp; typeof p.then === \u0026#34;function\u0026#34;) { p.then((data) =\u0026gt; { processSuccess(i, data); }, reject); // å¦‚æœå…¶ä¸­æŸä¸€ä¸ªpromiseå¤±è´¥äº† ç›´æ¥æ‰§è¡Œå¤±è´¥å³å¯ } else { processSuccess(i, p); } } }); }; \u0026nbsp;å®ç°lodash.get å®ç°ç±»ä¼¼ lodash.get ï¼Œæœ‰ä»¥ä¸‹æµ‹è¯•ç”¨ä¾‹:\n1 2 3 4 5 6 7 8 9 10 var object = { a: [{ b: { c: 3 } }] }; get(object, \u0026#34;a[0].b.c\u0026#34;); // =\u0026gt; 3 get(object, [\u0026#34;a\u0026#34;, \u0026#34;0\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;]); // =\u0026gt; 3 get(object, \u0026#34;a.b.c\u0026#34;, \u0026#34;default\u0026#34;); // =\u0026gt; \u0026#39;default\u0026#39; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 /** * object: å¯¹è±¡ * path: è¾“å…¥çš„è·¯å¾„ * defaultVal: é»˜è®¤å€¼ **/ function get(object, path, defaultVal = \u0026#34;undefined\u0026#34;) { // å…ˆå°†pathå¤„ç†æˆç»Ÿä¸€æ ¼å¼ let newPath = []; if (Array.isArray(path)) { newPath = path; } else { // å…ˆå°†å­—ç¬¦ä¸²ä¸­çš„\u0026#39;[\u0026#39;ã€\u0026#39;]\u0026#39;å»é™¤æ›¿æ¢ä¸º\u0026#39;.\u0026#39;ï¼Œsplitåˆ†å‰²æˆæ•°ç»„å½¢å¼ newPath = path.replace(/\\[/g, \u0026#34;.\u0026#34;).replace(/\\]/g, \u0026#34;\u0026#34;).split(\u0026#34;.\u0026#34;); } // é€’å½’å¤„ç†ï¼Œè¿”å›æœ€åç»“æœ return ( newPath.reduce((o, k) =\u0026gt; { // console.log(o, k); // æ­¤å¤„oåˆå§‹å€¼ä¸ºä¸‹è¾¹ä¼ å…¥çš„ objectï¼Œåç»­å€¼ä¸ºæ¯æ¬¡å–çš„å†…éƒ¨å€¼ return (o || {})[k]; }, object) || defaultVal ); } \u0026nbsp;æ‰‹å†™JSç»§æ‰¿ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 //åŸå‹é“¾ç»§æ‰¿ //ç¼ºç‚¹ï¼šParent1å’ŒChild1åˆ›å»ºçš„ä¸¤ä¸ªå®ä¾‹ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªåŸå‹å¯¹è±¡ï¼Œå®ƒä»¬çš„å†…å­˜ç©ºé—´æ˜¯å…±äº«çš„ï¼Œå½“ä¸€ä¸ªå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿéšä¹‹è¿›è¡Œäº†å˜åŒ– function Parent1() { this.name = \u0026#34;parent1\u0026#34;; this.play = [1, 2, 3]; } function Child1() { this.type = \u0026#34;child2\u0026#34;; } Child1.prototype = new Parent1(); //æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆå€ŸåŠ© callï¼‰ //ç¼ºç‚¹ï¼šçˆ¶ç±»åŸå‹å¯¹è±¡ä¸­ä¸€æ—¦å­˜åœ¨çˆ¶ç±»ä¹‹å‰è‡ªå·±å®šä¹‰çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå­ç±»å°†æ— æ³•ç»§æ‰¿è¿™äº›æ–¹æ³• function Parent2() { this.name = \u0026#34;parent1\u0026#34;; } Parent2.prototype.getName = function () { return this.name; }; function Child2() { Parent2.call(this); this.type = \u0026#34;child1\u0026#34;; } let child = new Child2(); console.log(child); // æ²¡é—®é¢˜ console.log(child.getName()); // ä¼šæŠ¥é”™ //ç»„åˆç»§æ‰¿ï¼ˆå‰ä¸¤ç§ç»„åˆï¼‰ //ç¼ºç‚¹ï¼šParent3 æ‰§è¡Œäº†ä¸¤æ¬¡ function Parent3() { this.name = \u0026#34;parent3\u0026#34;; this.play = [1, 2, 3]; } Parent3.prototype.getName = function () { return this.name; }; function Child3() { // â‘¡ ç¬¬äºŒæ¬¡è°ƒç”¨ Parent3() Parent3.call(this); this.type = \u0026#34;child3\u0026#34;; } // â‘  ç¬¬ä¸€æ¬¡è°ƒç”¨ Parent3() Child3.prototype = new Parent3(); // æ‰‹åŠ¨æŒ‚ä¸Šæ„é€ å™¨ï¼ŒæŒ‡å‘è‡ªå·±çš„æ„é€ å‡½æ•° Child3.prototype.constructor = Child3; var s3 = new Child3(); var s4 = new Child3(); s3.play.push(4); console.log(s3.play, s4.play); // ä¸äº’ç›¸å½±å“ console.log(s3.getName()); // æ­£å¸¸è¾“å‡º\u0026#39;parent3\u0026#39; console.log(s4.getName()); // æ­£å¸¸è¾“å‡º\u0026#39;parent3\u0026#39; //åŸå‹å¼ç»§æ‰¿ //ç¼ºç‚¹ï¼šå¤šä¸ªå®ä¾‹çš„å¼•ç”¨ç±»å‹å±æ€§æŒ‡å‘ç›¸åŒçš„å†…å­˜ï¼Œå­˜åœ¨ç¯¡æ”¹çš„å¯èƒ½ let parent4 = { name: \u0026#34;parent4\u0026#34;, friends: [\u0026#34;p1\u0026#34;, \u0026#34;p2\u0026#34;, \u0026#34;p3\u0026#34;], getName: function () { return this.name; }, }; let person4 = Object.create(parent4); person4.name = \u0026#34;tom\u0026#34;; person4.friends.push(\u0026#34;jerry\u0026#34;); //é€šè¿‡ Object.create()è¿™ä¸ªæ–¹æ³•å¯ä»¥å®ç°æ™®é€šå¯¹è±¡çš„ç»§æ‰¿ //ä¸ä»…ä»…èƒ½ç»§æ‰¿å±æ€§ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ç»§æ‰¿ getName çš„æ–¹æ³• let person5 = Object.create(parent4); person5.friends.push(\u0026#34;lucy\u0026#34;); console.log(person4.name); //tom console.log(person4.name === person4.getName()); //true console.log(person5.name); //parent4 console.log(person4.friends); //[\u0026#34;p1\u0026#34;, \u0026#34;p2\u0026#34;, \u0026#34;p3\u0026#34;, \u0026#34;jerry\u0026#34;, \u0026#34;lucy\u0026#34;] console.log(person5.friends); //[\u0026#34;p1\u0026#34;, \u0026#34;p2\u0026#34;, \u0026#34;p3\u0026#34;, \u0026#34;jerry\u0026#34;, \u0026#34;lucy\u0026#34;] //å¯„ç”Ÿå¼ç»§æ‰¿ //ä¼˜ç¼ºç‚¹å’ŒåŸå‹å¼ç»§æ‰¿ä¸€æ ·ï¼Œä½†æ˜¯å¯¹äºæ™®é€šå¯¹è±¡çš„ç»§æ‰¿æ–¹å¼æ¥è¯´ï¼Œå¯„ç”Ÿå¼ç»§æ‰¿ç›¸æ¯”äºåŸå‹å¼ç»§æ‰¿ï¼Œè¿˜æ˜¯åœ¨çˆ¶ç±»åŸºç¡€ä¸Šæ·»åŠ äº†æ›´å¤šçš„æ–¹æ³•ã€‚ let parent5 = { name: \u0026#34;parent5\u0026#34;, friends: [\u0026#34;p1\u0026#34;, \u0026#34;p2\u0026#34;, \u0026#34;p3\u0026#34;], getName: function () { return this.name; }, }; function clone(original) { let clone = Object.create(original); clone.getFriends = function () { return this.friends; }; return clone; } let person5 = clone(parent5); console.log(person5.getName()); console.log(person5.getFriends()); //å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ //extendsåŸç† function clone(parent, child) { // è¿™é‡Œæ”¹ç”¨ Object.create å°±å¯ä»¥å‡å°‘ç»„åˆç»§æ‰¿ä¸­å¤šè¿›è¡Œä¸€æ¬¡æ„é€ çš„è¿‡ç¨‹ child.prototype = Object.create(parent.prototype); child.prototype.constructor = child; } function Parent6() { this.name = \u0026#34;parent6\u0026#34;; this.play = [1, 2, 3]; } Parent6.prototype.getName = function () { return this.name; }; function Child6() { Parent6.call(this); this.friends = \u0026#34;child5\u0026#34;; } clone(Parent6, Child6); Child6.prototype.getFriends = function () { return this.friends; }; let person6 = new Child6(); console.log(person6); console.log(person6.getName()); console.log(person6.getFriends()); ","permalink":"https://zzydev.top/posts/eight-part-essay/%E6%9C%89%E6%89%8B%E5%B0%B1%E8%A1%8C/","summary":"\u0026nbsp;æ‰‹å†™ instanceof 1 2 3 4 5 6 7 8 9 function myInstanceof(Left, Right) { if (typeof Left !== \u0026#34;object\u0026#34; || Left === null) return false; let proto = Object.getPrototypeOf(Left); while (true) { if (proto == null) return false; if (proto == Right.prototype) return true; proto = Object.getPrototypeOf(proto); } } \u0026nbsp;æ‰‹å†™ getType 1 2 3 4","title":"æœ‰æ‰‹å°±è¡Œ"},{"content":" \u0026nbsp;Pick ğŸ’¯Take a Challenge\nå®ç° TS å†…ç½®çš„ Pick\u0026lt;T, K\u0026gt;ï¼Œä½†ä¸å¯ä»¥ä½¿ç”¨å®ƒã€‚\nä»ç±»å‹ T ä¸­é€‰æ‹©å‡ºå±æ€§ Kï¼Œæ„é€ æˆä¸€ä¸ªæ–°çš„ç±»å‹ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 interface Todo { title: string; description: string; completed: boolean; } type TodoPreview = MyPick\u0026lt;Todo, \u0026#34;title\u0026#34; | \u0026#34;completed\u0026#34;\u0026gt;; const todo: TodoPreview = { title: \u0026#34;Clean room\u0026#34;, completed: false, }; ç­”æ¡ˆï¼š\n1 2 3 type MyPick\u0026lt;T, K extends keyof T\u0026gt; = { [P in K]: T[P]; }; \u0026nbsp;å®ç° Readonly ğŸ’¯Take a Challenge\nä¸è¦ä½¿ç”¨å†…ç½®çš„Readonly\u0026lt;T\u0026gt;ï¼Œè‡ªå·±å®ç°ä¸€ä¸ªã€‚\nè¯¥ Readonly ä¼šæ¥æ”¶ä¸€ä¸ª æ³›å‹å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„ç±»å‹ï¼Œåªæ˜¯æ‰€æœ‰å±æ€§éƒ½ä¼šè¢« readonly æ‰€ä¿®é¥°ã€‚\nä¹Ÿå°±æ˜¯ä¸å¯ä»¥å†å¯¹è¯¥å¯¹è±¡çš„å±æ€§èµ‹å€¼ã€‚ ä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 interface Todo { title: string; description: string; } const todo: MyReadonly\u0026lt;Todo\u0026gt; = { title: \u0026#34;Hey\u0026#34;, description: \u0026#34;foobar\u0026#34;, }; todo.title = \u0026#34;Hello\u0026#34;; // Error: cannot reassign a readonly property todo.description = \u0026#34;barFoo\u0026#34;; // Error: cannot reassign a readonly property ç­”æ¡ˆï¼š\n1 2 3 type MyReadonly\u0026lt;T\u0026gt; = { readonly [P in keyof T]: T[P]; }; \u0026nbsp;Tuple To Object ğŸ’¯Take a Challenge\nä¼ å…¥ä¸€ä¸ªå…ƒç»„ç±»å‹ï¼Œå°†è¿™ä¸ªå…ƒç»„ç±»å‹è½¬æ¢ä¸ºå¯¹è±¡ç±»å‹ï¼Œè¿™ä¸ªå¯¹è±¡ç±»å‹çš„é”®/å€¼éƒ½æ˜¯ä»å…ƒç»„ä¸­éå†å‡ºæ¥ã€‚\nä¾‹å¦‚ï¼š\n1 2 const tuple = [\u0026#34;tesla\u0026#34;, \u0026#34;model 3\u0026#34;, \u0026#34;model X\u0026#34;, \u0026#34;model Y\u0026#34;] as const; type result = TupleToObject\u0026lt;typeof tuple\u0026gt;; // expected { tesla: \u0026#39;tesla\u0026#39;, \u0026#39;model 3\u0026#39;: \u0026#39;model 3\u0026#39;, \u0026#39;model X\u0026#39;: \u0026#39;model X\u0026#39;, \u0026#39;model Y\u0026#39;: \u0026#39;model Y\u0026#39;} ç­”æ¡ˆï¼š ç´¢å¼•ç±»å‹\n1 2 3 4 type TupleToObject\u0026lt;T extends readonly any[]\u0026gt; = { [P in T[number]]: P; }; // T[number]ç´¢å¼•ç±»å‹è®¿é—®ï¼Œå¾—åˆ°è”åˆç±»å‹ï¼š\u0026#34;tesla\u0026#34; | \u0026#34;model 3\u0026#34; | \u0026#34;model X\u0026#34; | \u0026#34;model Y\u0026#34; \u0026nbsp;First of Array ğŸ’¯Take a Challenge\nå®ç°ä¸€ä¸ªé€šç”¨First\u0026lt;T\u0026gt;ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„Tå¹¶è¿”å›å®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 5 type arr1 = [\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;]; type arr2 = [3, 2, 1]; type head1 = First\u0026lt;arr1\u0026gt;; // expected to be \u0026#39;a\u0026#39; type head2 = First\u0026lt;arr2\u0026gt;; // expected to be 3 ç­”æ¡ˆï¼š ç®€å•æ¨¡å¼åŒ¹é…\n1 2 3 type MyFirst\u0026lt;T extends unknown[]\u0026gt; = T extends [infer R, ...unknown[]] ? R : never; \u0026nbsp;Length of Tuple ğŸ’¯Take a Challenge\nåˆ›å»ºä¸€ä¸ªé€šç”¨çš„ Lengthï¼Œæ¥å—ä¸€ä¸ª readonly çš„æ•°ç»„ï¼Œè¿”å›è¿™ä¸ªæ•°ç»„çš„é•¿åº¦ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 type tesla = [\u0026#34;tesla\u0026#34;, \u0026#34;model 3\u0026#34;, \u0026#34;model X\u0026#34;, \u0026#34;model Y\u0026#34;]; type spaceX = [ \u0026#34;FALCON 9\u0026#34;, \u0026#34;FALCON HEAVY\u0026#34;, \u0026#34;DRAGON\u0026#34;, \u0026#34;STARSHIP\u0026#34;, \u0026#34;HUMAN SPACEFLIGHT\u0026#34; ]; type teslaLength = Length\u0026lt;tesla\u0026gt;; // expected 4 type spaceXLength = Length\u0026lt;spaceX\u0026gt;; // expected 5 ç­”æ¡ˆï¼š\n1 2 3 type MyLength\u0026lt;T extends any\u0026gt; = T extends { length: number } ? T[\u0026#34;length\u0026#34;] : never; \u0026nbsp;Exclude ğŸ’¯Take a Challenge\nå®ç°å†…ç½®çš„ Exclude \u0026lt;T, U\u0026gt;ç±»å‹ï¼Œä½†ä¸èƒ½ç›´æ¥ä½¿ç”¨å®ƒæœ¬èº«ã€‚\nä»è”åˆç±»å‹ T ä¸­æ’é™¤ U çš„ç±»å‹æˆå‘˜ï¼Œæ¥æ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹ã€‚\nç­”æ¡ˆï¼š åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹\n1 type MyExclude\u0026lt;T, U\u0026gt; = T extends U ? never : T; \u0026nbsp;Awaited ğŸ’¯Take a Challenge\nå‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™ä¸ª Promise å¯¹è±¡ä¼šè¿”å›ä¸€ä¸ªç±»å‹ã€‚åœ¨ TS ä¸­ï¼Œæˆ‘ä»¬ç”¨ Promise ä¸­çš„ T æ¥æè¿°è¿™ä¸ª Promise è¿”å›çš„ç±»å‹ã€‚è¯·ä½ å®ç°ä¸€ä¸ªç±»å‹ï¼Œå¯ä»¥è·å–è¿™ä¸ªç±»å‹ã€‚\næ¯”å¦‚ï¼šPromise\u0026lt;ExampleType\u0026gt;ï¼Œè¯·ä½ è¿”å› ExampleType ç±»å‹ã€‚\nè¿™ä¸ªæŒ‘æˆ˜æ¥è‡ªäº @maciejsikora çš„æ–‡ç« ï¼šoriginal article\nç­”æ¡ˆ:\n1 2 3 4 5 type MyAwaited\u0026lt;P extends Promise\u0026lt;unknown\u0026gt;\u0026gt; = P extends Promise\u0026lt;infer ValueType\u0026gt; ? ValueType extends Promise\u0026lt;unknown\u0026gt; ? MyAwaited\u0026lt;ValueType\u0026gt; : ValueType : never; \u0026nbsp;If ğŸ’¯Take a Challenge\nå®ç°ä¸€ä¸ª IF ç±»å‹ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ¡ä»¶ç±»å‹ C ï¼Œä¸€ä¸ªåˆ¤æ–­ä¸ºçœŸæ—¶çš„è¿”å›ç±»å‹ T ï¼Œä»¥åŠä¸€ä¸ªåˆ¤æ–­ä¸ºå‡æ—¶çš„è¿”å›ç±»å‹ Fã€‚ C åªèƒ½æ˜¯ true æˆ–è€… falseï¼Œ T å’Œ F å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚\nä¸¾ä¾‹:\n1 2 type A = If\u0026lt;true, \u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;\u0026gt;; // expected to be \u0026#39;a\u0026#39; type B = If\u0026lt;false, \u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;\u0026gt;; // expected to be \u0026#39;b\u0026#39; ç­”æ¡ˆ:\n1 type If\u0026lt;C extends boolean, T, F\u0026gt; = C extends true ? T : F; \u0026nbsp;Concat ğŸ’¯Take a Challenge\nåœ¨ç±»å‹ç³»ç»Ÿé‡Œå®ç° JavaScript å†…ç½®çš„ Array.concat æ–¹æ³•ï¼Œè¿™ä¸ªç±»å‹æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›çš„æ–°æ•°ç»„ç±»å‹åº”è¯¥æŒ‰ç…§è¾“å…¥å‚æ•°ä»å·¦åˆ°å³çš„é¡ºåºåˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚\nä¸¾ä¾‹ï¼Œ\n1 type Result = Concat\u0026lt;[1], [2]\u0026gt;; // expected to be [1, 2] ç­”æ¡ˆ:\n1 type Concat\u0026lt;T extends any[], U extends any[]\u0026gt; = [...T, ...U]; \u0026nbsp;Includes ğŸ’¯Take a Challenge\nåœ¨ç±»å‹ç³»ç»Ÿé‡Œå®ç° JavaScript çš„ Array.includes æ–¹æ³•ï¼Œè¿™ä¸ªç±»å‹æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›çš„ç±»å‹è¦ä¹ˆæ˜¯ true è¦ä¹ˆæ˜¯ falseã€‚\nä¸¾ä¾‹æ¥è¯´ï¼Œ\n1 type isPillarMen = Includes\u0026lt;[\u0026#34;Kars\u0026#34;, \u0026#34;Esidisi\u0026#34;, \u0026#34;Wamuu\u0026#34;, \u0026#34;Santana\u0026#34;], \u0026#34;Dio\u0026#34;\u0026gt;; // expected to be `false` ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 type IsEqual\u0026lt;A, B\u0026gt; = (A extends B ? true : false) \u0026amp; (B extends A ? true : false); type Includes\u0026lt;Arr extends unknown[], FindItem\u0026gt; = Arr extends [ infer First, ...infer Rest ] ? IsEqual\u0026lt;First, FindItem\u0026gt; extends true ? true : Includes\u0026lt;Rest, FindItem\u0026gt; : false; \u0026nbsp;Push ğŸ’¯Take a Challenge\nåœ¨ç±»å‹ç³»ç»Ÿé‡Œå®ç°é€šç”¨çš„ Array.push ã€‚\nä¸¾ä¾‹å¦‚ä¸‹ï¼Œ\n1 type Result = Push\u0026lt;[1, 2], \u0026#34;3\u0026#34;\u0026gt;; // [1, 2, \u0026#39;3\u0026#39;] ç­”æ¡ˆ:\n1 type Push\u0026lt;Arr extends unknown[], Elem\u0026gt; = [...Arr, Elem]; \u0026nbsp;Unshift ğŸ’¯Take a Challenge\nå®ç°ç±»å‹ç‰ˆæœ¬çš„ Array.unshiftã€‚\nä¸¾ä¾‹ï¼Œ\n1 type Result = Unshift\u0026lt;[1, 2], 0\u0026gt;; // [0, 1, 2,] ç­”æ¡ˆ:\n1 type Unshift\u0026lt;Arr extends unknown[], Elem\u0026gt; = [Elem, ...Arr]; \u0026nbsp;Parameters ğŸ’¯Take a Challenge\nå®ç°å†…ç½®çš„ Parameters ç±»å‹ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨å®ƒï¼Œå¯å‚è€ƒTypeScript å®˜æ–¹æ–‡æ¡£ã€‚\nç­”æ¡ˆ:\n1 2 3 4 5 type MyParameters\u0026lt;Func extends Function\u0026gt; = Func extends ( ...args: infer Args ) =\u0026gt; unknown ? Args : never; ","permalink":"https://zzydev.top/posts/headfirstts/ts%E7%B1%BB%E5%9E%8B%E6%8C%91%E6%88%98easy%E7%AF%87/","summary":"\u0026nbsp;Pick ğŸ’¯Take a Challenge å®ç° TS å†…ç½®çš„ Pick\u0026lt;T, K\u0026gt;ï¼Œä½†ä¸å¯ä»¥ä½¿ç”¨å®ƒã€‚ ä»ç±»å‹ T ä¸­é€‰æ‹©å‡ºå±æ€§ Kï¼Œæ„é€ æˆä¸€ä¸ªæ–°çš„ç±»å‹ã€‚ ä¾‹å¦‚ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 interface Todo { title:","title":"TSç±»å‹æŒ‘æˆ˜Easyç¯‡"},{"content":" æˆ‘æ˜¯æ²¡äº‹çš„æ—¶å€™\nåœ¨æ— èŠçš„æ—¶å€™ï¼Œæƒ³çš„æ—¶å€™\nåˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œä¸ç›¸åŒçš„åœ°æ–¹\nåˆ°è¿™ä¸ªåœ°æ–¹æ¥ï¼Œæ¥åˆ°å§\nå¯ä»¥ç§ç§ï¼Œä¸ä¸€æ ·çš„åœ°æ–¹\nä¸ç›¸åŒçš„åœ°æ–¹\nå¾ˆå¤šï¼Œå¾ˆå¤šâ€¦â€¦\n\u0026mdash;\u0026mdash;\u0026mdash; æ·³Â·ç®€Â·æ‹‰åŸºèŒ¨å¾·\n\u0026nbsp;Symbolä¸èƒ½ä½¿ç”¨newæ“ä½œç¬¦ï¼Œé‚£å¦‚ä½•å¾—åˆ°ä¸€ä¸ªSymbolç±»å‹çš„å¯¹è±¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 //åˆ©ç”¨ä¸€ä¸ªå‡½æ•°çš„callæ–¹æ³•æ¥å¼ºè¿«äº§ç”Ÿè£…ç®± var symbolObject = function () { return this; }.call(Symbol(\u0026#34;a\u0026#34;)); console.log(typeof symbolObject); //object console.log(symbolObject instanceof Symbol); //true console.log(symbolObject.constructor == Symbol); //true //ä½¿ç”¨å†…ç½®çš„ Object å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ JavaScript ä»£ç ä¸­æ˜¾å¼è°ƒç”¨è£…ç®±èƒ½åŠ› var symbolObject = Object(Symbol(\u0026#34;a\u0026#34;)); console.log(typeof symbolObject); //object console.log(symbolObject instanceof Symbol); //true console.log(symbolObject.constructor == Symbol); //true //æ¯ä¸€ç±»è£…ç®±å¯¹è±¡çš†æœ‰ç§æœ‰çš„Classå±æ€§ï¼Œè¿™äº›å±æ€§å¯ä»¥ç”¨ Object.prototype.toString è·å–ï¼š console.log(Object.prototype.toString.call(symbolObject)); //[object Symbol] //åœ¨JSä¸­ï¼Œæ²¡æœ‰ä»»ä½•æ–¹æ³•å¯ä»¥æ›´æ”¹ç§æœ‰çš„Classå±æ€§ \u0026nbsp;new fnä¸new fn()æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ 1 2 3 4 5 6 7 8 9 10 11 function Parent() { this.num = 1; } console.log(new Parent()); //è¾“å‡ºParentå¯¹è±¡ï¼š{num:1} console.log(new Parent()); //è¾“å‡ºParentå¯¹è±¡ï¼š{num:1} function Parent() { this.num = 1; } console.log(new Parent().num); //1 console.log(new Parent.num()); //æŠ¥é”™ ä»æŠ¥é”™ä¿¡æ¯æ¥çœ‹ï¼Œnew Parent.numæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼šå…ˆæ‰§è¡ŒParent.numï¼Œæ­¤æ—¶è¿”å›ç»“æœä¸ºundefinedï¼›åæ‰§è¡Œnewï¼Œå› newåé¢å¿…é¡»è·Ÿæ„é€ å‡½æ•°ï¼Œæ‰€ä»¥new undefinedä¼šæŠ¥é”™ã€‚\nnew Parent().numç›¸å½“äº(new Parent()).numï¼Œæ‰€ä»¥ç»“æœè¿”å› 1ã€‚\n\u0026nbsp;æ‹†ç®±è½¬æ¢ç›¸å…³é—®é¢˜ å¯¹è±¡åˆ° String å’Œ Number çš„è½¬æ¢éƒ½éµå¾ªâ€œå…ˆæ‹†ç®±å†è½¬æ¢â€çš„è§„åˆ™ã€‚é€šè¿‡æ‹†ç®±è½¬æ¢ï¼ŒæŠŠå¯¹è±¡å˜æˆåŸºæœ¬ç±»å‹ï¼Œå†ä»åŸºæœ¬ç±»å‹è½¬æ¢ä¸ºå¯¹åº”çš„åŸå§‹ç±»å‹ã€‚\nSymbol.toPrimitive æ˜¯ä¸€ä¸ªå†…ç½®çš„ Symbol å€¼ï¼Œå®ƒæ˜¯ä½œä¸ºå¯¹è±¡çš„å‡½æ•°å€¼å±æ€§å­˜åœ¨çš„ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºå¯¹åº”çš„åŸå§‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 var o = { valueOf: () =\u0026gt; { console.log(\u0026#34;valueOf\u0026#34;); return {}; }, toString: () =\u0026gt; { console.log(\u0026#34;toString\u0026#34;); return {}; }, }; o[Symbol.toPrimitive] = () =\u0026gt; { return \u0026#34;hello\u0026#34;; }; console.log(o + \u0026#34;\u0026#34;); // hello // ç»ƒä¹ ä¸€ const arr = [4, 10]; arr[Symbol.toPrimitive] = function (hint) { return hint; }; arr.valueOf = function () { return this; }; const obj = {} + arr + obj + arr + obj; //\u0026#39;NaN[object Object]default[object Object]\u0026#39; { } +arr; //[object Object]default\u0026#39; // ç»ƒä¹ äºŒ const val = (([] == ![][(+val, [] + 1)]) == // \u0026#39;\u0026#39;è½¬æ•°å­—ä¸º0 [1, 1] + [][(+val, [] + 1)]) == //[1, \u0026#39;1\u0026#39;].toString() == [1, 1] + \u0026#39;\u0026#39; =\u0026gt; \u0026#39;1, 1\u0026#39; == \u0026#39;1, 1\u0026#39; true [1, \u0026#34;1\u0026#34;]; // false \u0026nbsp;[]â•[]ï¼Œ[]â•{}ï¼Œ{}â•[]ï¼Œ{}â•{} 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 // äºŒå…ƒæ“ä½œç¬¦ + çš„è§„åˆ™ // å¦‚æœæ“ä½œæ•°æ˜¯å¯¹è±¡ï¼Œåˆ™å¯¹è±¡ä¼šè½¬æ¢ä¸ºåŸå§‹å€¼ // å¦‚æœå…¶ä¸­ä¸€ä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°ä¹Ÿä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥ // å¦åˆ™ä¸¤ä¸ªæ“ä½œæ•°éƒ½å°†è½¬æ¢ä¸ºæ•°å­—æˆ–è€…NaNï¼Œè¿›è¡ŒåŠ æ³•æ“ä½œ 10n + 10 Symbol(10) + 10 // å¯¹è±¡è½¬æ¢ä¸ºåŸå§‹æ•°æ®ç±»å‹çš„å€¼ // Symbol.toPrimitive ä¼˜å…ˆçº§æœ€é«˜ // Object.prototype.valueOf // è°ƒç”¨ valueOfï¼Œå¦‚æœè½¬æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼ã€‚å¦‚æœä¸è¿”å›åŸå§‹ç±»å‹çš„å€¼å°±è°ƒç”¨toStringã€‚ // Object.prototype.toString // è°ƒç”¨toStringï¼Œå¦‚æœè½¬æ¢ä¸ºåŸå§‹ç±»å‹ï¼Œå°±è¿”å›è½¬æ¢çš„å€¼ã€‚å¦‚æœä¸è¿”å›åŸå§‹ç±»å‹çš„å€¼å°±è°ƒç”¨valueOfã€‚ typeof [][Symbol.toPrimitive] // undefined [].valueOf() // [] [].toString() // \u0026#39;\u0026#39; æ‰€ä»¥[]è½¬æ¢ä¸ºåŸå§‹å€¼æ˜¯â€˜â€™ typeof {}[Symbol.toPrimitive] //undefined ({}).valueOf() // {} ({}).toString() // \u0026#39;[object Object]\u0026#39; [] + [] // \u0026#34;\u0026#34; [] + {} // \u0026#34;[object Object]\u0026#34; {} + [] // 0 ç›¸å½“äº {}; + [] {} + {} // Chrome \u0026#39;[object Object][object Object]\u0026#39; å…¶ä»–æµè§ˆå™¨ NaN \u0026nbsp;toStringç›¸å…³é—®é¢˜ 1 2 3 4 5 6 7 8 9 10 11 const user = { name: \u0026#34;zzy\u0026#34;, id: 233, valueOf() { return this.id; }, }; console.log(`${user}`); //ä¼šè°ƒç”¨åŸå‹é“¾ä¸Šçš„toString è¿”å›[object Object] Object.prototype.toString = undefined; console.log(`${user}`); // 233 1 Object.prototype.toString.call(Boolean.prototype); // [object Boolean] \u0026nbsp;px % rem vh/vwæœ‰ä»€ä¹ˆåŒºåˆ« px æ˜¯ç»å¯¹å•ä½ï¼Œ\n% æ˜¯ç›¸å¯¹äºçˆ¶å…ƒç´ çš„æ¯”ä¾‹ï¼Œ\nem æ˜¯ç›¸å¯¹äºå½“å‰å…ƒç´ çš„ font-sizeï¼Œrem æ˜¯ç›¸å¯¹ä¸æ ¹(root)å…ƒç´ çš„ font-sizeï¼Œ\n1 2 3 4 5 6 7 \u0026lt;div style=\u0026#34;font-size:20px\u0026#34;\u0026gt; \u0026lt;p style=\u0026#34;text-indent: 2em; font-size: 40px\u0026#34;\u0026gt;é¦–è¡Œç¼©è¿›\u0026lt;/p\u0026gt; \u0026lt;p style=\u0026#34;text-indent: 2em\u0026#34;\u0026gt; è¿™ä¸ªå…ƒç´ çš„font-sizeç»§æ‰¿äº†çˆ¶å…ƒç´ çš„font-sizeï¼Œæ‰€ä»¥ç¼©è¿›æ¯”ä¸Šé¢çš„å°ä¸€äº› \u0026lt;/p\u0026gt; \u0026lt;p style=\u0026#34;font-size: 2rem\u0026#34;\u0026gt;ç›¸å¯¹æ ¹å…ƒç´ font-size\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; vh/vw æ˜¯å±å¹•çš„ç™¾åˆ†æ¯”\nvmin æ˜¯ min(å±å¹•å®½åº¦,å±å¹•é«˜åº¦)ã€vmax æ˜¯ max(å±å¹•å®½åº¦,å±å¹•é«˜åº¦)\n\u0026nbsp;for in å’Œ for ofçš„åŒºåˆ« éå†å¯¹è±¡ï¼šfor\u0026hellip;in å¯ä»¥, for\u0026hellip;of ä¸å¯ä»¥\néå† Mapã€Setï¼šfor\u0026hellip;of å¯ä»¥, for\u0026hellip;in ä¸å¯ä»¥\néå† generatorï¼šfor\u0026hellip;of å¯ä»¥, for\u0026hellip;in ä¸å¯ä»¥\n1 2 3 4 5 6 7 8 function* gen() { yield 1; yield 2; yield 3; } for (let i of gen()) { console.log(i); } for\u0026hellip;in ç”¨äºå¯æšä¸¾æ•°æ®ï¼Œå¦‚å¯¹è±¡ã€æ•°ç»„ã€å­—ç¬¦ä¸²\n1 2 3 4 5 6 Object.defineProperty(obj, \u0026#34;key\u0026#34;, { enumerable: true, // å¯æšä¸¾ configurable: false, writable: false, value: \u0026#34;static\u0026#34;, }); for\u0026hellip;of ç”¨äºå¯è¿­ä»£æ•°æ®ï¼Œå¦‚æ•°ç»„ã€å­—ç¬¦ä¸²ã€Setã€Map\nå­˜åœ¨ Symbol.iterator å±æ€§çš„å¯¹è±¡ï¼Œå¯ä»¥ç”¨ for\u0026hellip;of è¿­ä»£\nfor await of æœ‰ä»€ä¹ˆä½œç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 function createPromise(val) { return new Promise((resolve) =\u0026gt; { setTimeout(() =\u0026gt; { resolve(val); }, 1000); }); } (async function () { const p1 = createPromise(100); const p2 = createPromise(200); const res1 = await p1; console.log(res1); const res2 = await p2; console.log(res2); //ç›´æ¥ä¸‰ä¸ªä¸€èµ·æ‰“å°å‡ºæ¥ const list = [p1, p2]; Promise.all(list).then((res) =\u0026gt; console.log(res)); // Promise.allçš„ä»£æ›¿å“ //ç›´æ¥ä¸‰ä¸ªä¸€èµ·æ‰“å°å‡ºæ¥ for await (let res of list) { console.log(res); } //æ¯éš”ä¸€ç§’æ‰“å°ä¸€ä¸ª const arr = [100, 200]; for (let num of arr) { const res = await createPromise(num); console.log(res); } })(); \u0026nbsp;offsetHeightã€scrollHeightå’ŒclientHeightçš„åŒºåˆ« scrollHeight\nscrollTop\nscrollLeft\n\u0026nbsp;HTMLCollectionå’ŒNodeListçš„åŒºåˆ« Node æ˜¯ Element çš„åŸºç±»\nElement æ˜¯å…¶ä»– HTML å…ƒç´ çš„åŸºç±»ï¼Œå¦‚ HTMLDivElement HTMLCollection æ˜¯ Element çš„é›†åˆ\nNodeList æ˜¯ Node çš„é›†åˆ\nHTMLCollection å’Œ NodeList éƒ½æ˜¯ç±»æ•°ç»„\n1 2 3 4 \u0026lt;p id=\u0026#34;p1\u0026#34;\u0026gt; \u0026lt;b\u0026gt;node\u0026lt;/b\u0026gt; vs \u0026lt;em\u0026gt;element\u0026lt;/em \u0026gt;\u0026lt;!--æ³¨é‡Š--\u0026gt; \u0026lt;/p\u0026gt; 1 2 3 4 5 6 const p1 = document.getElementById(\u0026#34;p1\u0026#34;); console.log(p1.children); // ä¸åŒ…å«Textå’ŒComment æ˜¯HTMLCollectionç±»å‹ console.log(p1.childNode); // åŒ…å«Textå’ŒComment æ˜¯NodeListç±»å‹ p1.tagName; // Elementç±»å‹å±æ€§ p1.nodeName; // Nodeç±»å‹å±æ€§ \u0026nbsp;Nodeå’Œæµè§ˆå™¨çš„EventLoopæœ‰ä»€ä¹ˆåŒºåˆ« å¯ä»¥æŠŠæ‰§è¡Œæ ˆè®¤ä¸ºæ˜¯ä¸€ä¸ªå­˜å‚¨å‡½æ•°è°ƒç”¨çš„æ ˆç»“æ„ï¼Œéµå¾ªå…ˆè¿›åå‡ºçš„åŸåˆ™:\næµè§ˆå™¨ä¸­çš„ EventLoop å‡½æ•°ä¼šåœ¨æ‰§è¡Œæ ˆä¸­æ‰§è¡Œï¼Œå½“é‡åˆ°å¼‚æ­¥ä»£ç çš„æ—¶å€™ï¼Œä¼šè¢«æŒ‚èµ·åœ¨ Task é˜Ÿåˆ—ä¸­ï¼Œä¸€æ—¦æ‰§è¡Œæ ˆä¸ºç©ºï¼Œå°±ä¼šä» Task é˜Ÿåˆ—ä¸­æ‹¿å‡ºéœ€è¦æ‰§è¡Œçš„ä»£ç æ‰§è¡Œï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šè®² JS ä¸­çš„å¼‚æ­¥è¿˜æ˜¯åŒæ­¥è¡Œä¸ºã€‚ ä¸åŒçš„ä»»åŠ¡æºä¼šè¢«åˆ†é…åˆ°ä¸åŒçš„ Task é˜Ÿåˆ—ä¸­ï¼Œä»»åŠ¡æºå¯ä»¥åˆ†ä¸º å¾®ä»»åŠ¡ï¼ˆmicrotaskï¼‰ å’Œ å®ä»»åŠ¡ï¼ˆmacrotaskï¼‰ã€‚\nå®ä»»åŠ¡(scriptã€setTimeoutã€setIntervalã€setImmidiateã€I/Oã€UI Rendering) å¾®ä»»åŠ¡(procress.nextTickã€Promise.thenã€Object.observeã€mutataionObserver) Event Loop æ‰§è¡Œé¡ºåºå¦‚ä¸‹æ‰€ç¤ºï¼š\né¦–å…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œè¿™å±äºå®ä»»åŠ¡ å½“æ‰§è¡Œå®Œæ‰€æœ‰åŒæ­¥ä»£ç åï¼Œæ‰§è¡Œæ ˆä¸ºç©ºï¼ŒæŸ¥è¯¢æ˜¯å¦æœ‰å¼‚æ­¥ä»£ç éœ€è¦æ‰§è¡Œ æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ å½“æ‰§è¡Œå®Œæ‰€æœ‰å¾®ä»»åŠ¡åï¼Œå¦‚æœ‰å¿…è¦ä¼šæ¸²æŸ“é¡µé¢ ç„¶åå¼€å§‹ä¸‹ä¸€è½® Event Loopï¼Œæ‰§è¡Œå®ä»»åŠ¡ä¸­çš„å¼‚æ­¥ä»£ç ï¼Œä¹Ÿå°±æ˜¯ setTimeout ä¸­çš„å›è°ƒå‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 const $p1 = $(\u0026#34;\u0026lt;p\u0026gt;ä¸€æ®µæ–‡å­—\u0026lt;/p\u0026gt;\u0026#34;); const $p2 = $(\u0026#34;\u0026lt;p\u0026gt;ä¸€æ®µæ–‡å­—\u0026lt;/p\u0026gt;\u0026#34;); const $p3 = $(\u0026#34;\u0026lt;p\u0026gt;ä¸€æ®µæ–‡å­—\u0026lt;/p\u0026gt;\u0026#34;); $(\u0026#34;#container\u0026#34;).append($p1).append($p2).append($p3); //å¾®ä»»åŠ¡: DOMæ¸²æŸ“å‰è§¦å‘ Promise.resolve().then(() =\u0026gt; { console.log(\u0026#34;length1\u0026#34;, $(\u0026#34;#container\u0026#34;).children.length); // 3 alert(\u0026#34;Promise then\u0026#34;); // å‡ºç°alertå¼¹çª—ï¼ŒDOMæ­¤æ—¶æœªæ¸²æŸ“ }); //å®ä»»åŠ¡ï¼šDOMæ¸²æŸ“åè§¦å‘ setTimeout(() =\u0026gt; { console.log(\u0026#34;setTimeout\u0026#34;); }); \u0026nbsp;å›é¡¾PromiseçŸ¥è¯†ç‚¹ æ‰‹å†™ Promise\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 //Promise æœ‰ä¸‰ç§çŠ¶æ€ï¼špendingã€resolvedã€rejected //pending çŠ¶æ€çš„Promiseï¼Œä¸ä¼šè§¦å‘ then æˆ– catch //resolved çŠ¶æ€çš„ Promiseï¼Œ ä¼šè§¦å‘ then å›è°ƒå‡½æ•° //rejected çŠ¶æ€çš„ Promiseï¼Œ ä¼šè§¦å‘ catch å›è°ƒå‡½æ•° const p1 = new Promise((resolve, reject) =\u0026gt; { setTimeout(() =\u0026gt; { resolve(); }); }); console.log(\u0026#34;p1\u0026#34;, p1); // Promise {\u0026lt;pending\u0026gt;} setTimeout(() =\u0026gt; console.log(\u0026#34;p1-setTimeout\u0026#34;, p1)); // Promise { \u0026lt;resolved\u0026gt; } // ------------------------------------------------------------------------- // then æ­£å¸¸è¿”å› resolved çŠ¶æ€çš„ Promiseï¼Œé‡Œé¢æœ‰æŠ¥é”™åˆ™è¿”å› rejected çŠ¶æ€çš„ Promise // catch æ­£å¸¸è¿”å› resolved çŠ¶æ€çš„ Promiseï¼Œé‡Œé¢æœ‰æŠ¥é”™åˆ™è¿”å› rejected çŠ¶æ€çš„ Promise const p1 = Promise.reject(\u0026#34;my error\u0026#34;).catch((err) =\u0026gt; console.log(err)); console.log(\u0026#34;p1\u0026#34;, p1); // âš ï¸ Promise { \u0026lt;resolved\u0026gt; } const p2 = Promise.reject(\u0026#34;my error\u0026#34;).then( (err) =\u0026gt; throw new Error(\u0026#34;catch error\u0026#34;) ); console.log(\u0026#34;p2\u0026#34;, p2); // âš ï¸ Promise { \u0026lt;rejected\u0026gt; } Promise.resolve() .then(() =\u0026gt; console.log(1)) .catch(() =\u0026gt; { return new Error(\u0026#34;err\u0026#34;); }) .then(() =\u0026gt; console.log(3)) .catch((err) =\u0026gt; console.log(err)); // âš ï¸ 1 3 // ------------------------------------------------------------------------- // async å‡½æ•°è¿”å›çš„æ˜¯ Promise å¯¹è±¡ // await ç›¸å½“äº Promise çš„ then // try/catch å¯æ•è·å¼‚å¸¸ï¼Œç›¸å½“äº Promise çš„ catch async function fn1() { // return 100; ç›¸å½“äº return Promise.resolve(100) return Promise.resolve(100); } const res1 = fn1(); // res1: Promise { \u0026lt;resolved\u0026gt; } !(async function () { const p1 = Promise.resolve(100); const data = await p1; // await ç›¸å½“äº Promise çš„ then console.log(data); })(); !(async function () { const data = await 100; // ç›¸å½“äº await Promise.resolve(100); console.log(data); })(); !(async function () { const p1 = Promise.reject(new Error(\u0026#34;my error\u0026#34;)); try { const data = await p1; console.log(data); } catch (err) { console.error(err); // try catch ç›¸å½“äº Promise çš„ catch } })(); // ------------------------------------------------------------------------- async function async1() { console.log(\u0026#34;async1 start\u0026#34;); // 2 await async2(); //å…ˆæ‰§è¡Œ async2,å†æ‰§è¡Œ await çš„æ“ä½œ // await åé¢çš„å†…å®¹ï¼Œéƒ½å¯ä»¥çœ‹æˆ callback çš„å†…å®¹ï¼Œå¾®ä»»åŠ¡ console.log(\u0026#34;async1 end\u0026#34;); // 6 } async function async2() { console.log(\u0026#34;async2 start\u0026#34;); // 3 } console.log(\u0026#34;script start\u0026#34;); // 1 setTimeout(() =\u0026gt; { // å®ä»»åŠ¡ console.log(\u0026#34;setTimeout\u0026#34;); // 8 }); async1(); //åˆå§‹åŒ–Promiseæ—¶ï¼Œä¼ å…¥çš„å‡½æ•°ä¼šç«‹åˆ»è¢«æ‰§è¡Œ new Promise(function (resolve) { console.log(\u0026#34;Promise1\u0026#34;); // 4 resolve(); }).then(() =\u0026gt; { // å¾®ä»»åŠ¡ console.log(\u0026#34;Promise2\u0026#34;); // 7 }); console.log(\u0026#34;script end\u0026#34;); // 5 //åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯• (call stackè¢«æ¸…ç©º) //æ‰§è¡Œå¾®ä»»åŠ¡ //å°è¯•è¿›è¡ŒDOMæ¸²æŸ“ //è§¦å‘EventLoop æ‰§è¡Œå®ä»»åŠ¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u0026lt;!--ä¼ªä»£ç --\u0026gt;\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34;\u0026gt;click\u0026lt;/button\u0026gt; \u0026lt;script\u0026gt; // const fn1 = () =\u0026gt; { // log(\u0026#34;listener1\u0026#34;) // Promise.resolve().then(()=\u0026gt;log(\u0026#39;micro task 1\u0026#39;)); // } button.addEventListener(\u0026#34;click\u0026#34;, () =\u0026gt; { log(\u0026#34;listener1\u0026#34;); Promise.resolve().then(() =\u0026gt; log(\u0026#34;micro task 1\u0026#34;)); }); // const fn2 = () =\u0026gt; {...} button.addEventListener(\u0026#34;click\u0026#34;, () =\u0026gt; { log(\u0026#34;listener2\u0026#34;); Promise.resolve().then(() =\u0026gt; log(\u0026#34;micro task 2\u0026#34;)); }); //æƒ…å†µä¸€ï¼š button.click() // ç›¸å½“äº åŒæ—¶æ‰§è¡Œfn1() fn2() æ‰§è¡Œç»“æœ: l1 l2 t1 t2 //æƒ…å†µäºŒ: åœ¨htmlé¡µé¢ç‚¹å‡»buttonè§¦å‘ä¸¤æ¬¡clickäº‹ä»¶(ä¸¤ä¸ªå®ä»»åŠ¡) æ‰§è¡Œç»“æœ: l1 t1 l2 t2 \u0026lt;/script\u0026gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 Promise.resolve().then(() =\u0026gt; { console.log(\u0026#34;Promise1\u0026#34;); setTimeout(() =\u0026gt; { console.log(\u0026#34;setTimeout2\u0026#34;); }, 0); }); setTimeout(() =\u0026gt; { console.log(\u0026#34;setTimeout1\u0026#34;); Promise.resolve().then(() =\u0026gt; { console.log(\u0026#34;Promise2\u0026#34;); }); }, 0); // p1 s1 p2 s2 \u0026nbsp;æµè§ˆå™¨ç¼“å­˜:å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ å¼ºç¼“å­˜å¯ä»¥é€šè¿‡è®¾ç½®ä¸¤ç§ HTTP Header å®ç°ï¼šExpires å’Œ Cache-Control ã€‚å¼ºç¼“å­˜è¡¨ç¤ºåœ¨ç¼“å­˜æœŸé—´ä¸éœ€è¦è¯·æ±‚ï¼Œstate code ä¸º 200ã€‚\n\u0026nbsp;åŒæºç­–ç•¥ä¸è·¨åŸŸ ä¸€.æµè§ˆå™¨è¯·æ±‚è·¨åŸŸè§£å†³æ–¹æ¡ˆ CORS ä»£ç†è½¬å‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // webpack-dev-server é…ç½®ä»£ç† //å½“æµè§ˆå™¨å‘èµ·å‰ç¼€ä¸º /api çš„è¯·æ±‚æ—¶éƒ½ä¼šè¢«è½¬å‘åˆ° http://localhost:3000 è¿™ä¸ªç½‘å€ï¼Œç„¶åå°†å“åº”ç»“æœè¿”å›ç»™æµè§ˆå™¨ module.exports = { //... devServer: { proxy: { \u0026#34;/api\u0026#34;: \u0026#34;http://localhost:3000\u0026#34;, }, }, }; //åœ¨ Nginx æœåŠ¡å™¨ä¸Šé…ç½®è½¬å‘è§„åˆ™ //é€šè¿‡ location æŒ‡ä»¤åŒ¹é…è·¯å¾„ï¼Œç„¶åé€šè¿‡ proxy_pass æŒ‡ä»¤æŒ‡å‘ä»£ç†åœ°å€ location /api { proxy_pass http://localhost:3000; } Websocket 1 2 3 4 5 6 7 8 9 //åœ¨aç½‘ç«™ç›´æ¥åˆ›å»ºä¸€ä¸ªWebSocketè¿æ¥ï¼Œè¿æ¥åˆ°bç½‘ç«™ //ç„¶åè°ƒç”¨WebScoketå®ä¾‹wsçš„send()å‡½æ•°å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯ï¼Œç›‘å¬å®ä¾‹wsçš„onmessageäº‹ä»¶å¾—åˆ°å“åº”å†…å®¹ã€‚ var ws = new WebSocket(\u0026#34;ws://b.com\u0026#34;); ws.onopen = function () { // ws.send(...); }; ws.onmessage = function (e) { // console.log(e.data); }; äºŒ. é¡µé¢è·¨åŸŸè§£å†³æ–¹æ¡ˆ ä¾‹å¦‚ä½¿ç”¨ iframe æ—¶çˆ¶å­é¡µé¢ä¹‹é—´è¿›è¡Œé€šä¿¡\nHTML5 çš„ postMessage() å¯ç”¨æ¥å®ç°çˆ¶å­é¡µé¢ä¹‹é—´é€šä¿¡ï¼Œä¸”ä¸è®ºè¿™ä¸¤ä¸ªé¡µé¢æ˜¯å¦åŒæºã€‚\nä¸¾ä¸ª ğŸŒ° å­ï¼š å½“çˆ¶é¡µé¢ https://zzydev.top è¦å‘å­é¡µé¢ https://children.zzydev.top å‘æ¶ˆæ¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // ===================== çˆ¶é¡µé¢ https://zzydev.top ====================================== //é€šè¿‡ window.open() å‡½æ•°æ‰“å¼€äº†å­é¡µé¢ï¼Œ //ç„¶åè°ƒç”¨ child.postMessage() å‡½æ•°å‘é€äº†å­—ç¬¦ä¸²æ•°æ®ç»™å­é¡µé¢ã€‚ var child = window.open(\u0026#34;https://children.zzydev.top\u0026#34;); child.postMessage(\u0026#34;hello kids~\u0026#34;, \u0026#34;https://children.zzydev.top\u0026#34;); // =====================å­é¡µé¢ https://children.zzydev.top ====================================== // åœ¨å­é¡µé¢ä¸­ï¼Œåªéœ€è¦ç›‘å¬â€œmessageâ€äº‹ä»¶å³å¯å¾—åˆ°çˆ¶é¡µé¢çš„æ•°æ® window.addEventListener( \u0026#34;message\u0026#34;, function (e) { console.log(e.data); }, false ); //çˆ¶é¡µé¢ä¹Ÿå¯ä»¥ç›‘å¬â€œmessageâ€äº‹ä»¶æ¥æ¥æ”¶å­é¡µé¢å‘é€çš„æ•°æ®ã€‚ //å­é¡µé¢å‘é€æ•°æ®æ—¶åˆ™è¦é€šè¿‡ window.opener å¯¹è±¡æ¥è°ƒç”¨ postMessage() å‡½æ•°ã€‚ window.opener.postMessage(\u0026#34;hello dad\u0026#34;, \u0026#34;https://zzydev.top\u0026#34;); ","permalink":"https://zzydev.top/posts/eight-part-essay/%E6%88%91%E7%9A%84%E6%8B%B7%E9%9D%A2%E7%BB%8F_1/","summary":"æˆ‘æ˜¯æ²¡äº‹çš„æ—¶å€™ åœ¨æ— èŠçš„æ—¶å€™ï¼Œæƒ³çš„æ—¶å€™ åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œä¸ç›¸åŒçš„åœ°æ–¹ åˆ°è¿™ä¸ªåœ°æ–¹æ¥ï¼Œæ¥åˆ°å§ å¯ä»¥ç§ç§ï¼Œä¸ä¸€æ ·çš„åœ°æ–¹ ä¸ç›¸åŒçš„åœ°æ–¹ å¾ˆå¤šï¼Œå¾ˆå¤šâ€¦â€¦ \u0026mdash;\u0026mdash;\u0026mdash; æ·³Â·ç®€Â·æ‹‰","title":"æˆ‘çš„æ‹·é¢ç»ï¼ˆä¸€ï¼‰"},{"content":" \u0026nbsp;è·å–å‡½æ•°è¿”å›ç±»å‹ ğŸ’¯Take a Challenge\nä¸ä½¿ç”¨ ReturnType å®ç° TypeScript çš„ ReturnType\u0026lt;T\u0026gt; æ³›å‹ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 5 6 const fn = (v: boolean) =\u0026gt; { if (v) return 1; else return 2; }; type a = MyReturnType\u0026lt;typeof fn\u0026gt;; // åº”æ¨å¯¼å‡º \u0026#34;1 | 2\u0026#34; ç­”æ¡ˆ:\n1 type ReturnType\u0026lt;T\u0026gt; = T extends (...args: any) =\u0026gt; infer R ? R : never; \u0026nbsp;å®ç° Omit ğŸ’¯Take a Challenge\nä¸ä½¿ç”¨ Omit å®ç° TypeScript çš„ Omit\u0026lt;T, K\u0026gt; æ³›å‹ã€‚\nOmit ä¼šåˆ›å»ºä¸€ä¸ªçœç•¥ K ä¸­å­—æ®µçš„ T å¯¹è±¡ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 interface Todo { title: string; description: string; completed: boolean; } type TodoPreview = MyOmit\u0026lt;Todo, \u0026#34;description\u0026#34; | \u0026#34;title\u0026#34;\u0026gt;; const todo: TodoPreview = { completed: false, }; ç­”æ¡ˆ:\n1 type MyOmit\u0026lt;T, K\u0026gt; = MyPick\u0026lt;T, MyExclude\u0026lt;keyof T, K\u0026gt;\u0026gt;; \u0026nbsp;Readonly 2 ğŸ’¯Take a Challenge\nImplement a generic MyReadonly2\u0026lt;T, K\u0026gt; which takes two type argument T and K.\nK specify the set of properties of T that should set to Readonly. When K is not provided, it should make all properties readonly just like the normal Readonly\u0026lt;T\u0026gt;.\nFor example\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 interface Todo { title: string; description: string; completed: boolean; } const todo: MyReadonly2\u0026lt;Todo, \u0026#34;title\u0026#34; | \u0026#34;description\u0026#34;\u0026gt; = { title: \u0026#34;Hey\u0026#34;, description: \u0026#34;foobar\u0026#34;, completed: false, }; todo.title = \u0026#34;Hello\u0026#34;; // Error: cannot reassign a readonly property todo.description = \u0026#34;barFoo\u0026#34;; // Error: cannot reassign a readonly property todo.completed = true; // OK ç­”æ¡ˆ:\n1 2 3 type MyReadonly2\u0026lt;T, K extends keyof T = keyof T\u0026gt; = Omit\u0026lt;T, K\u0026gt; \u0026amp; { readonly [P in K]: T[P]; }; \u0026nbsp;æ·±åº¦ Readonly ğŸ’¯Take a Challenge\nImplement a generic DeepReadonly\u0026lt;T\u0026gt; which make every parameter of an object - and its sub-objects recursively - readonly.\nYou can assume that we are only dealing with Objects in this challenge. Arrays, Functions, Classes and so on are no need to take into consideration. However, you can still challenge your self by covering different cases as many as possible.\nFor example\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 type X = { x: { a: 1; b: \u0026#34;hi\u0026#34;; }; y: \u0026#34;hey\u0026#34;; }; type Expected = { readonly x: { readonly a: 1; readonly b: \u0026#34;hi\u0026#34;; }; readonly y: \u0026#34;hey\u0026#34;; }; type Todo = DeepReadonly\u0026lt;X\u0026gt;; // should be same as `Expected` ç­”æ¡ˆ:\n1 2 3 4 5 type DeepReadonly\u0026lt;T\u0026gt; = { readonly [P in keyof T]: T[P] extends { [key: string]: any } ? DeepReadonly\u0026lt;T[P]\u0026gt; : T[P]; }; \u0026nbsp;å…ƒç»„è½¬è”åˆç±»å‹ ğŸ’¯Take a Challenge\nå®ç°æ³›å‹TupleToUnion\u0026lt;T\u0026gt;ï¼Œå®ƒè¿”å›å…ƒç»„æ‰€æœ‰å€¼ç»„æˆçš„è”åˆç±»å‹ã€‚\nä¾‹å¦‚\n1 2 3 type Arr = [\u0026#34;1\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;3\u0026#34;]; type Test = TupleToUnion\u0026lt;Arr\u0026gt;; // expected to be \u0026#39;1\u0026#39; | \u0026#39;2\u0026#39; | \u0026#39;3\u0026#39; ç­”æ¡ˆ:\n1 2 3 type TupleToUnion\u0026lt;T extends readonly any[]\u0026gt; = T extends [infer R, ...infer args] ? R | TupleToUnion\u0026lt;args\u0026gt; : never; \u0026nbsp;Chainable Options ğŸ’¯Take a Challenge\nChainable options are commonly used in Javascript. But when we switch to TypeScript, can you properly type it?\nIn this challenge, you need to type an object or a class - whatever you like - to provide two function option(key, value) and get(). In option, you can extend the current config type by the given key and value. We should about to access the final result via get.\nFor example\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 declare const config: Chainable; const result = config .option(\u0026#34;foo\u0026#34;, 123) .option(\u0026#34;name\u0026#34;, \u0026#34;type-challenges\u0026#34;) .option(\u0026#34;bar\u0026#34;, { value: \u0026#34;Hello World\u0026#34; }) .get(); // expect the type of result to be: interface Result { foo: number; name: string; bar: { value: string; }; } You don\u0026rsquo;t need to write any js/ts logic to handle the problem - just in type level.\nYou can assume that key only accepts string and the value can be anything - just leave it as-is. Same key won\u0026rsquo;t be passed twice. ç­”æ¡ˆ:\n1 2 3 4 5 6 7 type Chainable\u0026lt;T\u0026gt; = { options\u0026lt;K extends string, V\u0026gt;( key: K, value: V ): Chainable\u0026lt;T \u0026amp; { [k in K]: V }\u0026gt;; get(): T; }; \u0026nbsp;Last ğŸ’¯Take a Challenge\nTypeScript 4.0 is recommended in this challenge\nImplement a generic Last\u0026lt;T\u0026gt; that takes an Array T and returns its last element.\nFor example\n1 2 3 4 5 type arr1 = [\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;]; type arr2 = [3, 2, 1]; type tail1 = Last\u0026lt;arr1\u0026gt;; // expected to be \u0026#39;c\u0026#39; type tail2 = Last\u0026lt;arr2\u0026gt;; // expected to be 1 ç­”æ¡ˆ:\n1 type Last\u0026lt;T extends any[]\u0026gt; = T extends [...any[], infer L] ? L : never; \u0026nbsp;Pop ğŸ’¯Take a Challenge\nTypeScript 4.0 is recommended in this challenge\nImplement a generic Pop\u0026lt;T\u0026gt; that takes an Array T and returns an Array without it\u0026rsquo;s last element.\nFor example\n1 2 3 4 5 type arr1 = [\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;, \u0026#34;d\u0026#34;]; type arr2 = [3, 2, 1]; type re1 = Pop\u0026lt;arr1\u0026gt;; // expected to be [\u0026#39;a\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;c\u0026#39;] type re2 = Pop\u0026lt;arr2\u0026gt;; // expected to be [3, 2] Extra: Similarly, can you implement Shift, Push and Unshift as well?\nç­”æ¡ˆ:\n1 2 3 4 5 type Pop\u0026lt;T extends any[]\u0026gt; = T extends [] ? [] : T extends [...infer Rest, any] ? Rest : never; \u0026nbsp;Promise.all ğŸ’¯Take a Challenge Type the function PromiseAll that accepts an array of PromiseLike objects, the returning value should be Promise\u0026lt;T\u0026gt; where T is the resolved result array.\n1 2 3 4 5 6 7 8 const promise1 = Promise.resolve(3); const promise2 = 42; const promise3 = new Promise\u0026lt;string\u0026gt;((resolve, reject) =\u0026gt; { setTimeout(resolve, 100, \u0026#34;foo\u0026#34;); }); // expected to be `Promise\u0026lt;[number, 42, string]\u0026gt;` const p = Promise.all([promise1, promise2, promise3] as const); ç­”æ¡ˆ:\n1 2 3 4 5 6 type PromiseAllType\u0026lt;T\u0026gt; = Promise\u0026lt;{ [P in keyof T]: T[P] extends Promise\u0026lt;infer R\u0026gt; ? R : T[P]; }\u0026gt;; declare function PromiseAll\u0026lt;T extends any[]\u0026gt;( values: readonly [...T] ): PromiseAllType\u0026lt;T\u0026gt;; \u0026nbsp;Type Lookup ğŸ’¯Take a Challenge\nSometimes, you may want to lookup for a type in a union to by their attributes.\nIn this challenge, we would like to get the corresponding type by searching for the common type field in the union Cat | Dog. In other words, we will expect to get Dog for LookUp\u0026lt;Dog | Cat, 'dog'\u0026gt; and Cat for LookUp\u0026lt;Dog | Cat, 'cat'\u0026gt; in the following example.\n1 2 3 4 5 6 7 8 9 10 11 12 interface Cat { type: \u0026#34;cat\u0026#34;; breeds: \u0026#34;Abyssinian\u0026#34; | \u0026#34;Shorthair\u0026#34; | \u0026#34;Curl\u0026#34; | \u0026#34;Bengal\u0026#34;; } interface Dog { type: \u0026#34;dog\u0026#34;; breeds: \u0026#34;Hound\u0026#34; | \u0026#34;Brittany\u0026#34; | \u0026#34;Bulldog\u0026#34; | \u0026#34;Boxer\u0026#34;; color: \u0026#34;brown\u0026#34; | \u0026#34;white\u0026#34; | \u0026#34;black\u0026#34;; } type MyDogType = LookUp\u0026lt;Cat | Dog, \u0026#34;dog\u0026#34;\u0026gt;; // expected to be `Dog` ç­”æ¡ˆ:\n1 2 3 4 5 type LookUp\u0026lt;U extends { type: string }, T extends string\u0026gt; = U extends { type: T; } ? U : never; \u0026nbsp;Trim Left ğŸ’¯Take a Challenge Implement TrimLeft\u0026lt;T\u0026gt; which takes an exact string type and returns a new string with the whitespace beginning removed.\nFor example\n1 type trimed = TrimLeft\u0026lt;\u0026#34; Hello World \u0026#34;\u0026gt;; // expected to be \u0026#39;Hello World \u0026#39; ç­”æ¡ˆ:\n1 2 3 4 5 6 type TrimLeft\u0026lt;Str extends string\u0026gt; = Str extends `${ | \u0026#34; \u0026#34; | \u0026#34;\\n\u0026#34; | \u0026#34;\\t\u0026#34;}${infer Rest}` ? TrimLeft\u0026lt;Rest\u0026gt; : Str; \u0026nbsp;Trim ğŸ’¯Take a Challenge\nImplement Trim\u0026lt;T\u0026gt; which takes an exact string type and returns a new string with the whitespace from both ends removed.\nFor example\n1 type trimmed = Trim\u0026lt;\u0026#34; Hello World \u0026#34;\u0026gt;; // expected to be \u0026#39;Hello World\u0026#39; ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 type TrimStrRight\u0026lt;Str extends string\u0026gt; = Str extends `${infer Rest}${ | \u0026#34; \u0026#34; | \u0026#34;\\n\u0026#34; | \u0026#34;\\t\u0026#34;}` ? TrimStrRight\u0026lt;Rest\u0026gt; : Str; type TrimStrLeft\u0026lt;Str extends string\u0026gt; = Str extends `${ | \u0026#34; \u0026#34; | \u0026#34;\\n\u0026#34; | \u0026#34;\\t\u0026#34;}${infer Rest}` ? TrimStrLeft\u0026lt;Rest\u0026gt; : Str; type Trim\u0026lt;Str extends string\u0026gt; = TrimStrRight\u0026lt;TrimStrLeft\u0026lt;Str\u0026gt;\u0026gt;; \u0026nbsp;Capitalize ğŸ’¯Take a Challenge\nImplement Capitalize\u0026lt;T\u0026gt; which converts the first letter of a string to uppercase and leave the rest as-is.\nFor example\n1 type capitalized = Capitalize\u0026lt;\u0026#34;hello world\u0026#34;\u0026gt;; // expected to be \u0026#39;Hello world\u0026#39; ç­”æ¡ˆ:\n1 2 3 4 type MyCapitalize\u0026lt;Str extends string\u0026gt; = Str extends `${infer First}${infer Rest}` ? `${Uppercase\u0026lt;First\u0026gt;}${Rest}` : Str; \u0026nbsp;Replace ğŸ’¯Take a Challenge\nImplement Replace\u0026lt;S, From, To\u0026gt; which replace the string From with To once in the given string S\nFor example\n1 type replaced = Replace\u0026lt;\u0026#34;types are fun!\u0026#34;, \u0026#34;fun\u0026#34;, \u0026#34;awesome\u0026#34;\u0026gt;; // expected to be \u0026#39;types are awesome!\u0026#39; ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 type Replace\u0026lt; S extends string, From extends string, To extends string \u0026gt; = S extends `${infer L}${From}${infer R}` ? From extends \u0026#34;\u0026#34; ? S : `${L}${To}${R}` : S; \u0026nbsp;ReplaceAll ğŸ’¯Take a Challenge\nç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 type ReplaceAll\u0026lt; Str extends string, From extends string, To extends string \u0026gt; = Str extends `${infer Left}${From}${infer Right}` ? From extends \u0026#34;\u0026#34; ? Str : `${Left}${To}${ReplaceAll\u0026lt;Right, From, To\u0026gt;}` : Str; \u0026nbsp;Append Argument ğŸ’¯Take a Challenge\nFor given function type Fn, and any type A (any in this context means we don\u0026rsquo;t restrict the type, and I don\u0026rsquo;t have in mind any type ğŸ˜‰) create a generic type which will take Fn as the first argument, A as the second, and will produce function type G which will be the same as Fn but with appended argument A as a last one.\nFor example,\n1 2 3 4 type Fn = (a: number, b: string) =\u0026gt; number; type Result = AppendArgument\u0026lt;Fn, boolean\u0026gt;; // expected be (a: number, b: string, x: boolean) =\u0026gt; number This question is ported from the original article by @maciejsikora ç­”æ¡ˆ:\n1 2 3 type AppendArgument\u0026lt;Fn, A\u0026gt; = Fn extends (...args: infer R) =\u0026gt; infer T ? (...args: [...R, A]) =\u0026gt; T : never; \u0026nbsp;Permutation ğŸ’¯Take a Challenge\nImplement permutation type that transforms union types into the array that includes permutations of unions.\n1 type perm = Permutation\u0026lt;\u0026#34;A\u0026#34; | \u0026#34;B\u0026#34; | \u0026#34;C\u0026#34;\u0026gt;; // [\u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;, \u0026#39;C\u0026#39;] | [\u0026#39;A\u0026#39;, \u0026#39;C\u0026#39;, \u0026#39;B\u0026#39;] | [\u0026#39;B\u0026#39;, \u0026#39;A\u0026#39;, \u0026#39;C\u0026#39;] | [\u0026#39;B\u0026#39;, \u0026#39;C\u0026#39;, \u0026#39;A\u0026#39;] | [\u0026#39;C\u0026#39;, \u0026#39;A\u0026#39;, \u0026#39;B\u0026#39;] | [\u0026#39;C\u0026#39;, \u0026#39;B\u0026#39;, \u0026#39;A\u0026#39;] ç­”æ¡ˆ:\n1 2 3 4 5 type Permutation\u0026lt;T, U = T\u0026gt; = [T] extends [never] ? [] : T extends T ? [T, ...Permutation\u0026lt;Exclude\u0026lt;U, T\u0026gt;\u0026gt;] : never; [T] extends [never]æ˜¯åŒ…è£¹ç±»å‹æ¡ä»¶åˆ¤æ–­ï¼Œè¿™é‡Œç”¨äºå¤„ç†è”åˆç±»å‹ä¸ºç©ºçš„æƒ…å†µã€‚\nT extends T ç”¨äºè§¦å‘åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ã€‚\n\u0026lt;Exclude\u0026lt;U, T\u0026gt;æ’é™¤ T ç±»å‹ï¼Œç”±äº T æ­¤æ—¶è§¦å‘äº†åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹çš„ç‰¹æ€§ï¼Œæ˜¯å•ç‹¬çš„ T ç±»å‹è€Œä¸æ˜¯ Union ç±»å‹ã€‚\nğŸŒ° ä¸¾ä¸ªæ —å­ï¼Œåˆ†æä¸€ä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š\ntype res = Permutation\u0026lt;\u0026quot;A\u0026quot; | \u0026quot;B\u0026quot; | \u0026quot;C\u0026quot;\u0026gt; å½“ åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ T ä¸º A æ—¶ï¼Œé€’å½’è°ƒç”¨ Permutation\u0026lt;\u0026quot;B\u0026quot; | \u0026quot;C\u0026quot;\u0026gt;ï¼Œæ­¤æ—¶ç»“æœä¸º [\u0026quot;A\u0026quot;,...[\u0026quot;B\u0026quot;,Permutation\u0026lt;\u0026quot;C\u0026quot;\u0026gt;]]]ä¸[\u0026quot;A\u0026quot;,...[\u0026quot;C\u0026quot;, Permutation\u0026lt;\u0026quot;B\u0026quot;\u0026gt;]]]ã€‚æœ€ç»ˆå¾—åˆ°[\u0026quot;A\u0026quot;,\u0026quot;B\u0026quot;,\u0026quot;C\u0026quot;]ä¸[\u0026quot;A\u0026quot;,\u0026quot;C\u0026quot;,\u0026quot;B\u0026quot;]ã€‚\n\u0026nbsp;Length of String ğŸ’¯Take a Challenge\nCompute the length of a string literal, which behaves like String#length. ç­”æ¡ˆ:\n1 2 3 4 5 6 type LengthOfString\u0026lt; S extends string, CountArr extends unknown[] = [] \u0026gt; = S extends `${string}${infer Rest}` ? LengthOfString\u0026lt;Rest, [...CountArr, unknown]\u0026gt; : CountArr[\u0026#34;length\u0026#34;]; \u0026nbsp;Flatten ğŸ’¯Take a Challenge\nIn this challenge, you would need to write a type that takes an array and emitted the flatten array type.\nFor example:\n1 type flatten = Flatten\u0026lt;[1, 2, [3, 4], [[[5]]]]\u0026gt;; // [1, 2, 3, 4, 5] ç­”æ¡ˆ:\n1 2 3 4 5 type Flatten\u0026lt;T extends any[]\u0026gt; = T extends [infer L, ...infer R] ? L extends any[] ? [...Flatten\u0026lt;L\u0026gt;, ...Flatten\u0026lt;R\u0026gt;] : [L, ...Flatten\u0026lt;R\u0026gt;] : []; \u0026nbsp;Append to object ğŸ’¯Take a Challenge\nImplement a type that adds a new field to the interface. The type takes the three arguments. The output should be an object with the new field.\nFor example\n1 2 type Test = { id: \u0026#34;1\u0026#34; }; type Result = AppendToObject\u0026lt;Test, \u0026#34;value\u0026#34;, 4\u0026gt;; // expected to be { id: \u0026#39;1\u0026#39;, value: 4 } ç­”æ¡ˆ:\n1 2 3 type AppendToObject\u0026lt;T, K extends keyof any, V\u0026gt; = { [P in keyof T | K]: P extends keyof T ? T[P] : V; }; \u0026nbsp;Absolute ğŸ’¯Take a Challenge\nImplement the Absolute type. A type that take string, number or bigint. The output should be a positive number string\nFor example\n1 2 type Test = -100; type Result = Absolute\u0026lt;Test\u0026gt;; // expected to be \u0026#34;100\u0026#34; ç­”æ¡ˆ:\n1 2 3 type Absolute\u0026lt;T extends number | string | bigint\u0026gt; = `${T}` extends `-${infer N}` ? N : `${T}`; \u0026nbsp;String to Union ğŸ’¯Take a Challenge\nImplement the String to Union type. Type take string argument. The output should be a union of input letters\nFor exampleï¼š\n1 2 type Test = \u0026#34;123\u0026#34;; type Result = StringToUnion\u0026lt;Test\u0026gt;; // expected to be \u0026#34;1\u0026#34; | \u0026#34;2\u0026#34; | \u0026#34;3\u0026#34; ç­”æ¡ˆ:\n1 2 3 type StringToUnion\u0026lt;S extends string\u0026gt; = S extends `${infer L}${infer R}` ? L | StringToUnion\u0026lt;R\u0026gt; : never; \u0026nbsp;Merge ğŸ’¯Take a Challenge\nMerge two types into a new type. Keys of the second type overrides keys of the first type.\nFor exampleï¼š\n1 2 3 4 5 6 7 8 9 10 type foo = { name: string; age: string; }; type coo = { age: number; sex: string; }; type Result = Merge\u0026lt;foo, coo\u0026gt;; // expected to be {name: string, age: number, sex: string} ç­”æ¡ˆ: åé¢çš„å±æ€§çš„å€¼ä¼šè¦†ç›–å‰é¢ç›¸åŒå±æ€§çš„å€¼\n1 2 3 4 5 6 7 type Merge\u0026lt;F, S\u0026gt; = { [P in keyof F | keyof S]: P extends keyof S ? S[P] : P extends keyof F ? F[P] : never; }; \u0026nbsp;KebabCase ğŸ’¯Take a Challenge\nFooBarBaz -\u0026gt; foo-bar-baz ç­”æ¡ˆ:\n1 2 3 4 5 type KebabCase\u0026lt;S extends string\u0026gt; = S extends `${infer S1}${infer S2}` ? S2 extends Uncapitalize\u0026lt;S2\u0026gt; ? `${Uncapitalize\u0026lt;S1\u0026gt;}${KebabCase\u0026lt;S2\u0026gt;}` : `${Uncapitalize\u0026lt;S1\u0026gt;}-${KebabCase\u0026lt;S2\u0026gt;}` : S; \u0026nbsp;Diff ğŸ’¯Take a Challenge\nGet an Object that is the difference between O \u0026amp; O1 ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 type DiffKeys\u0026lt;T, U\u0026gt; = Exclude\u0026lt;keyof T | keyof U, keyof (T | U)\u0026gt;; type Diff\u0026lt;O, O1\u0026gt; = { [K in DiffKeys\u0026lt;O, O1\u0026gt;]: K extends keyof O ? O[K] : K extends keyof O1 ? O1[K] : never; }; keyof T| keyof U è¡¨ç¤º T å’Œ U çš„æ‰€æœ‰å±æ€§ç»„æˆçš„è”åˆç±»å‹\nkeyof (T | U) è¡¨ç¤º T å’Œ U çš„å…¬å…±å±æ€§\n\u0026nbsp;AnyOf ğŸ’¯Take a Challenge\nImplement Python liked any function in the type system. A type takes the Array and returns true if any element of the Array is true. If the Array is empty, return false.\nFor example:\n1 2 type Sample1 = AnyOf\u0026lt;[1, \u0026#34;\u0026#34;, false, [], {}]\u0026gt;; // expected to be true. type Sample2 = AnyOf\u0026lt;[0, \u0026#34;\u0026#34;, false, [], {}]\u0026gt;; // expected to be false. ç­”æ¡ˆ:\n1 2 type False = 0 | \u0026#34;\u0026#34; | false | [] | { [key: string]: never }; type AnyOf\u0026lt;T extends readonly any[]\u0026gt; = T[number] extends False ? false : true; \u0026nbsp;IsNever ğŸ’¯Take a Challenge\nImplement a type IsNever, which takes input type T. If the type of resolves to never, return true, otherwise false.\nFor example:\n1 2 3 4 5 type A = IsNever\u0026lt;never\u0026gt;; // expected to be true type B = IsNever\u0026lt;undefined\u0026gt;; // expected to be false type C = IsNever\u0026lt;null\u0026gt;; // expected to be false type D = IsNever\u0026lt;[]\u0026gt;; // expected to be false type E = IsNever\u0026lt;number\u0026gt;; // expected to be false ç­”æ¡ˆ:\n1 2 3 4 // never type TestNever\u0026lt;T\u0026gt; = T extends never ? 1 : 2; //åŒ…è£¹ç±»å‹ type IsNever\u0026lt;T\u0026gt; = [T] extends [never] ? true : false; \u0026nbsp;IsUnion ğŸ’¯Take a Challenge\nImplement a type IsUnion, which takes an input type T and returns whether T resolves to a union type.\nFor example:\n```ts type case1 = IsUnion\u0026lt;string\u0026gt; // false type case2 = IsUnion\u0026lt;string|number\u0026gt; // true type case3 = IsUnion\u0026lt;[string|number]\u0026gt; // false ``` ç­”æ¡ˆ:\n1 2 3 4 5 6 7 type IsUnion\u0026lt;T, U = T\u0026gt; = [T] extends [never] ? false : T extends T //è§¦å‘åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼Œè®©æ¯ä¸ªç±»å‹å•ç‹¬ä¼ å…¥å¤„ç†çš„ ? [U] extends [T] // åœ¨è¿™é‡Œ,Uæ˜¯è”åˆç±»å‹,Tæ˜¯å•ç‹¬çš„ç±»å‹ï¼Œæ‰€ä»¥ä½¿ç”¨[B] extends [A]æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯è”åˆç±»å‹ ? false : true : never; \u0026nbsp;ReplaceKeys ğŸ’¯Take a Challenge\nImplement a type ReplaceKeys, that replace keys in union types, if some type has not this key, just skip replacing, A type takes three arguments.\nFor example:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 type NodeA = { type: \u0026#34;A\u0026#34;; name: string; flag: number; }; type NodeB = { type: \u0026#34;B\u0026#34;; id: number; flag: number; }; type NodeC = { type: \u0026#34;C\u0026#34;; name: string; flag: number; }; type Nodes = NodeA | NodeB | NodeC; type ReplacedNodes = ReplaceKeys\u0026lt; Nodes, \u0026#34;name\u0026#34; | \u0026#34;flag\u0026#34;, { name: number; flag: string } \u0026gt;; // {type: \u0026#39;A\u0026#39;, name: number, flag: string} | {type: \u0026#39;B\u0026#39;, id: number, flag: string} | {type: \u0026#39;C\u0026#39;, name: number, flag: string} // would replace name from string to number, replace flag from number to string. type ReplacedNotExistKeys = ReplaceKeys\u0026lt;Nodes, \u0026#34;name\u0026#34;, { aa: number }\u0026gt;; // {type: \u0026#39;A\u0026#39;, name: never, flag: number} | NodeB | {type: \u0026#39;C\u0026#39;, name: never, flag: number} // would replace name to never ç­”æ¡ˆ:\n1 2 3 type ReplaceKeys\u0026lt;U, T, Y\u0026gt; = { [P in keyof U]: P extends T ? (P extends keyof Y ? Y[P] : never) : U[P]; }; \u0026nbsp;Remove Index Signature ğŸ’¯Take a Challenge\nImplement RemoveIndexSignature\u0026lt;T\u0026gt; , exclude the index signature from object types.\nFor example:\ntype Foo = { [key: string]: any; foo(): void; } type A = RemoveIndexSignature\u0026lt;Foo\u0026gt; // expected { foo(): void } ç­”æ¡ˆ:\n1 2 3 4 type NeverIndex\u0026lt;P\u0026gt; = string extends P ? never : number extends P ? never : P; type RemoveIndexSignature\u0026lt;T\u0026gt; = { [P in keyof T as NeverIndex\u0026lt;P\u0026gt;]: T[P]; }; ç´¢å¼•ç­¾åçš„é”®ä¸ºstringæˆ–è€…numberï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡ string extends P å’Œ number extends P çš„å½¢å¼æ’é™¤æ­¤ç´¢å¼•ç­¾åã€‚\n\u0026nbsp;Percentage Parser ğŸ’¯Take a Challenge\nImplement PercentageParser. According to the /^(\\+|\\-)?(\\d*)?(\\%)?$/ regularity to match T and get three matches.\nThe structure should be: [plus or minus, number, unit] If it is not captured, the default is an empty string.\nFor example:\n1 2 3 4 5 6 7 8 9 10 11 type PString1 = \u0026#34;\u0026#34;; type PString2 = \u0026#34;+85%\u0026#34;; type PString3 = \u0026#34;-85%\u0026#34;; type PString4 = \u0026#34;85%\u0026#34;; type PString5 = \u0026#34;85\u0026#34;; type R1 = PercentageParser\u0026lt;PString1\u0026gt;; // expected [\u0026#39;\u0026#39;, \u0026#39;\u0026#39;, \u0026#39;\u0026#39;] type R2 = PercentageParser\u0026lt;PString2\u0026gt;; // expected [\u0026#34;+\u0026#34;, \u0026#34;85\u0026#34;, \u0026#34;%\u0026#34;] type R3 = PercentageParser\u0026lt;PString3\u0026gt;; // expected [\u0026#34;-\u0026#34;, \u0026#34;85\u0026#34;, \u0026#34;%\u0026#34;] type R4 = PercentageParser\u0026lt;PString4\u0026gt;; // expected [\u0026#34;\u0026#34;, \u0026#34;85\u0026#34;, \u0026#34;%\u0026#34;] type R5 = PercentageParser\u0026lt;PString5\u0026gt;; // expected [\u0026#34;\u0026#34;, \u0026#34;85\u0026#34;, \u0026#34;\u0026#34;] ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 12 13 // your answers type PercentageParser\u0026lt; A extends string, P = \u0026#34;\u0026#34;, N extends string = \u0026#34;\u0026#34;, S = \u0026#34;\u0026#34; \u0026gt; = A extends `${infer First}${infer Rest}` ? First extends \u0026#34;-\u0026#34; | \u0026#34;+\u0026#34; ? PercentageParser\u0026lt;Rest, First, N, S\u0026gt; : First extends \u0026#34;%\u0026#34; ? PercentageParser\u0026lt;Rest, P, N, First\u0026gt; : PercentageParser\u0026lt;Rest, P, `${N}${First}`, S\u0026gt; : [P, N, S]; \u0026nbsp;Drop Char ğŸ’¯Take a Challenge\nDrop a specified char from a string.\nFor example:\n1 type Butterfly = DropChar\u0026lt;\u0026#34; b u t t e r f l y ! \u0026#34;, \u0026#34; \u0026#34;\u0026gt;; // \u0026#39;butterfly!\u0026#39; ç­”æ¡ˆ:\n1 2 3 4 5 6 type DropChar\u0026lt; S extends string, C extends string \u0026gt; = S extends `${infer Prefix}${C}${infer Suffix}` ? DropChar\u0026lt;`${Prefix}${Suffix}`, C\u0026gt; : S; \u0026nbsp;MinusOne ğŸ’¯Take a Challenge\nGiven a number (always positive) as a type. Your type should return the number decreased by one.\nFor example:\n1 2 type Zero = MinusOne\u0026lt;1\u0026gt;; // 0 type FiftyFour = MinusOne\u0026lt;55\u0026gt;; // 54 ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 //å­˜åœ¨æœ€å¤§é€’å½’è°ƒç”¨æ·±åº¦ï¼Œæ¯”è¾ƒå¤§çš„æ•°å­—ä¼šå‡ºé”™ï¼Œè¿™ä¸ªæ–¹æ³•è¿‡ä¸äº†é¢˜ç›®ä¸­Expect\u0026lt;Equal\u0026lt;MinusOne\u0026lt;1101\u0026gt;, 1100\u0026gt;\u0026gt;è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚ type BuildArr\u0026lt; Length extends number, Elem = unknown, Arr extends unknown[] = [] \u0026gt; = Arr[\u0026#34;length\u0026#34;] extends Length ? Arr : BuildArr\u0026lt;Length, Elem, [...Arr, Elem]\u0026gt;; type Subtract\u0026lt; Num1 extends number, Num2 extends number \u0026gt; = BuildArray\u0026lt;Num1\u0026gt; extends [...arr1: BuildArr\u0026lt;Num2\u0026gt;, ...arr2: infer Rest] ? Rest[\u0026#34;length\u0026#34;] : never; \u0026nbsp;PickByType ğŸ’¯Take a Challenge\nFrom T, pick a set of properties whose type are assignable to U.\nFor Example\n1 2 3 4 5 6 7 8 9 type OnlyBoolean = PickByType\u0026lt; { name: string; count: number; isReadonly: boolean; isEnable: boolean; }, boolean \u0026gt;; // { isReadonly: boolean; isEnable: boolean; } ç­”æ¡ˆ:\n1 2 3 type PickByType\u0026lt;T, U\u0026gt; = { [P in keyof T as T[P] extends U ? P : never]: T[P]; }; \u0026nbsp;StartsWith ğŸ’¯Take a Challenge Implement StartsWith\u0026lt;T, U\u0026gt; which takes two exact string types and returns whether T starts with U\nFor example\n1 2 3 type a = StartsWith\u0026lt;\u0026#34;abc\u0026#34;, \u0026#34;ac\u0026#34;\u0026gt;; // expected to be false type b = StartsWith\u0026lt;\u0026#34;abc\u0026#34;, \u0026#34;ab\u0026#34;\u0026gt;; // expected to be true type c = StartsWith\u0026lt;\u0026#34;abc\u0026#34;, \u0026#34;abcd\u0026#34;\u0026gt;; // expected to be false ç­”æ¡ˆ:\n1 2 3 type StartsWith\u0026lt;S extends string, C extends string\u0026gt; = S extends `${C}${string}` ? true : false; \u0026nbsp;EndsWith ğŸ’¯Take a Challenge\nImplement EndsWith\u0026lt;T, U\u0026gt; which takes two exact string types and returns whether T ends with U\nFor example:\n1 2 3 type a = EndsWith\u0026lt;\u0026#34;abc\u0026#34;, \u0026#34;bc\u0026#34;\u0026gt;; // expected to be false type b = EndsWith\u0026lt;\u0026#34;abc\u0026#34;, \u0026#34;abc\u0026#34;\u0026gt;; // expected to be true type c = EndsWith\u0026lt;\u0026#34;abc\u0026#34;, \u0026#34;d\u0026#34;\u0026gt;; // expected to be false ç­”æ¡ˆ:\n1 2 3 type EndsWith\u0026lt;S extends string, C extends string\u0026gt; = S extends `${string}${C}` ? true : false; \u0026nbsp;PartialByKeys ğŸ’¯Take a Challenge\nImplement a generic PartialByKeys\u0026lt;T, K\u0026gt; which takes two type argument T and K.\nK specify the set of properties of T that should set to be optional. When K is not provided, it should make all properties optional just like the normal Partial\u0026lt;T\u0026gt;.\nFor example\n1 2 3 4 5 6 7 interface User { name: string; age: number; address: string; } type UserPartialName = PartialByKeys\u0026lt;User, \u0026#34;name\u0026#34;\u0026gt;; // { name?:string; age:number; address:string } ç­”æ¡ˆ:\n1 2 3 4 5 6 type CopyKeys\u0026lt;T\u0026gt; = { [P in keyof T]: T[P]; }; type PartialByKeys\u0026lt;T, K extends keyof any = keyof T\u0026gt; = CopyKeys\u0026lt; Partial\u0026lt;Pick\u0026lt;T, Extract\u0026lt;keyof T, K\u0026gt;\u0026gt;\u0026gt; \u0026amp; Omit\u0026lt;T, K\u0026gt; \u0026gt;; \u0026nbsp;RequiredByKeys ğŸ’¯Take a Challenge\nImplement a generic RequiredByKeys\u0026lt;T, K\u0026gt; which takes two type argument T and K.\nK specify the set of properties of T that should set to be required. When K is not provided, it should make all properties required just like the normal Required\u0026lt;T\u0026gt;.\nFor example\n1 2 3 4 5 6 7 interface User { name?: string; age?: number; address?: string; } type UserRequiredName = RequiredByKeys\u0026lt;User, \u0026#34;name\u0026#34;\u0026gt;; // { name: string; age?: number; address?: string } ç­”æ¡ˆ:\n1 2 3 4 5 6 type CopyKeys\u0026lt;T\u0026gt; = { [P in keyof T]: T[P]; }; type RequiredByKeys\u0026lt;T, K extends keyof any = keyof T\u0026gt; = CopyKeys\u0026lt; Required\u0026lt;Pick\u0026lt;T, Extract\u0026lt;keyof T, K\u0026gt;\u0026gt;\u0026gt; \u0026amp; Omit\u0026lt;T, K\u0026gt; \u0026gt;; \u0026nbsp;Mutable ğŸ’¯Take a Challenge\nImplement the generic Mutable\u0026lt;T\u0026gt; which makes all properties in T mutable (not readonly).\nFor example\n1 2 3 4 5 6 7 interface Todo { readonly title: string; readonly description: string; readonly completed: boolean; } type MutableTodo = Mutable\u0026lt;Todo\u0026gt;; // { title: string; description: string; completed: boolean; } ç­”æ¡ˆ:\n1 2 3 type MyMutable\u0026lt;T\u0026gt; = { -readonly [P in keyof T]: T[P]; }; \u0026nbsp;OmitByType ğŸ’¯Take a Challenge\nFrom T, pick a set of properties whose type are not assignable to U.\nFor Example\n1 2 3 4 5 6 7 8 9 type OmitBoolean = OmitByType\u0026lt; { name: string; count: number; isReadonly: boolean; isEnable: boolean; }, boolean \u0026gt;; // { name: string; count: number } ç­”æ¡ˆ:\n1 2 3 type OmitByType\u0026lt;T, U\u0026gt; = { [P in keyof T as U extends T[P] ? never : P]: T[P]; }; \u0026nbsp;ObjectEntries ğŸ’¯Take a Challenge\nImplement the type version of Object.entries\nFor example\n1 2 3 4 5 6 interface Model { name: string; age: number; locations: string[] | null; } type modelEntries = ObjectEntries\u0026lt;Model\u0026gt;; // [\u0026#39;name\u0026#39;, string] | [\u0026#39;age\u0026#39;, number] | [\u0026#39;locations\u0026#39;, string[] | null]; ç­”æ¡ˆ:\n1 2 3 type ObjectEntries\u0026lt;T\u0026gt; = { [K in keyof Required\u0026lt;T\u0026gt;]: [K, T[K] extends undefined ? T[K] : Required\u0026lt;T\u0026gt;[K]]; }[keyof T]; \u0026nbsp;Shift ğŸ’¯Take a Challenge\nImplement the type version of Array.shift\nFor example\n1 type Result = Shift\u0026lt;[3, 2, 1]\u0026gt;; // [2, 1] ç­”æ¡ˆ:\n1 2 3 4 5 type Shift\u0026lt;T extends unknown[]\u0026gt; = T extends [] ? [] : T extends [unknown, ...infer Rest] ? Rest : never; \u0026nbsp;Tuple to Nested Object ğŸ’¯Take a Challenge\nGiven a tuple type T that only contains string type, and a type U, build an object recursively.\n1 2 3 type a = TupleToNestedObject\u0026lt;[\u0026#34;a\u0026#34;], string\u0026gt;; // {a: string} type b = TupleToNestedObject\u0026lt;[\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;], number\u0026gt;; // {a: {b: number}} type c = TupleToNestedObject\u0026lt;[], boolean\u0026gt;; // boolean. if the tuple is empty, just return the U type ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 type TupleToNestedObject\u0026lt;T extends any[], U\u0026gt; = T extends [ infer F, ...infer Rest ] ? F extends string ? { [P in F]: TupleToNestedObject\u0026lt;Rest, U\u0026gt; } : never : U; \u0026nbsp;Reverse ğŸ’¯Take a Challenge\nImplement the type version of Array.reverse\nFor example:\n1 2 type a = Reverse\u0026lt;[\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;]\u0026gt;; // [\u0026#39;b\u0026#39;, \u0026#39;a\u0026#39;] type b = Reverse\u0026lt;[\u0026#34;a\u0026#34;, \u0026#34;b\u0026#34;, \u0026#34;c\u0026#34;]\u0026gt;; // [\u0026#39;c\u0026#39;, \u0026#39;b\u0026#39;, \u0026#39;a\u0026#39;] ç­”æ¡ˆ:\n1 2 3 type Reverse\u0026lt;T extends any[]\u0026gt; = T extends [...infer R, infer L] ? [L, ...Reverse\u0026lt;R\u0026gt;] : []; \u0026nbsp;Flip Arguments ğŸ’¯Take a Challenge\nImplement the type version of lodash\u0026rsquo;s _.flip.\nType FlipArguments\u0026lt;T\u0026gt; requires function type T and returns a new function type which has the same return type of T but reversed parameters.\nFor example:\n1 2 3 4 type Flipped = FlipArguments\u0026lt; (arg0: string, arg1: number, arg2: boolean) =\u0026gt; void \u0026gt;; // (arg0: boolean, arg1: number, arg2: string) =\u0026gt; void ç­”æ¡ˆ:\n1 2 3 type FlipArguments\u0026lt;T\u0026gt; = T extends (...args: infer A) =\u0026gt; infer R ? (...args: Reverse\u0026lt;A\u0026gt;) =\u0026gt; R : never; \u0026nbsp;FlattenDepth ğŸ’¯Take a Challenge\nRecursively flatten array up to depth times.\nFor example:\n1 2 type a = FlattenDepth\u0026lt;[1, 2, [3, 4], [[[5]]]], 2\u0026gt;; // [1, 2, 3, 4, [5]]. flattern 2 times type b = FlattenDepth\u0026lt;[1, 2, [3, 4], [[[5]]]]\u0026gt;; // [1, 2, 3, 4, [[5]]]. Depth defaults to be 1 If the depth is provided, it\u0026rsquo;s guaranteed to be positive integer. ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 type FlattenDepth\u0026lt; T extends any[], D extends number = 1, U extends any[] = [] \u0026gt; = T extends [infer F, ...infer R] ? U[\u0026#34;length\u0026#34;] extends D ? T : F extends any[] ? [...FlattenDepth\u0026lt;F, D, [0, ...U]\u0026gt;, ...FlattenDepth\u0026lt;R, D\u0026gt;] : [F, ...FlattenDepth\u0026lt;R, D, U\u0026gt;] : T; \u0026nbsp;BEM style string ğŸ’¯Take a Challenge\nThe Block, Element, Modifier methodology (BEM) is a popular naming convention for classes in CSS.\nFor example, the block component would be represented as btn, element that depends upon the block would be represented as btn__price, modifier that changes the style of the block would be represented as btn--big or btn__price--warning.\nImplement BEM\u0026lt;B, E, M\u0026gt; which generate string union from these three parameters. Where B is a string literal, E and M are string arrays (can be empty). ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 type Preprocess\u0026lt;T extends any[], P extends string\u0026gt; = T extends [] ? \u0026#34;\u0026#34; : `${P}${T[number]}`; type BEM\u0026lt; B extends string, E extends string[], M extends string[] \u0026gt; = `${B}${Preprocess\u0026lt;E, \u0026#34;__\u0026#34;\u0026gt;}${Preprocess\u0026lt;M, \u0026#34;--\u0026#34;\u0026gt;}`; \u0026nbsp;InorderTraversal ğŸ’¯Take a Challenge\nImplement the type version of binary tree inorder traversal.\nFor example:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 const tree1 = { val: 1, left: null, right: { val: 2, left: { val: 3, left: null, right: null, }, right: null, }, } as const; type A = InorderTraversal\u0026lt;typeof tree1\u0026gt;; // [1, 3, 2] ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 12 interface TreeNode { val: number; left: TreeNode | null; right: TreeNode | null; } type InorderTraversal\u0026lt; T extends TreeNode | null, U extends TreeNode = NonNullable\u0026lt;T\u0026gt; \u0026gt; = T extends TreeNode ? [...InorderTraversal\u0026lt;U[\u0026#34;left\u0026#34;]\u0026gt;, U[\u0026#34;val\u0026#34;], ...InorderTraversal\u0026lt;U[\u0026#34;right\u0026#34;]\u0026gt;] : []; \u0026nbsp;Flip ğŸ’¯Take a Challenge\nImplement the type of just-flip-object. Examples:\n1 2 3 Flip\u0026lt;{ a: \u0026#34;x\u0026#34;, b: \u0026#34;y\u0026#34;, c: \u0026#34;z\u0026#34; }\u0026gt;; // {x: \u0026#39;a\u0026#39;, y: \u0026#39;b\u0026#39;, z: \u0026#39;c\u0026#39;} Flip\u0026lt;{ a: 1, b: 2, c: 3 }\u0026gt;; // {1: \u0026#39;a\u0026#39;, 2: \u0026#39;b\u0026#39;, 3: \u0026#39;c\u0026#39;} Flip\u0026lt;{ a: false, b: true }\u0026gt;; // {false: \u0026#39;a\u0026#39;, true: \u0026#39;b\u0026#39;} No need to support nested objects and values which cannot be object keys such as arrays ç­”æ¡ˆ:\n1 2 3 type Flip\u0026lt;T extends Record\u0026lt;string, boolean | number | string\u0026gt;\u0026gt; = { [P in keyof T as `${T[P]}`]: P; }; \u0026nbsp;Fibonacci Sequence ğŸ’¯Take a Challenge\nImplement a generic Fibonacci\u0026lt;T\u0026gt; takes an number T and returns it\u0026rsquo;s corresponding Fibonacci number.\nThe sequence starts: 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, \u0026hellip;\nFor example\n1 2 type Result1 = Fibonacci\u0026lt;3\u0026gt;; // 2 type Result2 = Fibonacci\u0026lt;8\u0026gt;; // 21 ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 12 13 type Fibonacci\u0026lt; Num extends number, PrevArr extends unknown[] = [1], CurrentArr extends unknown[] = [], IndexArr extends unknown[] = [] \u0026gt; = IndexArr[\u0026#34;length\u0026#34;] extends Num ? CurrentArr[\u0026#34;length\u0026#34;] : Fibonacci\u0026lt; Num, CurrentArr, [...PrevArr, ...CurrentArr], [...IndexArr, unknown] \u0026gt;; \u0026nbsp;AllCombinations ğŸ’¯Take a Challenge\nImplement type AllCombinations\u0026lt;S\u0026gt; that return all combinations of strings which use characters from S at most once.\nFor example:\n1 2 type AllCombinations_ABC = AllCombinations\u0026lt;\u0026#34;ABC\u0026#34;\u0026gt;; // should be \u0026#39;\u0026#39; | \u0026#39;A\u0026#39; | \u0026#39;B\u0026#39; | \u0026#39;C\u0026#39; | \u0026#39;AB\u0026#39; | \u0026#39;AC\u0026#39; | \u0026#39;BA\u0026#39; | \u0026#39;BC\u0026#39; | \u0026#39;CA\u0026#39; | \u0026#39;CB\u0026#39; | \u0026#39;ABC\u0026#39; | \u0026#39;ACB\u0026#39; | \u0026#39;BAC\u0026#39; | \u0026#39;BCA\u0026#39; | \u0026#39;CAB\u0026#39; | \u0026#39;CBA\u0026#39; ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 type StringToUnion\u0026lt;S extends string\u0026gt; = S extends `${infer F}${infer R}` ? F | StringToUnion\u0026lt;R\u0026gt; : never; type Combination\u0026lt;S extends string, U extends string = \u0026#34;\u0026#34;, K = S\u0026gt; = [S] extends [ never ] ? U : K extends S ? Combination\u0026lt;Exclude\u0026lt;S, K\u0026gt;, U | `${U}${K}`\u0026gt; : U; type AllCombination\u0026lt;S extends string\u0026gt; = Combination\u0026lt;StringToUnion\u0026lt;S\u0026gt;\u0026gt;; \u0026nbsp;Greater Than ğŸ’¯Take a Challenge\nIn This Challenge, You should implement a type GreaterThan\u0026lt;T, U\u0026gt; like T \u0026gt; U\nNegative numbers do not need to be considered.\nFor example\n1 2 3 4 GreaterThan\u0026lt;2, 1\u0026gt; //should be true GreaterThan\u0026lt;1, 1\u0026gt; //should be false GreaterThan\u0026lt;10, 100\u0026gt; //should be false GreaterThan\u0026lt;111, 11\u0026gt; //should be true ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 type GreaterThan\u0026lt; Num1 extends number, Num2 extends number, CountArr extends unknown[] = [] \u0026gt; = Num1 extends Num2 ? false : CountArr[\u0026#34;length\u0026#34;] extends Num2 ? true : CountArr[\u0026#34;length\u0026#34;] extends Num1 ? false : GreaterThan\u0026lt;Num1, Num2, [...CountArr, unknown]\u0026gt;; \u0026nbsp;Zip ğŸ’¯Take a Challenge\nIn This Challenge, You should implement a type Zip\u0026lt;T, U\u0026gt;, T and U must be Tuple\n1 type exp = Zip\u0026lt;[1, 2], [true, false]\u0026gt;; // expected to be [[1, true], [2, false]] ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 type Zip\u0026lt;One extends unknown[], Other extends unknown[]\u0026gt; = One extends [ infer OneFirst, ...infer OneRest ] ? Other extends [infer OtherFirst, ...infer OtherRest] ? [[OneFirst, OtherFirst], ...Zip\u0026lt;OneRest, OtherRest\u0026gt;] : [] : []; \u0026nbsp;IsTuple ğŸ’¯Take a Challenge\nImplement a type IsTuple, which takes an input type T and returns whether T is tuple type.\nFor example:\n1 2 3 type case1 = IsTuple\u0026lt;[number]\u0026gt;; // true type case2 = IsTuple\u0026lt;readonly [number]\u0026gt;; // true type case3 = IsTuple\u0026lt;number[]\u0026gt;; // false ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 type IsTuple\u0026lt;T\u0026gt; = [T] extends [never] ? false : T extends readonly [...params: infer Eles] ? NotEqual\u0026lt;Eles[\u0026#34;length\u0026#34;], number\u0026gt; : false; type NotEqual\u0026lt;A, B\u0026gt; = (\u0026lt;T\u0026gt;() =\u0026gt; T extends A ? 1 : 2) extends \u0026lt; T \u0026gt;() =\u0026gt; T extends B ? 1 : 2 ? false : true; \u0026nbsp;Chunk ğŸ’¯Take a Challenge\nDo you know lodash? Chunk is a very useful function in it, now let\u0026rsquo;s implement it. Chunk\u0026lt;T, N\u0026gt; accepts two required type parameters, the T must be a tuple, and the N must be an integer \u0026gt;=1\n1 2 3 type exp1 = Chunk\u0026lt;[1, 2, 3], 2\u0026gt;; // expected to be [[1, 2], [3]] type exp2 = Chunk\u0026lt;[1, 2, 3], 4\u0026gt;; // expected to be [[1, 2, 3]] type exp3 = Chunk\u0026lt;[1, 2, 3], 1\u0026gt;; // expected to be [[1], [2], [3]] ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 type Chunk\u0026lt; T extends any[], Size extends number, R extends any[] = [] \u0026gt; = R[\u0026#34;length\u0026#34;] extends Size ? [R, ...Chunk\u0026lt;T, Size\u0026gt;] : T extends [infer F, ...infer L] ? Chunk\u0026lt;L, Size, [...R, F]\u0026gt; : R[\u0026#34;length\u0026#34;] extends 0 ? [] : [R]; \u0026nbsp;Fill ğŸ’¯Take a Challenge\nFill, a common JavaScript function, now let us implement it with types. Fill\u0026lt;T, N, Start?, End?\u0026gt;, as you can see,Fill accepts four types of parameters, of which T and N are required parameters, and Start and End are optional parameters. The requirements for these parameters are: T must be a tuple, N can be any type of value, Start and End must be integers greater than or equal to 0.\n1 type exp = Fill\u0026lt;[1, 2, 3], 0\u0026gt;; // expected to be [0, 0, 0] In order to simulate the real function, the test may contain some boundary conditions, I hope you can enjoy it :) ç­”æ¡ˆ:\n1 2 3 type Fill\u0026lt;T extends any[], U\u0026gt; = T extends [any, ...infer Rest] ? [U, ...Fill\u0026lt;Rest, U\u0026gt;] : []; \u0026nbsp;Trim Right ğŸ’¯Take a Challenge\nImplement TrimRight\u0026lt;T\u0026gt; which takes an exact string type and returns a new string with the whitespace ending removed.\nFor example:\n1 type Trimed = TrimRight\u0026lt;\u0026#34; Hello World \u0026#34;\u0026gt;; // expected to be \u0026#39; Hello World\u0026#39; ç­”æ¡ˆ:\n1 2 3 4 5 6 type TrimRight\u0026lt;Str extends string\u0026gt; = Str extends `${infer Rest}${ | \u0026#34; \u0026#34; | \u0026#34;\\n\u0026#34; | \u0026#34;\\t\u0026#34;}` ? TrimRight\u0026lt;Rest\u0026gt; : Str; \u0026nbsp;Without ğŸ’¯Take a Challenge\nImplement the type version of Lodash.without, Without\u0026lt;T, U\u0026gt; takes an Array T, number or array U and returns an Array without the elements of U.\n1 2 3 type Res = Without\u0026lt;[1, 2], 1\u0026gt;; // expected to be [2] type Res1 = Without\u0026lt;[1, 2, 4, 1, 5], [1, 2]\u0026gt;; // expected to be [4, 5] type Res2 = Without\u0026lt;[2, 3, 2, 3, 2, 3, 2, 3], [2, 3]\u0026gt;; // expected to be [] ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 type ToUnion\u0026lt;T\u0026gt; = T extends any[] ? T[number] : T; type Without\u0026lt; T extends any[], F, U = ToUnion\u0026lt;F\u0026gt;, R extends any[] = [] \u0026gt; = T extends [infer First, ...infer Rest] ? First extends U ? Without\u0026lt;Rest, F, U, [...R]\u0026gt; : Without\u0026lt;Rest, F, U, [...R, First]\u0026gt; : R; \u0026nbsp;Trunc ğŸ’¯Take a Challenge Implement the type version of Math.trunc, which takes string or number and returns the integer part of a number by removing any fractional digits.\nFor example:\n1 type A = Trunc\u0026lt;12.34\u0026gt;; // 12 ç­”æ¡ˆ:\n1 2 3 type Trunc\u0026lt;T extends number | string\u0026gt; = `${T}` extends `${infer L}.${string}` ? L : `${T}`; \u0026nbsp;IndexOf ğŸ’¯Take a Challenge\nImplement the type version of Array.indexOf, indexOf\u0026lt;T, U\u0026gt; takes an Array T, any U and returns the index of the first U in Array T.\n1 2 3 type Res = IndexOf\u0026lt;[1, 2, 3], 2\u0026gt;; // expected to be 1 type Res1 = IndexOf\u0026lt;[2, 6, 3, 8, 4, 1, 7, 3, 9], 3\u0026gt;; // expected to be 2 type Res2 = IndexOf\u0026lt;[0, 0, 0], 2\u0026gt;; // expected to be -1 ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 type IndexOf\u0026lt;T extends any[], U, Index extends any[] = []\u0026gt; = T extends [ infer First, ...infer Rest ] ? First extends U ? Index[\u0026#34;length\u0026#34;] : IndexOf\u0026lt;Rest, U, [...Index, 0]\u0026gt; : -1; \u0026nbsp;Join ğŸ’¯Take a Challenge\nImplement the type version of Array.join, Join\u0026lt;T, U\u0026gt; takes an Array T, string or number U and returns the Array T with U stitching up.\n1 2 3 4 type Res = Join\u0026lt;[\u0026#34;a\u0026#34;, \u0026#34;p\u0026#34;, \u0026#34;p\u0026#34;, \u0026#34;l\u0026#34;, \u0026#34;e\u0026#34;], \u0026#34;-\u0026#34;\u0026gt;; // expected to be \u0026#39;a-p-p-l-e\u0026#39; type Res1 = Join\u0026lt;[\u0026#34;Hello\u0026#34;, \u0026#34;World\u0026#34;], \u0026#34; \u0026#34;\u0026gt;; // expected to be \u0026#39;Hello World\u0026#39; type Res2 = Join\u0026lt;[\u0026#34;2\u0026#34;, \u0026#34;2\u0026#34;, \u0026#34;2\u0026#34;], 1\u0026gt;; // expected to be \u0026#39;21212\u0026#39; type Res3 = Join\u0026lt;[\u0026#34;o\u0026#34;], \u0026#34;u\u0026#34;\u0026gt;; // expected to be \u0026#39;o\u0026#39; ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 type Join\u0026lt; T extends any[], U extends string | number, R extends string = \u0026#34;\u0026#34; \u0026gt; = T extends [infer First, ...infer Rest] ? Rest[\u0026#34;length\u0026#34;] extends 0 ? `${R extends \u0026#34;\u0026#34; ? \u0026#34;\u0026#34; : `${R}${U}`}${First \u0026amp; string}` : Join\u0026lt;Rest, U, `${R extends \u0026#34;\u0026#34; ? \u0026#34;\u0026#34; : `${R}${U}`}${First \u0026amp; string}`\u0026gt; : R; \u0026nbsp;LastIndexOf ğŸ’¯Take a Challenge\nImplement the type version of Array.lastIndexOf, LastIndexOf\u0026lt;T, U\u0026gt; takes an Array T, any U and returns the index of the last U in Array T\nFor example:\n1 2 type Res1 = LastIndexOf\u0026lt;[1, 2, 3, 2, 1], 2\u0026gt;; // 3 type Res2 = LastIndexOf\u0026lt;[0, 0, 0], 2\u0026gt;; // -1 ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 type Pop\u0026lt;T extends any[]\u0026gt; = T extends [...infer Rest, any] ? Rest : never; type LastIndexOf\u0026lt;T extends any[], U, Index extends any[] = Pop\u0026lt;T\u0026gt;\u0026gt; = T extends [ ...infer Rest, infer Last ] ? Last extends U ? Index[\u0026#34;length\u0026#34;] : LastIndexOf\u0026lt;Rest, U, Pop\u0026lt;Index\u0026gt;\u0026gt; : -1; \u0026nbsp;Unique ğŸ’¯Take a Challenge\nImplement the type version of Lodash.uniq, Unique takes an Array T, returns the Array T without repeated values.\n1 2 3 4 5 type Res = Unique\u0026lt;[1, 1, 2, 2, 3, 3]\u0026gt;; // expected to be [1, 2, 3] type Res1 = Unique\u0026lt;[1, 2, 3, 4, 4, 5, 6, 7]\u0026gt;; // expected to be [1, 2, 3, 4, 5, 6, 7] type Res2 = Unique\u0026lt;[1, \u0026#34;a\u0026#34;, 2, \u0026#34;b\u0026#34;, 2, \u0026#34;a\u0026#34;]\u0026gt;; // expected to be [1, \u0026#34;a\u0026#34;, 2, \u0026#34;b\u0026#34;] type Res3 = Unique\u0026lt;[string, number, 1, \u0026#34;a\u0026#34;, 1, string, 2, \u0026#34;b\u0026#34;, 2, number]\u0026gt;; // expected to be [string, number, 1, \u0026#34;a\u0026#34;, 2, \u0026#34;b\u0026#34;] type Res4 = Unique\u0026lt;[unknown, unknown, any, any, never, never]\u0026gt;; // expected to be [unknown, any, never] ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 type Unique\u0026lt;T extends any[], R extends any[] = []\u0026gt; = T extends [ infer First, ...infer Rest ] ? First extends R[number] ? Unique\u0026lt;Rest, [...R]\u0026gt; : Unique\u0026lt;Rest, [...R, First]\u0026gt; : R; \u0026nbsp;MapTypes ğŸ’¯Take a Challenge\nImplement MapTypes\u0026lt;T, R\u0026gt; which will transform types in object T to different types defined by type R which has the following structure\n1 2 3 4 type StringToNumber = { mapFrom: string; // value of key which value is string mapTo: number; // will be transformed for number }; Examples:\n1 2 type StringToNumber = { mapFrom: string; mapTo: number;} MapTypes\u0026lt;{iWillBeANumberOneDay: string}, StringToNumber\u0026gt; // gives { iWillBeANumberOneDay: number; } Be aware that user can provide a union of types:\n1 2 3 type StringToNumber = { mapFrom: string; mapTo: number;} type StringToDate = { mapFrom: string; mapTo: Date;} MapTypes\u0026lt;{iWillBeNumberOrDate: string}, StringToDate | StringToNumber\u0026gt; // gives { iWillBeNumberOrDate: number | Date; } If the type doesn\u0026rsquo;t exist in our map, leave it as it was:\n1 2 type StringToNumber = { mapFrom: string; mapTo: number;} MapTypes\u0026lt;{iWillBeANumberOneDay: string, iWillStayTheSame: Function}, StringToNumber\u0026gt; // // gives { iWillBeANumberOneDay: number, iWillStayTheSame: Function } ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 type GetMapType\u0026lt; T, R, Type = R extends { mapFrom: T; mapTo: infer To } ? To : never \u0026gt; = [Type] extends [never] ? T : Type; type MapTypes\u0026lt;T, R\u0026gt; = { [P in keyof T]: GetMapType\u0026lt;T[P], R\u0026gt;; }; \u0026nbsp;Construct Tuple ğŸ’¯Take a Challenge\nConstruct a tuple with a given length.\nFor example\n1 type result = ConstructTuple\u0026lt;2\u0026gt;; // expect to be [unknown, unkonwn] ç­”æ¡ˆ:\n1 2 3 4 5 // your answers type ConstructTuple\u0026lt; T extends number, R extends unknown[] = [] \u0026gt; = R[\u0026#34;length\u0026#34;] extends T ? R : ConstructTuple\u0026lt;T, [...R, unknown]\u0026gt;; \u0026nbsp;Number Range ğŸ’¯Take a Challenge\nSometimes we want to limit the range of numbers\u0026hellip; For examples.\ntype result = NumberRange\u0026lt;2 , 9\u0026gt; // | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 type ConstructTuple\u0026lt; L extends number, Result extends number[] = [] \u0026gt; = Result[\u0026#34;length\u0026#34;] extends L ? [...Result, 1] : ConstructTuple\u0026lt;L, [...Result, 1]\u0026gt;; type NumberRange\u0026lt; L extends number, H extends number, Temp extends number[] = ConstructTuple\u0026lt;L\u0026gt;, Result extends unknown[] = [L] \u0026gt; = L extends H ? Result[number] : NumberRange\u0026lt;Temp[\u0026#34;length\u0026#34;], H, [...Temp, 1], [...Result, Temp[\u0026#34;length\u0026#34;]]\u0026gt;; \u0026nbsp;Combination ğŸ’¯Take a Challenge\nGiven an array of strings, do Permutation \u0026amp; Combination. It\u0026rsquo;s also useful for the prop types like video controlsList\n1 2 // expected to be `\u0026#34;foo\u0026#34; | \u0026#34;bar\u0026#34; | \u0026#34;baz\u0026#34; | \u0026#34;foo bar\u0026#34; | \u0026#34;foo bar baz\u0026#34; | \u0026#34;foo baz\u0026#34; | \u0026#34;foo baz bar\u0026#34; | \u0026#34;bar foo\u0026#34; | \u0026#34;bar foo baz\u0026#34; | \u0026#34;bar baz\u0026#34; | \u0026#34;bar baz foo\u0026#34; | \u0026#34;baz foo\u0026#34; | \u0026#34;baz foo bar\u0026#34; | \u0026#34;baz bar\u0026#34; | \u0026#34;baz bar foo\u0026#34;` type Keys = Combination\u0026lt;[\u0026#34;foo\u0026#34;, \u0026#34;bar\u0026#34;, \u0026#34;baz\u0026#34;]\u0026gt;; ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 type AllCombinations\u0026lt;T extends string[], S extends string = T[number]\u0026gt; = [ S ] extends [never] ? \u0026#34;\u0026#34; : \u0026#34;\u0026#34; | { [K in S]: `${K} ${AllCombinations\u0026lt;never, Exclude\u0026lt;S, K\u0026gt;\u0026gt;}` }[S]; type TrimRight\u0026lt;T extends string, S = T\u0026gt; = T extends `${infer R}${ | \u0026#34; \u0026#34; | \u0026#34;\\n\u0026#34; | \u0026#34;\\t\u0026#34;}` ? TrimRight\u0026lt;R\u0026gt; : S; type Combination\u0026lt;T extends string[]\u0026gt; = TrimRight\u0026lt; Exclude\u0026lt;AllCombinations\u0026lt;T\u0026gt;, \u0026#34;\u0026#34;\u0026gt; \u0026gt;; \u0026nbsp;Subsequence ğŸ’¯Take a Challenge\nGiven an array of unique elements, return all possible subsequences.\nA subsequence is a sequence that can be derived from an array by deleting some or no elements without changing the order of the remaining elements.\nFor example:\n1 type A = Subsequence\u0026lt;[1, 2]\u0026gt;; // [] | [1] | [2] | [1, 2] ç­”æ¡ˆ:\n1 2 3 4 5 6 7 8 9 type Subsequence\u0026lt;T extends number[], K extends number[] = []\u0026gt; = T extends [ infer L, ...infer R ] ? Subsequence\u0026lt; R extends number[] ? R : [], K | [...K, ...(L extends number ? [L] : [])] \u0026gt; : K; ","permalink":"https://zzydev.top/posts/headfirstts/ts%E7%B1%BB%E5%9E%8B%E6%8C%91%E6%88%98medium%E7%AF%87/","summary":"\u0026nbsp;è·å–å‡½æ•°è¿”å›ç±»å‹ ğŸ’¯Take a Challenge ä¸ä½¿ç”¨ ReturnType å®ç° TypeScript çš„ ReturnType\u0026lt;T\u0026gt; æ³›å‹ã€‚ ä¾‹å¦‚ï¼š 1 2 3 4 5 6 const fn = (v: boolean) =\u0026gt; { if (v) return 1; else return 2; }; type a = MyReturnType\u0026lt;typeof fn\u0026gt;; // åº”æ¨å¯¼å‡º \u0026#34;1 | 2\u0026#34;","title":"TSç±»å‹æŒ‘æˆ˜Mediumç¯‡"},{"content":" \u0026nbsp;æ ¹æ®è¿ç®—ä¼˜å…ˆçº§æ·»åŠ æ‹¬å· ç°å·²çŸ¥ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ç”±æ­£æ•´æ•°å’ŒåŠ å‡ä¹˜é™¤å››ä¸ªè¿ç®—ç¬¦(+ - * /)ç»„æˆã€‚\nä¾‹å¦‚å­˜åœ¨å­—ç¬¦ä¸² const str = '11+2-3*4+5/2*4+10/5'ï¼Œç°åœ¨éœ€è¦å°†é«˜ä¼˜å…ˆçº§è¿ç®—ï¼Œç”¨å°æ‹¬å·åŒ…è£¹èµ·æ¥ï¼Œä¾‹å¦‚ç»“æœä¸º '11+2-(3*4)+(5/2*4)+(10/5)'ã€‚æ³¨æ„å¯èƒ½ä¼šå‡ºç°è¿ç»­çš„ä¹˜é™¤è¿ç®—ï¼Œéœ€è¦åŒ…è£¹åˆ°ä¸€èµ·ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 function addBrackets(str) { return str .split(\u0026#34;-\u0026#34;) .map((item) =\u0026gt; { if (item.includes(\u0026#34;+\u0026#34;)) { return item .split(\u0026#34;+\u0026#34;) .map((val) =\u0026gt; { if (val.includes(\u0026#34;*\u0026#34;) || val.includes(\u0026#34;/\u0026#34;)) { return `(${val})`; } return val; }) .join(\u0026#34;+\u0026#34;); } else { return item; } }) .join(\u0026#34;-\u0026#34;); } \u0026nbsp;å®ç°ä¸€ä¸ªç±»ï¼Œå…¶å®ä¾‹å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œå®ƒæœ‰ä¸€ä¸ªsleepæ–¹æ³• 1 2 3 4 5 6 7 8 const badboy = new PlayBoy(\u0026#34;zzydev\u0026#34;); // [è¯‘]playboy n.æ¸£ç”· badboy.sayHi().sleep(1000).do(\u0026#34;å­¦ç©¿æ­\u0026#34;).sleep(2000).do(\u0026#34;å­¦ç‘œä¼½\u0026#34;); // è¾“å‡º // å¦¹å¦¹ä½ å¥½ï¼Œæˆ‘æ˜¯zzydev // 1s ä¹‹å // æˆ‘åœ¨å­¦ç©¿æ­ // 2s ä¹‹å // æˆ‘åœ¨å­¦ç‘œä¼½ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 // é¦–å…ˆ å®šä¹‰ä¸€ä¸ªç±» PlayBoy class PlayBoy { constructor(name) { this.name = name; this.queue = []; //åˆ›å»ºä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ï¼ˆåˆ©ç”¨é˜Ÿåˆ—çš„å…ˆè¿›å…ˆå‡ºæ€§è´¨æ¥æ¨¡æ‹Ÿé“¾å¼è°ƒç”¨å‡½æ•°çš„æ‰§è¡Œé¡ºåºï¼‰ setTimeout(() =\u0026gt; { // è¿›å…¥å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ— ä¹Ÿæ˜¯å¼€å¯ è‡ªå®šä¹‰ä»»åŠ¡é˜Ÿåˆ— queue çš„å…¥å£ this.next(); // nextæ˜¯ç±»PlayBoy åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œç”¨æ¥ä»queue ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºå‡½æ•°æ‰§è¡Œ }, 0); return this; } } PlayBoy.prototype.sayHi = function () { const fn = () =\u0026gt; { console.log(\u0026#34;å¦¹å¦¹ä½ å¥½ï¼Œæˆ‘æ˜¯\u0026#34;, this.name); this.next(); }; this.queue.push(fn); return this; }; PlayBoy.prototype.sleep = function (timer) { const fn = () =\u0026gt; { setTimeout(() =\u0026gt; { this.next(); }, timer); }; this.queue.push(fn); return this; }; PlayBoy.prototype.do = function (...args) { const fn = () =\u0026gt; { console.log(\u0026#34;æˆ‘åœ¨\u0026#34;, ...args); this.next(); }; this.queue.push(fn); return this; }; PlayBoy.prototype.next = function () { const fn = this.queue.shift(); // ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºå‡½æ•° å‡½æ•°å­˜åœ¨çš„è¯å³è°ƒç”¨ fn \u0026amp;\u0026amp; fn(); }; new PlayBoy(\u0026#34;zzydev\u0026#34;).sayHi().sleep(1000).do(\u0026#34;å­¦ç©¿æ­\u0026#34;).sleep(2000).do(\u0026#34;å­¦ç‘œä¼½\u0026#34;); \u0026nbsp;æ¨¡æ‹Ÿ let å’Œ const å—çº§ä½œç”¨åŸŸ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 // æ¨¡æ‹Ÿlet (function () { var a = 1; console.log(\u0026#34;å†…éƒ¨a:\u0026#34;, a); })(); //æ¨¡æ‹Ÿconst constå€¼ä¸å¯å˜ (function () { var a = { a: 1, b: 2 }; //å¯¹è±¡ if (Object.prototype.toString.call(a) === \u0026#34;[object Object]\u0026#34;) { var b = a; a.c = 3; //æˆ–è€… // a = {}; if (a !== b) { console.error(\u0026#34;å˜é‡ä¸èƒ½å†æ¬¡èµ‹å€¼\u0026#34;); a = b; } console.log(a); } else { //åŸºç¡€ç±»å‹å€¼ var prev = a; a = 2; if (a !== prev) { console.error(\u0026#34;å˜é‡ä¸èƒ½å†æ¬¡èµ‹å€¼\u0026#34;); a = prev; } console.log(a); } })(); \u0026nbsp;ä½¿ç”¨Promiseå°è£…ä¸€ä¸ªå¼‚æ­¥åŠ è½½å›¾ç‰‡çš„æ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 function loadImg(url) { return new Promise((resolve, reject) =\u0026gt; { const img = new Image(); img.onload = function() { resolve(img); }; img.onerror = function() { reject(new Error(\u0026#39;Could not load image at\u0026#39; + url)); }; img.src = url; }); \u0026nbsp;å®ç°äº‹ä»¶å§”æ‰˜ å¾ªç¯åˆ›å»º 10 ä¸ª li æ ‡ç­¾ï¼Œå½“ç‚¹å‡» li æ ‡ç­¾æ—¶ï¼Œæ‰“å°å…¶å¯¹åº”çš„ç´¢å¼•\n1 \u0026lt;ul id=\u0026#34;list\u0026#34;\u0026gt;\u0026lt;/ul\u0026gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 function loadNode(len) { var html = \u0026#34;\u0026#34;; for (let index = 0; index \u0026lt; 10; index++) { html += \u0026#34;\u0026lt;li\u0026gt;\u0026#34; + index + \u0026#34;\u0026lt;/li\u0026gt;\u0026#34;; } var list = document.getElementById(\u0026#34;list\u0026#34;); list.onclick = function (event) { event = event || window.event; var target = event.target || event.srcElement; if (target.nodeName.toLowerCase() === \u0026#34;li\u0026#34;) { console.log(target.innerText); } }; list.innerHTML = html; } loadNode(); \u0026nbsp;æ¨¡æ‹Ÿç§æœ‰ 1 2 3 4 5 6 7 8 9 function cls() { this.a = \u0026#34;who care\u0026#34;; return { getVal: () =\u0026gt; this.a, }; } let obj = new cls(); obj.getVal(); 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 const myWm = new WeakMap(); class Fish { constructor(name) { myWm.set(this, { _fishbone: [ \u0026#34;è‰é±¼\u0026#34;, \u0026#34;é²«é±¼\u0026#34;, \u0026#34;é’é±¼\u0026#34;, \u0026#34;é²¤é±¼\u0026#34;, \u0026#34;é²¢é±¼\u0026#34;, \u0026#34;é³™é±¼\u0026#34;, \u0026#34;é³Šé±¼\u0026#34;, \u0026#34;ç¿˜å˜´\u0026#34;, \u0026#34;é¤æ¡\u0026#34;, ], }); this.name = name; } isBone() { return myWm.get(this)._fishbone.includes(this.name); } } // æµ‹è¯•ï¼Œä¹°äº†ä¸¤æ¡é±¼ let fish1 = new Fish(\u0026#34;è‰é±¼\u0026#34;); let fish2 = new Fish(\u0026#34;å›é±¼\u0026#34;); // è¿”å› trueï¼Œæœ‰åˆº console.log(fish1.isBone()); // è¿”å› falseï¼Œæ²¡æœ‰è‚Œé—´åˆº console.log(fish2.isBone()); \u0026nbsp;å¦‚ä½•å®ç°ä¸Šæ‹‰åŠ è½½ï¼Œä¸‹æ‹‰åˆ·æ–°ï¼Ÿ ä¸Šæ‹‰åŠ è½½ \u0026nbsp;åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯æ™®é€šå¯¹è±¡è¿˜æ˜¯é€šè¿‡ç±»åˆ›å»ºçš„ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 const isPlainObject = (obj: any): boolean =\u0026gt; { if (typeof obj !== \u0026#34;object\u0026#34; || obj === null) { return false; } let proto = Object.getPrototypeOf(obj); if (proto === null) { return true; } let baseProto = proto; while (Object.getPrototypeOf(baseProto) !== null) { baseProto = Object.getPrototypeOf(baseProto); } return proto === baseProto; }; \u0026nbsp;å›¾ç‰‡åŠ è½½å¤±è´¥å¤„ç†æ–¹å¼ 1 2 3 \u0026lt;!-- å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å›¾ç‰‡è‡ªå¸¦çš„ error äº‹ä»¶å¤„ç†å³å¯ --\u0026gt; \u0026lt;img src={imgSrc} onError={event =\u0026gt; { event.currentTarget.src = defaultSrc; }} /\u0026gt; \u0026nbsp;åˆ¤æ–­æ˜¯ä¸æ˜¯NaN 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 function isNaNVal(val) { return Object.is(val, NaN); } function isNaNVal(val) { return val !== val; } function isNaNVal(val) { return typeof val === \u0026#34;number\u0026#34; \u0026amp;\u0026amp; isNaN(val); } if (!(\u0026#34;isNaN\u0026#34; in Number)) { Number.isNaN = function (val) { return typeof val === \u0026#34;number\u0026#34; \u0026amp;\u0026amp; isNaN(val); }; } // https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Equality_comparisons_and_sameness var arr = [NaN]; arr.indexOf(NaN); // -1 Number::equal arr.includes(NaN); // true Number::sameValueZero [ ] \u0026nbsp;è§£å‹å­—ç¬¦ä¸² ç»™å®šä¸€ä¸ªå‹ç¼©è¿‡åçš„å­—ç¬¦ä¸²ï¼Œè¯·æ¢å¤å…¶åŸå§‹çŠ¶æ€ã€‚\nuncompress(\u0026#39;3(ab)\u0026#39;) // \u0026#39;ababab\u0026#39; uncompress(\u0026#39;3(ab2(c))\u0026#39;) // \u0026#39;abccabccabcc\u0026#39; æ•°å­— k ä¹‹åå¦‚æœæœ‰ä¸€å¯¹æ‹¬å·ï¼Œæ„å‘³ç€æ‹¬å·å†…çš„å­å­—ç¬¦ä¸²åœ¨åŸæ¥çš„çŠ¶æ€ä¸­é‡å¤äº† k æ¬¡ã€‚k æ˜¯æ­£æ•´æ•°ã€‚ æµ‹è¯•ç”¨ä¾‹çš„è¾“å…¥å‡ä¸ºæœ‰æ•ˆå­—ç¬¦ä¸²ï¼ŒåŸå§‹å­—ç¬¦ä¸²ä¸­ä¸å­˜åœ¨æ•°å­—\nå‚è€ƒç­”æ¡ˆï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 const isNumber = (str) =\u0026gt; !isNaN(Number(str)) \u0026amp;\u0026amp; isFinite(Number(str)); function uncompress(str) { let stack = []; for (const char of str) { if (char !== \u0026#34;)\u0026#34;) { stack.push(char); } else { let word = \u0026#34;\u0026#34;; let count = \u0026#34;\u0026#34;; while (stack.length \u0026amp;\u0026amp; stack[stack.length - 1] !== \u0026#34;(\u0026#34;) { word = stack.pop() + word; } stack.pop(); while (stack.length \u0026amp;\u0026amp; isNumber(stack[stack.length - 1])) { count = stack.pop() + count; } stack.push(word.repeat(Number(count))); } } return stack.join(\u0026#34;\u0026#34;); } \u0026nbsp;undefined to null å®ç°ä¸€ä¸ªå‡½æ•° undefinedToNull(),è¦æ±‚å°†æ‰€æœ‰çš„ undefined æ›¿æ¢æˆ null\n1 2 3 4 5 undefinedToNull({ a: undefined, b: \u0026#34;BFE.dev\u0026#34; }); // {a: null, b: \u0026#39;BFE.dev\u0026#39;} undefinedToNull({ a: [\u0026#34;BFE.dev\u0026#34;, undefined, \u0026#34;bigfrontend.dev\u0026#34;] }); // {a: [\u0026#39;BFE.dev\u0026#39;, null, \u0026#39;bigfrontend.dev\u0026#39;]} å‚è€ƒç­”æ¡ˆï¼š\n1 2 3 4 5 6 7 8 9 const isObject = (obj) =\u0026gt; typeof obj === \u0026#34;object\u0026#34; \u0026amp;\u0026amp; obj !== null; function undefinedToNull(arg) { if (!isObject(arg)) return arg; for (let [key, val] of Object.entries(arg)) { if (val === undefined) arg[key] = null; else arg[key] = undefinedToNull(val); } return arg; } ","permalink":"https://zzydev.top/posts/eight-part-essay/%E6%88%91%E7%9A%84%E6%8B%B7%E9%9D%A2%E7%BB%8F_2/","summary":"\u0026nbsp;æ ¹æ®è¿ç®—ä¼˜å…ˆçº§æ·»åŠ æ‹¬å· ç°å·²çŸ¥ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ç”±æ­£æ•´æ•°å’ŒåŠ å‡ä¹˜é™¤å››ä¸ªè¿ç®—ç¬¦(+ - * /)ç»„æˆã€‚ ä¾‹å¦‚å­˜åœ¨å­—ç¬¦ä¸² const str = '11+2-3*4+5","title":"æˆ‘çš„æ‹·é¢ç»ï¼ˆäºŒï¼‰"},{"content":"å·¥å‚æ¨¡å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 interface IProduct { name: string; fn1: () =\u0026gt; void; fn2: () =\u0026gt; void; } class Product1 implements IProduct { constructor(public name: string) {} fn1() { console.log(\u0026#34;product1\u0026#34;); } fn2() { console.log(\u0026#34;product1\u0026#34;); } } class Product2 implements IProduct { constructor(public name: string) {} fn1() { console.log(\u0026#34;product2\u0026#34;); } fn2() { console.log(\u0026#34;product1\u0026#34;); } } class Creator { // ä¾èµ–å€’ç½®åŸåˆ™ ï¼ˆä¾èµ–æŠ½è±¡ï¼Œè€Œä¸æ˜¯å…·ä½“ï¼‰ create(type: string, name: string): IProduct { if (type === \u0026#34;p1\u0026#34;) { return new Product1(name); } if (type === \u0026#34;p2\u0026#34;) { return new Product2(name); } throw new Error(); } } ","permalink":"https://zzydev.top/posts/headfirstts/ts%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","summary":"å·¥å‚æ¨¡å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 interface IProduct { name: string; fn1: () =\u0026gt; void; fn2: () =\u0026gt; void; } class Product1 implements IProduct { constructor(public name: string) {} fn1() { console.log(\u0026#34;product1\u0026#34;); } fn2()","title":"TSè®¾è®¡æ¨¡å¼"},{"content":" å¤§æ¦‚æ˜¯ä¸€ä»½ä¸å®Œæ•´çš„ Vite å¤‡å¿˜å½•\nno-bundle æ˜¯ä»€ä¹ˆ no-bundle ç†å¿µï¼šåˆ©ç”¨æµè§ˆå™¨åŸç”Ÿ ES æ¨¡å—çš„æ”¯æŒï¼Œå®ç°å¼€å‘é˜¶æ®µçš„ Dev Serverï¼Œè¿›è¡Œæ¨¡å—çš„æŒ‰éœ€åŠ è½½ï¼Œè€Œä¸æ˜¯å…ˆæ•´ä½“æ‰“åŒ…å†è¿›è¡ŒåŠ è½½\nåœ¨ Vite é¡¹ç›®ä¸­ï¼Œä¸€ä¸ª import è¯­å¥ä»£è¡¨ä¸€ä¸ª HTTP è¯·æ±‚ã€‚ Vite çš„ Dev Server æ¥æ¥æ”¶è¿™äº›è¯·æ±‚ã€è¿›è¡Œæ–‡ä»¶è½¬è¯‘ä»¥åŠè¿”å›æµè§ˆå™¨å¯ä»¥è¿è¡Œçš„ä»£ç ã€‚å½“æµè§ˆå™¨è§£æåˆ°æ–°çš„ import è¯­å¥ï¼Œåˆä¼šå‘å‡ºæ–°çš„è¯·æ±‚ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰çš„èµ„æºéƒ½åŠ è½½å®Œæˆã€‚\nCSS å·¥ç¨‹åŒ–æ–¹æ¡ˆ è‡ªåŠ¨å¼•å…¥ CSS 1 2 3 4 5 6 7 8 9 /*variable.scss*/ $theme-color: red; /*index.scss*/ @import \u0026#34;../../variable\u0026#34;; .header { color: $theme-color; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // vite.config.ts import { normalizePath } from \u0026#34;vite\u0026#34;; // å¦‚æœç±»å‹æŠ¥é”™ï¼Œéœ€è¦å®‰è£… @types/node import path from \u0026#34;path\u0026#34;; // å…¨å±€ scss æ–‡ä»¶çš„è·¯å¾„ // ç”¨ normalizePath è§£å†³ window ä¸‹çš„è·¯å¾„é—®é¢˜ const variablePath = normalizePath(path.resolve(\u0026#34;./src/variable.scss\u0026#34;)); export default defineConfig({ // css ç›¸å…³çš„é…ç½® css: { preprocessorOptions: { scss: { // additionalData çš„å†…å®¹ä¼šåœ¨æ¯ä¸ª scss æ–‡ä»¶çš„å¼€å¤´è‡ªåŠ¨æ³¨å…¥ additionalData: `@import \u0026#34;${variablePath}\u0026#34;;`, }, }, }, }); CSS Modules è‡ªå®šä¹‰ç”Ÿæˆçš„ç±»å 1 2 3 4 5 6 7 8 9 10 11 12 13 // vite.config.ts export default { css: { modules: { // ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥é€šè¿‡ generateScopedName å±æ€§æ¥å¯¹ç”Ÿæˆçš„ç±»åè¿›è¡Œè‡ªå®šä¹‰ // å…¶ä¸­ï¼Œname è¡¨ç¤ºå½“å‰æ–‡ä»¶åï¼Œlocal è¡¨ç¤ºç±»å generateScopedName: \u0026#34;[name]__[local]___[hash:base64:5]\u0026#34;, }, preprocessorOptions: { // çœç•¥é¢„å¤„ç†å™¨é…ç½® }, }, }; PostCSS æ¥å…¥ autoprefixer æ’ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // vite.config.ts å¢åŠ å¦‚ä¸‹çš„é…ç½® import autoprefixer from \u0026#34;autoprefixer\u0026#34;; export default { css: { // è¿›è¡Œ PostCSS é…ç½® postcss: { plugins: [ autoprefixer({ // æŒ‡å®šç›®æ ‡æµè§ˆå™¨ overrideBrowserslist: [\u0026#34;Chrome \u0026gt; 40\u0026#34;, \u0026#34;ff \u0026gt; 31\u0026#34;, \u0026#34;ie 11\u0026#34;], }), ], }, }, }; å¸¸ç”¨æ’ä»¶ï¼š\npostcss-pxtoremï¼šç”¨æ¥å°† px è½¬æ¢ä¸º rem å•ä½ï¼Œåœ¨é€‚é…ç§»åŠ¨ç«¯çš„åœºæ™¯ä¸‹å¾ˆå¸¸ç”¨\npostcss-preset-env:å¯ä»¥ç¼–å†™æœ€æ–°çš„ CSS è¯­æ³•ï¼Œä¸ç”¨æ‹…å¿ƒå…¼å®¹æ€§é—®é¢˜\næ’ä»¶ç«™ç‚¹ï¼šhttps://www.postcss.parts/\nCSS In JS å¯¹äº CSS In JS æ–¹æ¡ˆï¼Œåœ¨æ„å»ºä¾§æˆ‘ä»¬éœ€è¦è€ƒè™‘é€‰æ‹©å™¨å‘½åé—®é¢˜ã€DCEã€ä»£ç å‹ç¼©ã€ç”Ÿæˆ SourceMapã€SSR ç­‰é—®é¢˜ï¼Œè€Œ styled-components å’Œ emotion å·²ç»æä¾›äº†å¯¹åº”çš„ babel æ’ä»¶æ¥è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ Vite ä¸­è¦åšçš„å°±æ˜¯é›†æˆè¿™äº› babel æ’ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 // vite.config.ts import { defineConfig } from \u0026#39;vite\u0026#39; import react from \u0026#39;@vitejs/plugin-react\u0026#39; // https://vitejs.dev/config/ export default defineConfig({ plugins: [ react({ babel: { // åŠ å…¥ babel æ’ä»¶ // ä»¥ä¸‹æ’ä»¶åŒ…éƒ½éœ€è¦æå‰å®‰è£… // å½“ç„¶ï¼Œé€šè¿‡è¿™ä¸ªé…ç½®ä½ ä¹Ÿå¯ä»¥æ·»åŠ å…¶å®ƒçš„ Babel æ’ä»¶ plugins: [ // é€‚é… styled-component \u0026#34;babel-plugin-styled-components\u0026#34; // é€‚é… emotion \u0026#34;@emotion/babel-plugin\u0026#34; ] }, // æ³¨æ„: å¯¹äº emotionï¼Œéœ€è¦å•ç‹¬åŠ ä¸Šè¿™ä¸ªé…ç½® // é€šè¿‡ `@emotion/react` åŒ…ç¼–è¯‘ emotion ä¸­çš„ç‰¹æ®Š jsx è¯­æ³• jsxImportSource: \u0026#34;@emotion/react\u0026#34; }) ] }) åŸå­åŒ– CSS æ¥å…¥ Unocss\nVite ä¸è‡ªåŠ¨åŒ–ä»£ç è§„èŒƒå·¥å…· ESLint pnpm i eslint -D\nnpx eslint --init\nESLint ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆ.eslintrc.js é…ç½®æ–‡ä»¶ã€‚æˆ‘ä»¬é€‰æ‹©ä¸ç›´æ¥ä½¿ç”¨ npm å®‰è£…ä¾èµ–ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±æ‰‹åŠ¨å®‰è£…:\npnpm i eslint-plugin-react@latest -D\npnpm i @typescript-eslint/eslint-plugin@latest -D\npnpm i @typescript-eslint/parser@latest -D\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 // .eslintrc.js module.exports = { //æœ‰äº›å…¨å±€å˜é‡æ˜¯ä¸šåŠ¡ä»£ç å¼•å…¥çš„ç¬¬ä¸‰æ–¹åº“æ‰€å£°æ˜ï¼Œè¿™é‡Œå°±éœ€è¦åœ¨globalsé…ç½®ä¸­å£°æ˜å…¨å±€å˜é‡ /* * \u0026#34;writable\u0026#34;æˆ–è€… trueï¼Œè¡¨ç¤ºå˜é‡å¯é‡å†™ï¼› * \u0026#34;readonly\u0026#34;æˆ–è€…falseï¼Œè¡¨ç¤ºå˜é‡ä¸å¯é‡å†™ï¼› * \u0026#34;off\u0026#34;ï¼Œè¡¨ç¤ºç¦ç”¨è¯¥å…¨å±€å˜é‡ã€‚ */ globals: { // ä¸å¯é‡å†™ $: false, jQuery: false } //æŒ‡å®šä¸Šè¿°çš„ env é…ç½®åä¾¿ä¼šå¯ç”¨æµè§ˆå™¨å’Œ ES2021 ç¯å¢ƒï¼Œ //åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ï¼Œé¢„å®šä¹‰äº†å…¨å±€å˜é‡windowã€documentç­‰ï¼Œè€Œåœ¨ES2021ç¯å¢ƒä¸‹ï¼Œé¢„å®šä¹‰äº†å…¨å±€å˜é‡Promiseã€Mapã€‚ä¼šåŒæ—¶å¯ç”¨ env: { browser: true, es2021: true, }, extends: [ //ä» ESLint æœ¬èº«ç»§æ‰¿ï¼› \u0026#34;eslint:recommended\u0026#34;, //ä»ç±»ä¼¼ eslint-config-xxx çš„ npm åŒ…ç»§æ‰¿ï¼› \u0026#34;standard\u0026#34; //ä» ESLint æ’ä»¶ç»§æ‰¿ //æ ¼å¼ä¸€èˆ¬ä¸º: `plugin:${pluginName}/${configName}` //ä½¿ç”¨extends çš„é…ç½®ï¼ŒESLint æ’ä»¶ä¸­çš„ç¹å¤šé…ç½®ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ä¸€ä¸€æ‰‹åŠ¨å¼€å¯äº† \u0026#34;plugin:react/recommended\u0026#34;, \u0026#34;plugin:@typescript-eslint/recommended\u0026#34;, ], overrides: [], //ESLint åº•å±‚é»˜è®¤ä½¿ç”¨ Espreeæ¥è¿›è¡Œ AST è§£æ,ä½†è¿˜æ˜¯ä¸æ”¯æŒ TS ï¼Œå› æ­¤éœ€è¦å¼•å…¥å…¶ä»–çš„è§£æå™¨å®Œæˆ TS çš„è§£æã€‚ //ç¤¾åŒºæä¾›äº†@typescript-eslint/parserè¿™ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå°† TS ä»£ç è½¬æ¢ä¸º Espree èƒ½å¤Ÿè¯†åˆ«çš„æ ¼å¼(å³ Estree æ ¼å¼)ï¼Œç„¶ååœ¨ Eslint ä¸‹é€šè¿‡Espreeè¿›è¡Œæ ¼å¼æ£€æŸ¥ï¼Œ ä»¥æ­¤å…¼å®¹äº† TS è¯­æ³•ã€‚ parser: \u0026#34;@typescript-eslint/parser\u0026#34;, parserOptions: { ecmaVersion: \u0026#34;latest\u0026#34;, sourceType: \u0026#34;module\u0026#34;, // ecmaFeatures: ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºæƒ³ä½¿ç”¨çš„é¢å¤–è¯­è¨€ç‰¹æ€§ï¼Œå¦‚å¼€å¯ jsx }, //é€šè¿‡pluginsæ‰©å±•ç‰¹å®šçš„ä»£ç è§„åˆ™ plugins: [\u0026#34;react\u0026#34;, \u0026#34;@typescript-eslint\u0026#34;], rules: { // https://zh-hans.eslint.org/docs/latest/use/configure/rules indent: [\u0026#34;error\u0026#34;, 4], \u0026#34;linebreak-style\u0026#34;: [\u0026#34;error\u0026#34;, \u0026#34;unix\u0026#34;], quotes: [\u0026#34;error\u0026#34;, \u0026#34;double\u0026#34;], semi: [\u0026#34;error\u0026#34;, \u0026#34;always\u0026#34;], }, }; Prettier pnpm i prettier -D\nåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œtouch .prettierrc.js \u0026amp;\u0026amp; code .prettierrc.js\n1 2 3 4 5 6 7 8 9 10 // .prettierrc.js module.exports = { printWidth: 80, //ä¸€è¡Œçš„å­—ç¬¦æ•°ï¼Œå¦‚æœè¶…è¿‡ä¼šè¿›è¡Œæ¢è¡Œï¼Œé»˜è®¤ä¸º80 tabWidth: 2, // ä¸€ä¸ª tab ä»£è¡¨å‡ ä¸ªç©ºæ ¼æ•°ï¼Œé»˜è®¤ä¸º 2 ä¸ª useTabs: false, //æ˜¯å¦ä½¿ç”¨ tab è¿›è¡Œç¼©è¿›ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºç”¨ç©ºæ ¼è¿›è¡Œç¼©è¿› singleQuote: true, // å­—ç¬¦ä¸²æ˜¯å¦ä½¿ç”¨å•å¼•å·ï¼Œé»˜è®¤ä¸º falseï¼Œä½¿ç”¨åŒå¼•å· semi: true, // è¡Œå°¾æ˜¯å¦ä½¿ç”¨åˆ†å·ï¼Œé»˜è®¤ä¸ºtrue trailingComma: \u0026#34;none\u0026#34;, // æ˜¯å¦ä½¿ç”¨å°¾é€—å· bracketSpacing: true, // å¯¹è±¡å¤§æ‹¬å·ç›´æ¥æ˜¯å¦æœ‰ç©ºæ ¼ï¼Œé»˜è®¤ä¸º trueï¼Œæ•ˆæœï¼š{ a: 1 } }; æ¥ä¸‹æ¥æˆ‘ä»¬å°† Prettier é›†æˆåˆ°ç°æœ‰çš„ ESLint å·¥å…·ä¸­ï¼Œé¦–å…ˆå®‰è£…ä¸¤ä¸ªå·¥å…·åŒ…:\npnpm i eslint-config-prettier -D\npnpm i eslint-plugin-prettier -D\nå…¶ä¸­ eslint-config-prettier ç”¨æ¥è¦†ç›– ESLint æœ¬èº«çš„è§„åˆ™é…ç½®ï¼Œè€Œ eslint-plugin-prettier åˆ™æ˜¯ç”¨äºè®© Prettier æ¥æ¥ç®¡ eslint --fix å³ä¿®å¤ä»£ç çš„èƒ½åŠ›ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // .eslintrc.js module.exports = { ... extends: [ ... // 1. æ¥å…¥ prettier çš„è§„åˆ™ + \u0026#34;prettier\u0026#34;, + \u0026#34;plugin:prettier/recommended\u0026#34; ], // 2. åŠ å…¥ prettier çš„ eslint æ’ä»¶ + plugins: [\u0026#34;react\u0026#34;, \u0026#34;@typescript-eslint\u0026#34;, \u0026#34;prettier\u0026#34;], rules: { // 3. æ³¨æ„è¦åŠ ä¸Šè¿™ä¸€å¥ï¼Œå¼€å¯ prettier è‡ªåŠ¨ä¿®å¤çš„åŠŸèƒ½ + \u0026#34;prettier/prettier\u0026#34;: \u0026#34;error\u0026#34;, } }; VSCode ä¸­å®‰è£… ESLint å’Œ Prettier è¿™ä¸¤ä¸ªæ’ä»¶ï¼Œå¹¶ä¸”åœ¨è®¾ç½®åŒºä¸­å¼€å¯ Format On Save, æ¥ä¸‹æ¥åœ¨ä½ ä¿å­˜ä»£ç çš„æ—¶å€™ Prettier ä¾¿ä¼šè‡ªåŠ¨å¸®å¿™ä¿®å¤ä»£ç æ ¼å¼ã€‚\næ ·å¼è§„èŒƒå·¥å…·: Stylelint pnpm i stylelint stylelint-prettier -D\npnpm i stylelint-config-prettier -D\npnpm i stylelint-config-recess-order -D\npnpm i stylelint-config-standard -D\npnpm i stylelint-config-standard-scss -D\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // .stylelintrc.js module.exports = { // æ³¨å†Œ stylelint çš„ prettier æ’ä»¶ plugins: [\u0026#34;stylelint-prettier\u0026#34;], // ç»§æ‰¿ä¸€ç³»åˆ—è§„åˆ™é›†åˆ extends: [ // standard è§„åˆ™é›†åˆ \u0026#34;stylelint-config-standard\u0026#34;, // standard è§„åˆ™é›†åˆçš„ scss ç‰ˆæœ¬ \u0026#34;stylelint-config-standard-scss\u0026#34;, // æ ·å¼å±æ€§é¡ºåºè§„åˆ™ \u0026#34;stylelint-config-recess-order\u0026#34;, // æ¥å…¥ Prettier è§„åˆ™ \u0026#34;stylelint-config-prettier\u0026#34;, \u0026#34;stylelint-prettier/recommended\u0026#34;, ], // é…ç½® rules rules: { // å¼€å¯ Prettier è‡ªåŠ¨æ ¼å¼åŒ–åŠŸèƒ½ \u0026#34;prettier/prettier\u0026#34;: true, }, }; Husky + lint-staged çš„ Git æäº¤å·¥ä½œæµé›†æˆ å®‰è£…ä¾èµ–ï¼š pnpm i husky -D\nåˆå§‹åŒ– Huskyï¼š npx husky install æ³¨å†Œ Husky çš„ pre-commit é’©å­ï¼š npx husky add .husky/pre-commit \u0026quot;npm run lint\u0026quot; åœ¨ package.json æ³¨å†Œ prepare å‘½ä»¤ï¼š\n1 2 3 { \u0026#34;prepare\u0026#34;: \u0026#34;husky install\u0026#34; } æ¥å…¥ commitlint è¿›è¡Œ commit ä¿¡æ¯çš„æ£€æŸ¥ï¼Œå®‰è£…ä¾èµ–ï¼š pnpm i commitlint @commitlint/cli @commitlint/config-conventional -D\ncommitlint é…ç½®:\n1 2 3 echo \u0026#34;module.exports = { extends: [\u0026#39;@commitlint/config-conventional\u0026#39;] }\u0026#34; \u0026gt; .commitlintrc.cjs å¢åŠ  Husky çš„ commit-msg é’©å­ï¼šnpx husky add .husky/commit-msg \u0026quot;npx --no-install commitlint --edit \\\u0026quot;$1\\\u0026quot;\u0026quot;\nç°åœ¨æ˜¯å…¨é‡çš„è¿›è¡Œä»£ç è§„èŒƒæ£€æŸ¥çš„ï¼Œå®é™…ä¸Šè¿™æ˜¯æ²¡å¿…è¦çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ–°å¢çš„æ–‡ä»¶å†…å®¹è¿›è¡Œæ£€æŸ¥å³å¯ã€‚è¿™å°±éœ€è¦ä½¿ç”¨åˆ°å¦å¤–ä¸€ä¸ªå·¥å…·: lint-staged äº†ã€‚å®‰è£…ä¾èµ–:\npnpm i lint-staged -D package.json ä¸­æ–°å¢ä¸€äº›å†…å®¹:\n1 2 3 4 5 { \u0026#34;lint-staged\u0026#34;: { \u0026#34;**/*.{js,jsx,tsx,ts}\u0026#34;: [\u0026#34;eslint --fix\u0026#34;] } } åœ¨.husky/pre-commit è„šæœ¬ä¸­ï¼Œä¿®æ”¹ä¸€ä¸‹å…¶ä¸­çš„å†…å®¹ï¼š\n1 2 3 4 #!/usr/bin/env sh . \u0026#34;$(dirname -- \u0026#34;$0\u0026#34;)/_/husky.sh\u0026#34; npx --no -- lint-staged ç°åœ¨å°±å¯ä»¥åœ¨ git commit çš„è¿‡ç¨‹ä¸­å®ç°å±€éƒ¨çš„ä»£ç é£æ ¼æ£€æŸ¥äº†ã€‚\n","permalink":"https://zzydev.top/posts/frontendengineering/vite%E5%88%9D%E6%8E%A2/","summary":"å¤§æ¦‚æ˜¯ä¸€ä»½ä¸å®Œæ•´çš„ Vite å¤‡å¿˜å½• no-bundle æ˜¯ä»€ä¹ˆ no-bundle ç†å¿µï¼šåˆ©ç”¨æµè§ˆå™¨åŸç”Ÿ ES æ¨¡å—çš„æ”¯æŒï¼Œå®ç°å¼€å‘é˜¶æ®µçš„ Dev Serverï¼Œè¿›è¡Œæ¨¡å—çš„æŒ‰éœ€åŠ è½½ï¼Œè€Œä¸æ˜¯å…ˆæ•´ä½“æ‰“åŒ…å†è¿›","title":"Viteåˆæ¢"},{"content":"npm å®‰è£…æœºåˆ¶ npm å®‰è£…æµç¨‹ npm é…ç½®çš„ä¼˜å…ˆçº§ å‘½ä»¤è¡Œè®¾ç½® npm é…ç½® \u0026gt; env ç¯å¢ƒå˜é‡è®¾ç½® npm é…ç½® \u0026gt; é¡¹ç›®çº§çš„ .npmrc æ–‡ä»¶ \u0026gt; ç”¨æˆ·çº§çš„ .npmrc æ–‡ä»¶\u0026gt; å…¨å±€çº§çš„ .npmrc æ–‡ä»¶ \u0026gt; npm å†…ç½®çš„ .npmrc æ–‡ä»¶\nä¸åŒç‰ˆæœ¬ç”Ÿæˆä¾èµ–æ ‘çš„åŒºåˆ« åœ¨ npm 2.X æ—¶æœŸï¼Œè¿˜æ˜¯ä½¿ç”¨çš„æœ€ç®€å•çš„å¾ªç¯éå†æ–¹å¼ï¼Œé€’å½’åœ°ä¸‹è½½æ‰€æœ‰çš„ä¾èµ–åŒ…ï¼Œåªè¦æœ‰ç”¨åˆ°çš„ä¾èµ–ï¼Œéƒ½è¿›è¡Œå®‰è£…ã€‚ npm 2.xæ—¶æœŸ åœ¨ npm3.X æ—¶æœŸï¼Œå°†åŸæœ‰çš„å¾ªç¯éå†çš„æ–¹å¼æ”¹æˆäº†æ›´ä¸ºæ‰å¹³çš„å±‚çº§ç»“æ„ï¼Œå°†ä¾èµ–è¿›è¡Œå¹³é“º åœ¨ç”Ÿæˆä¾èµ–æ ‘çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šéå†æ‰€æœ‰çš„ä¾èµ–å¹¶å°†å…¶æ”¾å…¥æ ‘çš„ç¬¬ä¸€å±‚èŠ‚ç‚¹ï¼Œç„¶åå†ç»§ç»­éå†æ¯ä¸€ä¸ªä¾èµ–ã€‚å½“æœ‰é‡å¤çš„æ¨¡å—æ—¶ï¼Œå¦‚æœä¾èµ–ç‰ˆæœ¬ç›¸åŒï¼Œå°±ä¸¢å¼ƒä¸æ”¾å…¥ä¾èµ–æ ‘ä¸­ã€‚å¦‚æœä¾èµ–ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆå°±å°†å…¶æ”¾åœ¨è¯¥ä¾èµ–ä¸‹ã€‚\næ¯”å¦‚ï¼Œç°åœ¨é¡¹ç›®æœ‰ Aã€Bã€C ä¸‰ä¸ªä¾èµ–ï¼ŒA å’Œ B éƒ½ä¾èµ– D(v 0.0.1)ï¼ŒC ä¾èµ– D (v 0.0.2)ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ç”Ÿæˆçš„ä¾èµ–æ ‘ä¼šå› ä¸ºä¾èµ–çš„å…ˆåé¡ºåºä¸åŒè€Œä¸åŒçš„æƒ…å†µã€‚ npm3.xæ—¶æœŸ æƒ…å†µä¸€ Aã€B çš„é¡ºåºåœ¨æœ€å‰é¢ npm3.xæ—¶æœŸ æƒ…å†µäºŒ C çš„é¡ºåºåœ¨æœ€å‰é¢ åœ¨ npm 5.X æ—¶æœŸï¼Œæ–°å¢äº†package-lock.jsoné”æ–‡ä»¶\nåœ¨å®‰è£…ä¾èµ–æµç¨‹ä¸­çš„æœ€åä¸€æ­¥ï¼Œä¼šç”Ÿæˆ package-lock.json æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å­˜å‚¨çš„æ˜¯ç¡®å®šçš„ä¾èµ–ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ lock æ–‡ä»¶ç›¸åŒï¼Œé‚£ä¹ˆæ¯æ¬¡å®‰è£…ä¾èµ–ç”Ÿæˆçš„ node_module å°±ä¼šæ˜¯ç›¸åŒçš„ã€‚ package-lock.json åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ package-lock.json è¿˜å¯ä»¥å‡å°‘å®‰è£…æ—¶é—´ã€‚å› ä¸ºåœ¨ package-lock.json é”æ–‡ä»¶ä¸­å·²ç»å­˜æ”¾äº†æ¯ä¸ªåŒ…å…·ä½“çš„ç‰ˆæœ¬ä¿¡æ¯å’Œä¸‹è½½é“¾æ¥ï¼Œè¿™å°±ä¸éœ€è¦å†å»è¿œç¨‹ä»“åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œä¼˜å…ˆä¼šä½¿ç”¨ç¼“å­˜å†…å®¹ä»è€Œå‡å°‘äº†å¤§é‡çš„ç½‘ç»œè¯·æ±‚ï¼Œå¹¶ä¸”å¯¹äºå¼±ç½‘ç¯å¢ƒå’Œç¦»çº¿ç¯å¢ƒæ›´åŠ å‹å¥½ã€‚\nnpm çš„ç¼“å­˜æœºåˆ¶ æ‰§è¡Œ npm config get cache å¾—åˆ°é…ç½®ç¼“å­˜æ–‡ä»¶çš„è·¯å¾„ï¼š${user.home}.npm/_cacache\n_cacache ä¸‹æœ‰content-v2 å’Œ index-v5ä¸¤ä¸ªæ–‡ä»¶å¤¹\ncontent-v2 æ–‡ä»¶æ˜¯ç”¨æ¥å­˜åœ¨ç¼“å­˜åŒ…çš„å…·ä½“å†…å®¹ï¼Œindex-v5 æ˜¯ç”¨æ¥å­˜å‚¨ä¾èµ–åŒ…çš„ç´¢å¼•ï¼Œæ ¹æ® index-v5 ä¸­çš„ç´¢å¼•å» content-v2 ä¸­æŸ¥æ‰¾å…·ä½“çš„æºæ–‡ä»¶ npm åœ¨å®‰è£…ä¾èµ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæ ¹æ® lock æ–‡ä»¶ä¸­å…·ä½“çš„åŒ…ä¿¡æ¯ï¼Œç”¨ pacote:range-manifest:{url}:{integrity} è§„åˆ™ç”Ÿæˆå‡ºå”¯ä¸€çš„ keyï¼Œç„¶åç”¨è¿™ä¸ª key é€šè¿‡ SHA256 åŠ å¯†ç®—æ³•å¾—åˆ°ä¸€ä¸ª hashã€‚è¿™ä¸ª hash å¯¹åº”çš„å°±æ˜¯ _cacache/index-v5 ä¸­çš„æ–‡ä»¶è·¯å¾„ï¼Œå‰ 4 ä½ hash ç”¨æ¥åŒºåˆ†è·¯å¾„ï¼Œå‰©ä¸‹çš„å‡ ä½å°±æ˜¯å…·ä½“çš„æ–‡ä»¶åã€‚æ–‡ä»¶çš„å†…å®¹å°±æ˜¯è¯¥ç¼“å­˜çš„å…·ä½“ä¿¡æ¯äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 //åœ¨é¡¹ç›®ä¸­æ‰§è¡Œnpm install loadsh //åœ¨package-lock.json æ–‡ä»¶ä¸­çœ‹åˆ° dependencies å­—æ®µä¸­æ–°å¢äº†ä¸€é¡¹ key ä¸º lodash çš„å­—æ®µï¼š \u0026#34;lodash\u0026#34;: { \u0026#34;version\u0026#34;: \u0026#34;4.17.21\u0026#34;, \u0026#34;resolved\u0026#34;: \u0026#34;https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz\u0026#34;, \u0026#34;integrity\u0026#34;: \u0026#34;sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\u0026#34; } 1 2 3 4 5 6 7 8 9 10 //ä½¿ç”¨nodeæ‰§è¡Œ const crypto = require(\u0026#34;crypto\u0026#34;); crypto .createHash(\u0026#34;sha256\u0026#34;) .update( \u0026#34;pacote:range-manifest:https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz:sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\u0026#34;, \u0026#34;utf8\u0026#34; ) .digest(\u0026#34;hex\u0026#34;); //å¯ä»¥å¾—åˆ°ä¸€ä¸ªhashå€¼ä¸º: \u0026#39;7abb86ab5b46e978761b5965d2199f4ae35871985573b8879dd786d71df7a825\u0026#39; åœ¨ shell ä¸­æ‰§è¡Œ cd ~/.npm/\\_cacache/index-v5/7a/bb \u0026amp;\u0026amp; ls\næˆ‘ä»¬ä¼šçœ‹åˆ° 86ab5b46e978761b5965d2199f4ae35871985573b8879dd786d71df7a82è¿™ä¸ªæ–‡ä»¶ æ‰§è¡Œ cat 86ab5b46e978761b5965d2199f4ae35871985573b8879dd786d71df7a82\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 { \u0026#34;key\u0026#34;:\u0026#34;pacote:range-manifest:https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz:sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\u0026#34;, \u0026#34;integrity\u0026#34;:\u0026#34;sha512-C2EkHXwXvLsbrucJTRS3xFHv7Mf/y9klmKDxPTE8yevCoH5h8Ae69Y+/lP+ahpW91crnzgO78elOk2E6APJfIQ==\u0026#34;, \u0026#34;time\u0026#34;:1630917070855, \u0026#34;size\u0026#34;:1, \u0026#34;metadata\u0026#34;:{ \u0026#34;id\u0026#34;:\u0026#34;lodash@4.17.21\u0026#34;, \u0026#34;manifest\u0026#34;:{ \u0026#34;name\u0026#34;:\u0026#34;lodash\u0026#34;, \u0026#34;version\u0026#34;:\u0026#34;4.17.21\u0026#34;, \u0026#34;dependencies\u0026#34;:{}, \u0026#34;optionalDependencies\u0026#34;:{}, \u0026#34;peerDependenciesMeta\u0026#34;:{}, \u0026#34;devDependencies\u0026#34;:{}, \u0026#34;bundleDependencies\u0026#34;:false, \u0026#34;peerDependencies\u0026#34;:{}, \u0026#34;deprecated\u0026#34;:false, \u0026#34;_resolved\u0026#34;:\u0026#34;https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz\u0026#34;, \u0026#34;_integrity\u0026#34;:\u0026#34;sha512-v2kDEe57lecTulaDIuNTPy3Ry4gLGJ6Z1O3vE1krgXZNrsQ+LFTGHVxVjcXPs17LhbZVGedAJv8XZ1tvj5FvSg==\u0026#34;, \u0026#34;_shasum\u0026#34;:\u0026#34;679591c564c3bffaae8454cf0b3df370c3d6911c\u0026#34;, \u0026#34;_shrinkwrap\u0026#34;:null, \u0026#34;_id\u0026#34;:\u0026#34;lodash@4.17.21\u0026#34; }, \u0026#34;type\u0026#34;:\u0026#34;finalized-manifest\u0026#34; } } è¿™ä¸€æ­¥ä¸­_shasum åˆå……å½“äº†æºæ–‡ä»¶åŒ…ç´¢å¼•çš„ä½œç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ª _shasum å» _cache/content-v2 ä¸­æ‰¾ä¸€ä¸‹å¯¹åº”çš„æ–‡ä»¶ã€‚\næ‰§è¡Œfile content-v2/sha1/67/95/91c564c3bffaae8454cf0b3df370c3d6911c æŒ‡ä»¤\nå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ª gzip æ–‡ä»¶ã€‚ç„¶åæˆ‘ä»¬è§£å‹çœ‹ä¸‹é‡Œé¢çš„å†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°è¿™å°±æ˜¯æˆ‘ä»¬åˆšåˆšä¸‹è½½çš„ lodash çš„æºç ï¼\nnpm çš„ç¼“å­˜æœºåˆ¶æ€»ç»“ï¼š\nåœ¨å®‰è£…èµ„æºçš„æ—¶å€™ï¼Œnpm ä¼šæ ¹æ® lock ä¸­çš„ integrityã€versionã€name ä¿¡æ¯ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ keyã€‚\nç„¶åç”¨è¿™ä¸ª key ç»è¿‡ SHA256 ç®—æ³•ç”Ÿæˆä¸€ä¸ª hashï¼Œæ ¹æ®è¿™ä¸ª hash åœ¨ index-v5 ä¸­æ‰¾åˆ°å¯¹åº”çš„ç¼“å­˜æ–‡ä»¶ï¼Œè¯¥ç¼“å­˜æ–‡ä»¶ä¸­è®°å½•ç€è¯¥åŒ…çš„ä¿¡æ¯ã€‚\næ ¹æ®è¯¥æ–‡ä»¶ä¸­çš„ä¿¡æ¯æˆ‘ä»¬åœ¨ content-v2 ä¸­å»æ‰¾å¯¹åº”çš„å‹ç¼©åŒ…ï¼Œè¿™æ ·å°±æ‰¾åˆ°äº†å¯¹åº”çš„ç¼“å­˜èµ„æºäº†ã€‚\næœ€åå†å°†è¯¥å‹ç¼©åŒ…è§£å‹åˆ° node_modules ä¸­\nyarn çš„å®‰è£…æœºåˆ¶ yarnçš„å®‰è£…æµç¨‹å›¾ æ£€æµ‹åŒ… è¿™ä¸€æ­¥ä¸»è¦æ˜¯æ£€æµ‹é¡¹ç›®ä¸­æ˜¯å¦å­˜åœ¨ä¸€äº› npm ç›¸å…³æ–‡ä»¶ï¼Œæ¯”å¦‚ package-lock.json ç­‰ã€‚å¦‚æœæœ‰ï¼Œä¼šæç¤ºç”¨æˆ·æ³¨æ„ï¼šè¿™äº›æ–‡ä»¶çš„å­˜åœ¨å¯èƒ½ä¼šå¯¼è‡´å†²çªã€‚åœ¨è¿™ä¸€æ­¥éª¤ä¸­ï¼Œä¹Ÿä¼šæ£€æŸ¥ç³»ç»Ÿ OSã€CPU ç­‰ä¿¡æ¯ã€‚ è§£æåŒ… è¿™ä¸€æ­¥ä¼šè§£æä¾èµ–æ ‘ä¸­æ¯ä¸€ä¸ªåŒ…çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚\né¦–å…ˆè·å–å½“å‰é¡¹ç›®ä¸­ package.json å®šä¹‰çš„ dependenciesã€devDependenciesã€optionalDependencies çš„å†…å®¹ï¼Œè¿™å±äºé¦–å±‚ä¾èµ–ã€‚\næ¥ç€é‡‡ç”¨éå†é¦–å±‚ä¾èµ–çš„æ–¹å¼è·å–ä¾èµ–åŒ…çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä»¥åŠé€’å½’æŸ¥æ‰¾æ¯ä¸ªä¾èµ–ä¸‹åµŒå¥—ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°†è§£æè¿‡å’Œæ­£åœ¨è§£æçš„åŒ…ç”¨ä¸€ä¸ª Set æ•°æ®ç»“æ„æ¥å­˜å‚¨ï¼Œè¿™æ ·å°±èƒ½ä¿è¯åŒä¸€ä¸ªç‰ˆæœ¬èŒƒå›´å†…çš„åŒ…ä¸ä¼šè¢«é‡å¤è§£æã€‚ å¯¹äºæ²¡æœ‰è§£æè¿‡çš„åŒ… Aï¼Œé¦–æ¬¡å°è¯•ä» yarn.lock ä¸­è·å–åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶æ ‡è®°ä¸ºå·²è§£æï¼› å¦‚æœåœ¨ yarn.lock ä¸­æ²¡æœ‰æ‰¾åˆ°åŒ… Aï¼Œåˆ™å‘ Registry å‘èµ·è¯·æ±‚è·å–æ»¡è¶³ç‰ˆæœ¬èŒƒå›´çš„å·²çŸ¥æœ€é«˜ç‰ˆæœ¬çš„åŒ…ä¿¡æ¯ï¼Œè·å–åå°†å½“å‰åŒ…æ ‡è®°ä¸ºå·²è§£æã€‚ npm çš„ç›¸å…³çŸ¥è¯† è‡ªå®šä¹‰ npm init npm init å‘½ä»¤åŸç†ï¼šè°ƒç”¨ shell è„šæœ¬è¾“å‡ºä¸€ä¸ªåˆå§‹åŒ–çš„ package.json æ–‡ä»¶\nå†™ä¸€ä¸ª node è„šæœ¬ï¼Œå®ƒçš„ module.exports å³ä¸º package.json é…ç½®å†…å®¹\nè®¾ç½® npm init çš„è„šæœ¬ npm config set init-module ${nodeè„šæœ¬}\nnpx çš„ä½œç”¨ åœ¨è¿è¡Œå‘½ä»¤æ—¶ï¼Œnpx å¯ä»¥è‡ªåŠ¨å» node_modules/.bin è·¯å¾„å’Œç¯å¢ƒå˜é‡ $PATH é‡Œé¢æ£€æŸ¥å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œè€Œä¸éœ€è¦å†åœ¨ package.json ä¸­å®šä¹‰ç›¸å…³çš„ scriptã€‚ npx æ‰§è¡Œæ¨¡å—æ—¶ä¼šä¼˜å…ˆå®‰è£…ä¾èµ–ï¼Œä½†æ˜¯åœ¨å®‰è£…æ‰§è¡Œåä¾¿åˆ é™¤æ­¤ä¾èµ–ï¼Œè¿™å°±é¿å…äº†å…¨å±€å®‰è£…æ¨¡å—å¸¦æ¥çš„é—®é¢˜ã€‚ åˆ©ç”¨ npm linkï¼Œé«˜æ•ˆç‡åœ¨æœ¬åœ°è°ƒè¯•ä»¥éªŒè¯åŒ…çš„å¯ç”¨æ€§ ä¸ºç›®æ ‡ npm æ¨¡å—ï¼ˆnpm-package-1ï¼‰åˆ›å»ºè½¯é“¾æ¥ï¼Œå°†å…¶é“¾æ¥åˆ°å…¨å±€ node æ¨¡å—å®‰è£…è·¯å¾„ /usr/local/lib/node_modules/ ä¸­ï¼› ä¸ºç›®æ ‡ npm æ¨¡å—ï¼ˆnpm-package-1ï¼‰çš„å¯æ‰§è¡Œ bin æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥ï¼Œå°†å…¶é“¾æ¥åˆ°å…¨å±€ node å‘½ä»¤å®‰è£…è·¯å¾„ /usr/local/bin/ ä¸­ã€‚ å¹¶/ä¸²è¡Œè¿è¡Œå¤šä¸ªå‘½ä»¤çš„å·¥å…· npm-run-all\nç”¨æ³•ï¼šnpm-run-all \u0026ndash;serial task1 \u0026ndash;parallel task2 task3\nç»™ npm script ä¼ é€’å‚æ•° 1 2 \u0026#34;lint:js\u0026#34;: \u0026#34;eslint *.js\u0026#34;, \u0026#34;lint:js:fix\u0026#34;: \u0026#34;npm run lint:js -- --fix\u0026#34;, å½“æˆ‘ä»¬éœ€è¦å‘ npm è„šæœ¬ (å¦‚ lint:jsï¼‰ä¸­çš„å‘½ä»¤ä¼ é€’é€‰é¡¹å’Œå‚æ•°æ—¶ï¼Œæ‚¨éœ€è¦ä½¿ç”¨--åˆ†éš”ç¬¦å°†å…¶åˆ†ç¦»ï¼Œä»¥é¿å…å®ƒä»¬è¢«è§£é‡Šä¸º npm é€‰é¡¹æˆ–å‚æ•°ã€‚\n","permalink":"https://zzydev.top/posts/frontendengineering/%E9%87%8D%E5%AD%A6%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/","summary":"npm å®‰è£…æœºåˆ¶ npm å®‰è£…æµç¨‹ npm é…ç½®çš„ä¼˜å…ˆçº§ å‘½ä»¤è¡Œè®¾ç½® npm é…ç½® \u0026gt; env ç¯å¢ƒå˜é‡è®¾ç½® npm é…ç½® \u0026gt; é¡¹ç›®çº§çš„ .npmrc æ–‡ä»¶ \u0026gt; ç”¨æˆ·çº§çš„ .npmrc æ–‡ä»¶\u0026gt; å…¨å±€çº§çš„ .npmrc æ–‡ä»¶ \u0026gt; npm å†…ç½®çš„ .npmrc æ–‡","title":"é‡å­¦åŒ…ç®¡ç†å·¥å…·"},{"content":"// todo ç­‰å¾…é¢è¯•å®æˆ˜å®Œè¡¥ä¸Š\n","permalink":"https://zzydev.top/posts/eight-part-essay/%E6%95%85%E6%84%8F%E4%B8%8D%E5%B0%8F%E5%BF%83%E7%9A%84%E9%9D%A2%E8%AF%95%E9%A2%98_02/","summary":"// todo ç­‰å¾…é¢è¯•å®æˆ˜å®Œè¡¥ä¸Š","title":"æ•…æ„ä¸å°å¿ƒçš„é¢è¯•é¢˜_02"},{"content":"// todo ç­‰å¾…é¢è¯•å®æˆ˜å®Œè¡¥ä¸Š\n","permalink":"https://zzydev.top/posts/eight-part-essay/%E6%95%85%E6%84%8F%E4%B8%8D%E5%B0%8F%E5%BF%83%E7%9A%84%E9%9D%A2%E8%AF%95%E9%A2%98_01/","summary":"// todo ç­‰å¾…é¢è¯•å®æˆ˜å®Œè¡¥ä¸Š","title":"æ•…æ„ä¸å°å¿ƒçš„é¢è¯•é¢˜_01"},{"content":"å®ç°ä¸€ä¸ªå‰ç«¯è„šæ‰‹æ¶ todo ","permalink":"https://zzydev.top/posts/frontendengineering/%E8%84%9A%E6%89%8B%E6%9E%B6%E5%BC%80%E5%8F%91/","summary":"å®ç°ä¸€ä¸ªå‰ç«¯è„šæ‰‹æ¶ todo","title":"å‰ç«¯å·¥ç¨‹åŒ–"},{"content":"Jest çš„ç®€æ˜“åŸç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 function expect(result) { return { toBe: function (actual) { if (result !== actual) { throw new Error(`expected ${actual} but got ${result}`); } }, }; } function test(desc, fn) { try { fn(); console.log(`${desc} - passed`); } catch (e) { console.log(`${desc} - failed: ${e.message}`); } } Jest ä¸­çš„ç®€å•é…ç½® è¿è¡Œ npx jest --init åˆå§‹åŒ–é»˜è®¤é…ç½®:\næ˜¯å¦éœ€è¦å¼€å¯ typescript\næ˜¯å¦éœ€è¦ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š( æµ‹è¯•è¦†ç›–ç‡å°±æ˜¯æˆ‘ä»¬ç¼–å†™çš„æµ‹è¯•ä»£ç å¯¹åŸæ¥çš„åŠŸèƒ½ä»£ç çš„å æ¯”)\né€‰æ‹© node ç¯å¢ƒæˆ–è€…æµè§ˆå™¨ç¯å¢ƒ\nåœ¨æµ‹è¯•å®Œæˆä¹‹åï¼Œæ˜¯å¦éœ€è¦è¿›è¡Œä¸€äº›æ¸…é™¤å·¥ä½œ\næ›´å¤šé…ç½®\njest ä¸­å€ŸåŠ© babel ä½¿ç”¨ ESModule çš„æ‰§è¡Œæµç¨‹ï¼š\nnpm run jest\njest (babel-jest)\n@babel-core\nå–.babelrc é…ç½®\nåœ¨è¿è¡Œæµ‹è¯•ä¹‹å‰ï¼Œç»“åˆ babelï¼Œå…ˆå°†ä½ çš„ä»£ç è¿›è¡Œä¸€æ¬¡è½¬åŒ–\nè¿è¡Œè½¬æ¢åçš„æµ‹è¯•ç”¨ä¾‹ä»£ç \nJest ä¸­çš„åŒ¹é…å™¨ mathcers guide\nAPI æ›´å¤šçš„ mathcers\nJest å‘½ä»¤è¡Œå·¥å…·çš„ä½¿ç”¨ cli\njest --watch è¡¨ç¤ºç›‘å¬æ–‡ä»¶æ›´æ”¹ï¼Œå¹¶é‡æ–°è¿è¡Œä¸å·²æ›´æ”¹çš„æ–‡ä»¶ç›¸å…³çš„æµ‹è¯•ã€‚æ³¨æ„ï¼šåªæœ‰åœ¨ä½¿ç”¨ git ç‰ˆæœ¬æ§åˆ¶ä¸‹æ‰èƒ½ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚ ç›‘å¬æ¨¡å¼ä¸‹ï¼Œæ§åˆ¶å°ä¼šæä¾›å‡ ç§æ¨¡å¼é€‰æ‹©ï¼š\n--watch ä¸º o æ¨¡å¼\nå¼‚æ­¥ä»£ç çš„æµ‹è¯•æ–¹æ³• æµ‹è¯•å¼‚æ­¥ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 test(\u0026#34;fetchDataè¿”å›ç»“æœä¸º404\u0026#34;, () =\u0026gt; { /* âš ï¸å¦‚æœæœŸæœ›Promiseè¢«Rejectï¼Œåˆ™éœ€è¦ä½¿ç”¨ .catch æ–¹æ³•ã€‚ è¯·ç¡®ä¿æ·»åŠ  expect.assertions æ¥éªŒè¯ä¸€å®šæ•°é‡çš„æ–­è¨€è¢«è°ƒç”¨ã€‚ å¦‚æœæ²¡æœ‰ä½¿ç”¨ expect.assertions çš„è¯ï¼Œæˆ‘ä»¬åœ¨è¯·æ±‚è¿”å›ä¸ä¸º404æ—¶ä¸ä¼šè¢«catchåˆ°ï¼Œè¿è¡Œæµ‹è¯•é€šè¿‡ã€‚ ä½†æˆ‘ä»¬æ˜¯å¸Œæœ›å½“å‘ç”Ÿé”™è¯¯æ—¶è¢«catchåˆ°ï¼Œç„¶åæ‰§è¡Œexpectåˆ¤æ–­ï¼Œå½“é”™è¯¯æ˜¯404æ—¶ï¼Œæµ‹è¯•é€šè¿‡ã€‚ */ expect.assertions(1); // è¡¨ç¤ºä¸‹é¢expectå¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªè¢«æ‰§è¡Œ return fetchData().catch((e) =\u0026gt; expect(e.toString().indexOf(\u0026#34;404\u0026#34;) \u0026gt; -1).toBe(true) ); }); test(\u0026#34;fetchDataæµ‹è¯•è¿”å›ç»“æœä¸º{success: true}\u0026#34;, () =\u0026gt; { // toMatchObjectåŒ¹é…æ˜¯å¦åŒ…å«å¯¹è±¡ä¸€éƒ¨åˆ† return expect(fetchData()).resolves.toMatchObject({ data: { success: true }, }); }); Jest ä¸­çš„é’©å­å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 //ä½¿ç”¨describeåšåˆ†ç»„æµ‹è¯• //é»˜è®¤æœ€å¤–å±‚åŒ…ç€ä¸€å±‚describe describe(\u0026#34;æœ€é¡¶å±‚é»˜è®¤åˆ†ç»„\u0026#34;,()=\u0026gt; { describe(\u0026#34;åˆ†ç»„1\u0026#34;,()=\u0026gt; { beforeAll(()=\u0026gt; {}) afterAll(()=\u0026gt; {}) beforeEach(()=\u0026gt; {}) afterEach(()=\u0026gt; {}) // å•æ¬¡åªæ‰§è¡Œè¿™ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ test.only(\u0026#34;desc\u0026#34;, () =\u0026gt; {}) } describe(\u0026#34;åˆ†ç»„2\u0026#34;,()=\u0026gt; { ... } ... }) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 beforeAll(() =\u0026gt; console.log(\u0026#34;outer - beforeAll\u0026#34;)); afterAll(() =\u0026gt; console.log(\u0026#34;outer - afterAll\u0026#34;)); beforeEach(() =\u0026gt; console.log(\u0026#34;outer - beforeEach\u0026#34;)); afterEach(() =\u0026gt; console.log(\u0026#34;outer - afterEach\u0026#34;)); test(\u0026#34;Outer test\u0026#34;, () =\u0026gt; console.log(\u0026#34;outer - test\u0026#34;)); describe(\u0026#34;Scoped / Nested block\u0026#34;, () =\u0026gt; { beforeAll(() =\u0026gt; console.log(\u0026#34;inner - beforeAll\u0026#34;)); afterAll(() =\u0026gt; console.log(\u0026#34;inner - afterAll\u0026#34;)); beforeEach(() =\u0026gt; console.log(\u0026#34;inner - beforeEach\u0026#34;)); afterEach(() =\u0026gt; console.log(\u0026#34;inner - afterEach\u0026#34;)); test(\u0026#34;Inner test\u0026#34;, () =\u0026gt; console.log(\u0026#34;inner - test\u0026#34;)); }); Jest ä¸­çš„ Mock mock å¤§å¤šæ•°åœºæ™¯æ˜¯æˆ‘ä»¬å¹¶ä¸å…³å¿ƒå¾…æµ‹è¯•æ¨¡å—æ‰§è¡Œçš„ç»“æœï¼Œåªå…³å¿ƒæ¨¡å—èƒ½å¦è¢«æ­£å¸¸æ‰§è¡Œã€‚ mock functions\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 export function runCallBack(fn) { fn(); } export function createObject(classItem) { new classItem(\u0026#34;ä½ å¹²å˜›\u0026#34;); } test(\u0026#34;æµ‹è¯•runCallBack\u0026#34;, () =\u0026gt; { const func = jest.fn(); // mockå‡½æ•°ï¼Œæ•è·å‡½æ•°è°ƒç”¨å’Œè¿”å›ç»“æœï¼Œä»¥åŠthiså’Œè°ƒç”¨é¡ºåº func.mockReturnValue(\u0026#34;mockReturnValue\u0026#34;); // è®¾ç½®mockå‡½æ•°è¿”å›å€¼ runCallBack(func); runCallBack(func); expect(func).toHaveBeenCalledTimes(2); // æ£€æŸ¥å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨äº†ä¸¤æ¬¡ expect(func.mock.calls.length).toBe(2); console.log(func.mock); }); test(\u0026#34;æµ‹è¯•createObject\u0026#34;, () =\u0026gt; { const func = jest.fn((args) =\u0026gt; { return args + \u0026#34;,ä½ XX\u0026#34;; }); /* ç›¸å½“äº func.mockImplementation((args) =\u0026gt; { retrun args + \u0026#34;,ä½ XX\u0026#34; }) */ createObject(func); console.log(func.mock); }); 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 export const generateConfig = () =\u0026gt; { return { server: \u0026#34;http://localhost\u0026#34;, port: 1313, time: new Date(); }; }; test(\u0026#34;æµ‹è¯•generateConfig\u0026#34;, () =\u0026gt; { // ç¬¬ä¸€æ¬¡ä¼šç”Ÿæˆå¿«ç…§ï¼Œç¬¬äºŒæ¬¡ä¼šå°†å¿«ç…§ä¸æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ç»“æœè¿›è¡Œå¯¹æ¯” // å¦‚æœæœ‰å†²çªï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œåœ¨æç¤ºçš„æ¨¡å¼ä¸‹è§£å†³å†²çª expect(generateConfig()).toMatchSnapshot({ time: expect.any(Date),//å¿«ç…§ä¸å½“å‰æ‰§è¡Œç»“æœæ¯”å¯¹ï¼Œåªè¦å¿«ç…§timeå±æ€§çš„å€¼æ˜¯ä¸ªDateç±»å‹å°±å¯ä»¥ port: expect.any(Number), }); }) Jest mock æ·±å…¥å­¦ä¹  mock functions\njest object åœ¨ jest.config.js ä¸­è®¾ç½®ï¼Œå°±ä¸ç”¨æ‰‹åŠ¨å†™jest.mock('./demo')ï¼ŒJest ä¼šè‡ªåŠ¨å»__mocks__æ–‡ä»¶å¤¹ä¸‹æ‰¾demo.jsæ–‡ä»¶\n1 2 3 { automock: true; } mock timers 1 2 3 4 5 6 7 8 9 10 11 function timer(callback) { setTimeout(callback(), 3000); } //éœ€è¦ç­‰å¾…3ç§’æ‰æ‰§è¡Œ test(\u0026#34;timer æµ‹è¯•\u0026#34;, (done) =\u0026gt; { timer(() =\u0026gt; { expect(1).toBe(1); done(); }); }); 1 2 3 4 5 6 7 8 9 10 11 12 13 function timer(callback) { setTimeout(() =\u0026gt; { callback(); }, 3000); } jest.useFakeTimers(); test(\u0026#34;timer æµ‹è¯•\u0026#34;, () =\u0026gt; { const fn = jest.fn(); timer(fn); jest.advanceTimersByTime(3000); // å¿«è¿›3ç§’ expect(fn).toHaveBeenCalledTimes(1); // æ£€æŸ¥å‡½æ•°æ˜¯å¦è¢«è°ƒç”¨äº†ä¸€æ¬¡ }); é€šè¿‡å¯¹ç±»çš„ Mock ç†è§£å•å…ƒæµ‹è¯•ä¸é›†æˆæµ‹è¯• todo ","permalink":"https://zzydev.top/posts/frontendengineering/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/","summary":"Jest çš„ç®€æ˜“åŸç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 function expect(result) { return { toBe: function (actual) { if (result !== actual) { throw new Error(`expected ${actual} but got ${result}`); } }, }; } function test(desc, fn) { try { fn(); console.log(`${desc} - passed`); } catch (e) { console.log(`${desc} - failed: ${e.message}`); } } Jest","title":"Jestä¸å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•"},{"content":"//todo\n","permalink":"https://zzydev.top/posts/headfirstts/ts%E7%B1%BB%E5%9E%8B%E6%8C%91%E6%88%98extreme%E7%AF%87/","summary":"//todo","title":"TSç±»å‹æŒ‘æˆ˜Extremeç¯‡"},{"content":"//todo\n","permalink":"https://zzydev.top/posts/headfirstts/ts%E7%B1%BB%E5%9E%8B%E6%8C%91%E6%88%98hard%E7%AF%87/","summary":"//todo","title":"TSç±»å‹æŒ‘æˆ˜Hardç¯‡"},{"content":"node åŸºç¡€æ¦‚å¿µ todo ","permalink":"https://zzydev.top/posts/node_deno/node%E5%9F%BA%E7%A1%80/","summary":"node åŸºç¡€æ¦‚å¿µ todo","title":"NodeåŸºç¡€"},{"content":"ä»€ä¹ˆæ˜¯ Babel babel ğŸ  Babel is a compiler for writing next generation JavaScript. typescript babel æ˜¯ä»€ä¹ˆ\nbabel çš„ç¼–è¯‘æµç¨‹ \u0026nbsp;parse parse é˜¶æ®µçš„ç›®çš„æ˜¯æŠŠæºç å­—ç¬¦ä¸²è½¬æ¢æˆæœºå™¨èƒ½å¤Ÿç†è§£çš„æŠ½è±¡è¯­æ³•æ ‘(AST)ï¼Œè¿™ä¸ªè¿‡ç¨‹åˆ†ä¸ºè¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€‚\nlet name = 'zzydev' ç»è¿‡è¯æ³•åˆ†æå¾—åˆ° letã€ nameã€ =ã€ \u0026quot;zzydev\u0026quot;Token ä¸²ã€‚\nè¯æ³•åˆ†æçš„å·¥ä½œæ˜¯å°†ä¸€ä¸ªé•¿é•¿çš„å­—ç¬¦ä¸²è¯†åˆ«å‡ºä¸€ä¸ªä¸ªçš„å•è¯ï¼Œè¿™ä¸€ä¸ªä¸ªå•è¯å°±æ˜¯ Tokenã€‚ è¯»å– token ä¸²ï¼ŒæŠŠå®ƒè½¬åŒ–ä¸º ASTï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«è¯­æ³•åˆ†æã€‚\n\u0026nbsp;transform transform é˜¶æ®µæ˜¯å¯¹ parse ç”Ÿæˆçš„ AST çš„å¤„ç†ï¼Œä¼šè¿›è¡Œ AST çš„éå†ï¼Œéå†çš„è¿‡ç¨‹ä¸­å¤„ç†åˆ°ä¸åŒçš„ AST èŠ‚ç‚¹ä¼šè°ƒç”¨æ³¨å†Œçš„ç›¸åº”çš„ visitor å‡½æ•°ï¼Œvisitor å‡½æ•°é‡Œå¯ä»¥å¯¹ AST èŠ‚ç‚¹è¿›è¡Œå¢åˆ æ”¹ï¼Œè¿”å›æ–°çš„ ASTï¼ˆå¯ä»¥æŒ‡å®šæ˜¯å¦ç»§ç»­éå†æ–°ç”Ÿæˆçš„ ASTï¼‰ã€‚è¿™æ ·éå†å®Œä¸€é AST ä¹‹åå°±å®Œæˆäº†å¯¹ä»£ç çš„ä¿®æ”¹ã€‚\n\u0026nbsp;generate æŠŠè½¬æ¢åçš„ AST æ‰“å°æˆç›®æ ‡ä»£ç ï¼Œå¹¶ç”Ÿæˆ sourcemap\nsourcemap åŸç†\nBabel ä¸ AST Javascript AST éµå¾ª estree è§„èŒƒ\nBabel AST spec ä¸ estree spec å­˜åœ¨åå·®\nâ­ Babel AST è§„èŒƒ\nåœ¨çº¿ AST å¯è§†åŒ–å·¥å…·(ä¸€)\nåœ¨çº¿ AST å¯è§†åŒ–å·¥å…·(äºŒ)\nâ­ Babel ç±»å‹å®šä¹‰ åŠå…¶éƒ¨åˆ†æºç æˆªå–ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 //æ¯ç§ AST éƒ½æœ‰è‡ªå·±çš„å±æ€§ï¼Œä½†æ˜¯å®ƒä»¬ä¹Ÿæœ‰ä¸€äº›å…¬å…±å±æ€§ï¼Œå…¶ä»–AST Nodeé€šè¿‡ç»§æ‰¿BaseNodeæ¥è·å¾—å…¬å…±å±æ€§ interface BaseNode { type: Node[\u0026#34;type\u0026#34;]; //AST èŠ‚ç‚¹çš„ç±»å‹ leadingComments?: ReadonlyArray\u0026lt;Comment\u0026gt; | null; //å¼€å§‹çš„æ³¨é‡Š innerComments?: ReadonlyArray\u0026lt;Comment\u0026gt; | null; //ä¸­é—´çš„æ³¨é‡Š trailingComments?: ReadonlyArray\u0026lt;Comment\u0026gt; | null; //ç»“å°¾çš„æ³¨é‡Š start?: number | null; //æºç å­—ç¬¦ä¸²çš„å¼€å§‹ä¸‹æ ‡ end?: number | null; //æºç å­—ç¬¦ä¸²çš„ç»“æŸä¸‹æ ‡ loc?: SourceLocation | null; // å¼€å§‹å’Œç»“æŸçš„è¡Œåˆ— range?: [number, number]; // ç›¸å½“äº[start, end] extra?: Record\u0026lt;string, unknown\u0026gt;; //è®°å½•ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œç”¨äºå¤„ç†ä¸€äº›ç‰¹æ®Šæƒ…å†µã€‚æ¯”å¦‚ StringLiteral ä¿®æ”¹ value åªæ˜¯å€¼çš„ä¿®æ”¹ï¼Œè€Œä¿®æ”¹ extra.raw åˆ™å¯ä»¥è¿åŒå•åŒå¼•å·ä¸€èµ·ä¿®æ”¹ã€‚ } export interface SourceLocation { start: { line: number; column: number; }; end: { line: number; column: number; }; } interface BaseComment { value: string; start: number; end: number; loc: SourceLocation; type: \u0026#34;CommentBlock\u0026#34; | \u0026#34;CommentLine\u0026#34;; } export interface CommentBlock extends BaseComment { type: \u0026#34;CommentBlock\u0026#34;; } export interface CommentLine extends BaseComment { type: \u0026#34;CommentLine\u0026#34;; } export type Comment = CommentBlock | CommentLine; Babel çš„ API parse\n","permalink":"https://zzydev.top/posts/headfirstbabel/1_%E5%88%9D%E8%A7%81babel/","summary":"ä»€ä¹ˆæ˜¯ Babel babel ğŸ  Babel is a compiler for writing next generation JavaScript. typescript babel æ˜¯ä»€ä¹ˆ babel çš„ç¼–è¯‘æµç¨‹ \u0026nbsp;parse parse é˜¶æ®µçš„ç›®çš„æ˜¯æŠŠæºç å­—ç¬¦ä¸²è½¬æ¢æˆæœºå™¨èƒ½å¤Ÿç†è§£çš„æŠ½è±¡è¯­æ³•æ ‘(AST)ï¼Œè¿™ä¸ªè¿‡ç¨‹åˆ†ä¸ºè¯æ³•åˆ†","title":"1_åˆè§Babel"},{"content":"å‰ç½®çŸ¥è¯†ï¼šå•çº¿ç¨‹çš„ JavaScript ä¸å¤šçº¿ç¨‹çš„æµè§ˆå™¨ JavaScript çº¿ç¨‹å’Œæ¸²æŸ“çº¿ç¨‹å¿…é¡»æ˜¯äº’æ–¥çš„ï¼šè¿™ä¸¤ä¸ªçº¿ç¨‹ä¸èƒ½å¤Ÿç©¿æ’æ‰§è¡Œï¼Œå¿…é¡»ä¸²è¡Œã€‚å½“å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åªèƒ½æŒ‚èµ·ç­‰å¾…ã€‚\nåœ¨è¿™æ ·çš„æœºåˆ¶ä¸‹ï¼Œè‹¥ JavaScript çº¿ç¨‹é•¿æ—¶é—´åœ°å ç”¨äº†ä¸»çº¿ç¨‹ï¼Œé‚£ä¹ˆæ¸²æŸ“å±‚é¢çš„æ›´æ–°å°±ä¸å¾—ä¸é•¿æ—¶é—´åœ°ç­‰å¾…ï¼Œç•Œé¢é•¿æ—¶é—´ä¸æ›´æ–°ï¼Œå¸¦ç»™ç”¨æˆ·çš„ä½“éªŒå°±æ˜¯æ‰€è°“çš„â€œå¡é¡¿â€ã€‚ä¸€èˆ¬é¡µé¢å¡é¡¿çš„æ—¶å€™ï¼Œä½ ä¼šåšä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä¸ªäººçš„ä¹ æƒ¯æ˜¯æ›´åŠ é¢‘ç¹åœ°åœ¨é¡µé¢ä¸Šç‚¹æ¥ç‚¹å»ï¼ŒæœŸæœ›é¡µé¢èƒ½å¤Ÿç»™æˆ‘å“ªæ€•ä¸€ç‚¹ç‚¹çš„å“åº”ã€‚é—æ†¾çš„æ˜¯ï¼Œäº‹ä»¶çº¿ç¨‹ä¹Ÿåœ¨ç­‰å¾… JavaScriptï¼Œè¿™å°±å¯¼è‡´ä½ è§¦å‘çš„äº‹ä»¶ä¹Ÿå°†æ˜¯éš¾ä»¥è¢«å“åº”çš„ã€‚\nä¸ºä»€ä¹ˆä¼šäº§ç”Ÿâ€œå¡é¡¿â€è¿™æ ·çš„å›°å±€ï¼Ÿ Stack Reconciler éœ€è¦çš„ï¼ˆåŒæ­¥é€’å½’ï¼‰è°ƒå’Œæ—¶é—´å¾ˆé•¿ï¼Œè¿™å°±æ„å‘³ç€ JavaScript çº¿ç¨‹å°†é•¿æ—¶é—´åœ°å ç”¨ä¸»çº¿ç¨‹ï¼Œè¿›è€Œå¯¼è‡´æˆ‘ä»¬ä¸Šæ–‡ä¸­æ‰€æè¿°çš„æ¸²æŸ“å¡é¡¿/å¡æ­»ã€äº¤äº’é•¿æ—¶é—´æ— å“åº”ç­‰é—®é¢˜ã€‚\nè®¾è®¡æ€æƒ³ï¼šFiber æ˜¯å¦‚ä½•è§£å†³é—®é¢˜çš„ Fiber å°±æ˜¯æ¯”çº¿ç¨‹è¿˜è¦çº¤ç»†çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œçº¤ç¨‹â€ã€‚çº¤ç¨‹çš„å‡ºç°ï¼Œæ„åœ¨å¯¹æ¸²æŸ“è¿‡ç¨‹å®ç°æ›´åŠ ç²¾ç»†çš„æ§åˆ¶ã€‚\nä»æ¶æ„è§’åº¦ Fiber æ˜¯å¯¹ React æ ¸å¿ƒç®—æ³•ï¼ˆå³è°ƒå’Œè¿‡ç¨‹ï¼‰çš„é‡å†™ ä»ç¼–ç è§’åº¦ Fiber æ˜¯ React å†…éƒ¨æ‰€å®šä¹‰çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒæ˜¯ Fiber æ ‘ç»“æ„çš„èŠ‚ç‚¹å•ä½ï¼Œä¹Ÿå°±æ˜¯ React 16 æ–°æ¶æ„ä¸‹çš„â€œè™šæ‹Ÿ DOMâ€ ä»å·¥ä½œæµçš„è§’åº¦ Fiber èŠ‚ç‚¹ä¿å­˜äº†ç»„ä»¶éœ€è¦æ›´æ–°çš„çŠ¶æ€å’Œå‰¯ä½œç”¨ï¼Œä¸€ä¸ª Fiber åŒæ—¶ä¹Ÿå¯¹åº”ç€ä¸€ä¸ªå·¥ä½œå•å…ƒã€‚ Fiber æ¶æ„çš„åº”ç”¨ç›®çš„ï¼ŒæŒ‰ç…§ React å®˜æ–¹çš„è¯´æ³•ï¼Œæ˜¯å®ç°â€œå¢é‡æ¸²æŸ“â€ã€‚æ‰€è°“â€œå¢é‡æ¸²æŸ“â€ï¼Œé€šä¿—æ¥è¯´å°±æ˜¯æŠŠä¸€ä¸ªæ¸²æŸ“ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªæ¸²æŸ“ä»»åŠ¡ï¼Œè€Œåå°†å…¶åˆ†æ•£åˆ°å¤šä¸ªå¸§é‡Œé¢ã€‚ä¸è¿‡ä¸¥æ ¼æ¥è¯´ï¼Œå¢é‡æ¸²æŸ“å…¶å®ä¹Ÿåªæ˜¯ä¸€ç§æ‰‹æ®µï¼Œå®ç°å¢é‡æ¸²æŸ“çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†å®ç°ä»»åŠ¡çš„å¯ä¸­æ–­ã€å¯æ¢å¤ï¼Œå¹¶ç»™ä¸åŒçš„ä»»åŠ¡èµ‹äºˆä¸åŒçš„ä¼˜å…ˆçº§ï¼Œæœ€ç»ˆè¾¾æˆæ›´åŠ é¡ºæ»‘çš„ç”¨æˆ·ä½“éªŒã€‚\nFiber æ¶æ„æ ¸å¿ƒï¼šâ€œå¯ä¸­æ–­â€â€œå¯æ¢å¤â€ä¸â€œä¼˜å…ˆçº§â€ React15 æ¶æ„ React15 æ¶æ„å¯ä»¥åˆ†ä¸ºä¸¤å±‚ï¼š\nReconcilerï¼ˆåè°ƒå™¨ï¼‰â€”â€” è´Ÿè´£æ‰¾å‡ºå˜åŒ–çš„ç»„ä»¶ Rendererï¼ˆæ¸²æŸ“å™¨ï¼‰â€”â€” è´Ÿè´£å°†å˜åŒ–çš„ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸Š Reconciler åè°ƒå™¨ æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨Reactä¸­å¯ä»¥é€šè¿‡this.setStateã€this.forceUpdateã€ReactDOM.renderç­‰ API è§¦å‘æ›´æ–°ã€‚\næ¯å½“æœ‰æ›´æ–°å‘ç”Ÿæ—¶ï¼ŒReconcilerä¼šåšå¦‚ä¸‹å·¥ä½œï¼š\nè°ƒç”¨å‡½æ•°ç»„ä»¶ã€æˆ– class ç»„ä»¶çš„renderæ–¹æ³•ï¼Œå°†è¿”å›çš„ JSX è½¬åŒ–ä¸ºè™šæ‹Ÿ DOM å°†è™šæ‹Ÿ DOM å’Œä¸Šæ¬¡æ›´æ–°æ—¶çš„è™šæ‹Ÿ DOM å¯¹æ¯” é€šè¿‡å¯¹æ¯”æ‰¾å‡ºæœ¬æ¬¡æ›´æ–°ä¸­å˜åŒ–çš„è™šæ‹Ÿ DOM é€šçŸ¥Rendererå°†å˜åŒ–çš„è™šæ‹Ÿ DOM æ¸²æŸ“åˆ°é¡µé¢ä¸Š ä½ å¯ä»¥åœ¨è¿™é‡Œ çœ‹åˆ°Reactå®˜æ–¹å¯¹Reconcilerçš„è§£é‡Š\nReact15 æ¶æ„çš„ç¼ºç‚¹ åœ¨Reconcilerä¸­ï¼Œmountçš„ç»„ä»¶ä¼šè°ƒç”¨mountComponent ï¼Œupdateçš„ç»„ä»¶ä¼šè°ƒç”¨updateComponent ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šé€’å½’æ›´æ–°å­ç»„ä»¶ã€‚\nReact16 æ¶æ„ React16 æ¶æ„å¯ä»¥åˆ†ä¸ºä¸‰å±‚ï¼š\nSchedulerï¼ˆè°ƒåº¦å™¨ï¼‰â€”â€” è°ƒåº¦ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œé«˜ä¼˜ä»»åŠ¡ä¼˜å…ˆè¿›å…¥Reconciler Reconcilerï¼ˆåè°ƒå™¨ï¼‰â€”â€” è´Ÿè´£æ‰¾å‡ºå˜åŒ–çš„ç»„ä»¶ Rendererï¼ˆæ¸²æŸ“å™¨ï¼‰â€”â€” è´Ÿè´£å°†å˜åŒ–çš„ç»„ä»¶æ¸²æŸ“åˆ°é¡µé¢ä¸Š ç›¸è¾ƒäº React15ï¼ŒReact16 ä¸­æ–°å¢äº†Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰\nSchedulerï¼ˆè°ƒåº¦å™¨ï¼‰ æ—¢ç„¶æˆ‘ä»¬ä»¥æµè§ˆå™¨æ˜¯å¦æœ‰å‰©ä½™æ—¶é—´ä½œä¸ºä»»åŠ¡ä¸­æ–­çš„æ ‡å‡†ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶ï¼Œå½“æµè§ˆå™¨æœ‰å‰©ä½™æ—¶é—´æ—¶é€šçŸ¥æˆ‘ä»¬ã€‚\nå…¶å®éƒ¨åˆ†æµè§ˆå™¨å·²ç»å®ç°äº†è¿™ä¸ª APIï¼Œè¿™å°±æ˜¯requestIdleCallbackã€‚ä½†æ˜¯ç”±äºä»¥ä¸‹å› ç´ ï¼ŒReactæ”¾å¼ƒä½¿ç”¨ï¼š\næµè§ˆå™¨å…¼å®¹æ€§ è§¦å‘é¢‘ç‡ä¸ç¨³å®šï¼Œå—å¾ˆå¤šå› ç´ å½±å“ã€‚æ¯”å¦‚å½“æˆ‘ä»¬çš„æµè§ˆå™¨åˆ‡æ¢ tab åï¼Œä¹‹å‰ tab æ³¨å†Œçš„requestIdleCallbackè§¦å‘çš„é¢‘ç‡ä¼šå˜å¾—å¾ˆä½ åŸºäºä»¥ä¸ŠåŸå› ï¼ŒReactå®ç°äº†åŠŸèƒ½æ›´å®Œå¤‡çš„requestIdleCallbackpolyfillï¼Œè¿™å°±æ˜¯Schedulerã€‚é™¤äº†åœ¨ç©ºé—²æ—¶è§¦å‘å›è°ƒçš„åŠŸèƒ½å¤–ï¼ŒSchedulerè¿˜æä¾›äº†å¤šç§è°ƒåº¦ä¼˜å…ˆçº§ä¾›ä»»åŠ¡è®¾ç½®ã€‚\nScheduler æ˜¯ç‹¬ç«‹äºReactçš„åº“\nReconcilerï¼ˆåè°ƒå™¨ï¼‰ æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ React15 ä¸­Reconcileræ˜¯é€’å½’å¤„ç†è™šæ‹Ÿ DOM çš„ã€‚è®©æˆ‘ä»¬çœ‹çœ‹React16 çš„ Reconcilerã€‚\næˆ‘ä»¬å¯ä»¥çœ‹è§ï¼Œæ›´æ–°å·¥ä½œä»é€’å½’å˜æˆäº†å¯ä»¥ä¸­æ–­çš„å¾ªç¯è¿‡ç¨‹ã€‚æ¯æ¬¡å¾ªç¯éƒ½ä¼šè°ƒç”¨shouldYieldåˆ¤æ–­å½“å‰æ˜¯å¦æœ‰å‰©ä½™æ—¶é—´ã€‚\n1 2 3 4 5 6 function workLoopConcurrent() { // Perform work until Scheduler asks us to yield while (workInProgress !== null \u0026amp;\u0026amp; !shouldYield()) { workInProgress = performUnitOfWork(workInProgress); } } é‚£ä¹ˆ React16 æ˜¯å¦‚ä½•è§£å†³ä¸­æ–­æ›´æ–°æ—¶ DOM æ¸²æŸ“ä¸å®Œå…¨çš„é—®é¢˜å‘¢ï¼Ÿ\nåœ¨ React16 ä¸­ï¼ŒReconcilerä¸Rendererä¸å†æ˜¯äº¤æ›¿å·¥ä½œã€‚å½“Schedulerå°†ä»»åŠ¡äº¤ç»™Reconcileråï¼ŒReconcilerä¼šä¸ºå˜åŒ–çš„è™šæ‹Ÿ DOM æ‰“ä¸Šä»£è¡¨å¢/åˆ /æ›´æ–°çš„æ ‡è®°ï¼Œç±»ä¼¼è¿™æ ·ï¼š\n1 2 3 4 export const Placement = /* */ 0b0000000000010; export const Update = /* */ 0b0000000000100; export const PlacementAndUpdate = /* */ 0b0000000000110; export const Deletion = /* */ 0b0000000001000; å…¨éƒ¨çš„æ ‡è®°è§è¿™é‡Œ\næ•´ä¸ªSchedulerä¸Reconcilerçš„å·¥ä½œéƒ½åœ¨å†…å­˜ä¸­è¿›è¡Œã€‚åªæœ‰å½“æ‰€æœ‰ç»„ä»¶éƒ½å®ŒæˆReconcilerçš„å·¥ä½œï¼Œæ‰ä¼šç»Ÿä¸€äº¤ç»™Rendererã€‚\nä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°Reactå®˜æ–¹å¯¹ React16 æ–°Reconcilerçš„è§£é‡Š\nRendererï¼ˆæ¸²æŸ“å™¨ï¼‰ Rendereræ ¹æ®Reconcilerä¸ºè™šæ‹Ÿ DOM æ‰“çš„æ ‡è®°ï¼ŒåŒæ­¥æ‰§è¡Œå¯¹åº”çš„ DOM æ“ä½œã€‚\næ€»ç»“ åœ¨è¿™å¥—æ–°çš„æ¶æ„æ¨¡å¼ä¸‹ï¼Œæ›´æ–°çš„å¤„ç†å·¥ä½œæµå˜æˆäº†è¿™æ ·ï¼šé¦–å…ˆï¼Œæ¯ä¸ªæ›´æ–°ä»»åŠ¡éƒ½ä¼šè¢«èµ‹äºˆä¸€ä¸ªä¼˜å…ˆçº§ã€‚å½“æ›´æ–°ä»»åŠ¡æŠµè¾¾è°ƒåº¦å™¨æ—¶ï¼Œé«˜ä¼˜å…ˆçº§çš„æ›´æ–°ä»»åŠ¡ï¼ˆè®°ä¸º Aï¼‰ä¼šæ›´å¿«åœ°è¢«è°ƒåº¦è¿› Reconciler å±‚ï¼›æ­¤æ—¶è‹¥æœ‰æ–°çš„æ›´æ–°ä»»åŠ¡ï¼ˆè®°ä¸º Bï¼‰æŠµè¾¾è°ƒåº¦å™¨ï¼Œè°ƒåº¦å™¨ä¼šæ£€æŸ¥å®ƒçš„ä¼˜å…ˆçº§ï¼Œè‹¥å‘ç° B çš„ä¼˜å…ˆçº§é«˜äºå½“å‰ä»»åŠ¡ Aï¼Œé‚£ä¹ˆå½“å‰å¤„äº Reconciler å±‚çš„ A ä»»åŠ¡å°±ä¼šè¢«ä¸­æ–­ï¼Œè°ƒåº¦å™¨ä¼šå°† B ä»»åŠ¡æ¨å…¥ Reconciler å±‚ã€‚å½“ B ä»»åŠ¡å®Œæˆæ¸²æŸ“åï¼Œæ–°ä¸€è½®çš„è°ƒåº¦å¼€å§‹ï¼Œä¹‹å‰è¢«ä¸­æ–­çš„ A ä»»åŠ¡å°†ä¼šè¢«é‡æ–°æ¨å…¥ Reconciler å±‚ï¼Œç»§ç»­å®ƒçš„æ¸²æŸ“ä¹‹æ—…ï¼Œè¿™ä¾¿æ˜¯æ‰€è°“â€œå¯æ¢å¤â€ã€‚\nFiber æ¶æ„å¯¹ç”Ÿå‘½å‘¨æœŸçš„å½±å“ Fiber å¯¹ç”Ÿå‘½å‘¨æœŸçš„å½±å“\n","permalink":"https://zzydev.top/posts/headfirstreact/9_%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3fiber%E6%9E%B6%E6%9E%84%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%8A%A8%E6%9C%BA%E4%B8%8E%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/","summary":"å‰ç½®çŸ¥è¯†ï¼šå•çº¿ç¨‹çš„ JavaScript ä¸å¤šçº¿ç¨‹çš„æµè§ˆå™¨ JavaScript çº¿ç¨‹å’Œæ¸²æŸ“çº¿ç¨‹å¿…é¡»æ˜¯äº’æ–¥çš„ï¼šè¿™ä¸¤ä¸ªçº¿ç¨‹ä¸èƒ½å¤Ÿç©¿æ’æ‰§è¡Œï¼Œå¿…é¡»ä¸²è¡Œã€‚å½“å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åªèƒ½æŒ‚","title":"9.å¦‚ä½•ç†è§£Fiberæ¶æ„çš„è¿­ä»£åŠ¨æœºä¸è®¾è®¡æ€æƒ³"},{"content":"ä»ä¸€é“é¢è¯•é¢˜è¯´èµ· å…¶ä»– setState åŸç†çš„æ–‡ç« \næœ¬æ–‡çš„ online Demo\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 import React from \u0026#34;react\u0026#34;; import \u0026#34;./styles.css\u0026#34;; export default class App extends React.Component { state = { count: 0, }; increment = () =\u0026gt; { console.log(\u0026#34;increment setStateå‰çš„count\u0026#34;, this.state.count); this.setState({ count: this.state.count + 1, }); console.log(\u0026#34;increment setStateåçš„count\u0026#34;, this.state.count); }; triple = () =\u0026gt; { console.log(\u0026#34;triple setStateå‰çš„count\u0026#34;, this.state.count); this.setState({ count: this.state.count + 1, }); this.setState({ count: this.state.count + 1, }); this.setState({ count: this.state.count + 1, }); console.log(\u0026#34;triple setStateåçš„count\u0026#34;, this.state.count); }; reduce = () =\u0026gt; { setTimeout(() =\u0026gt; { console.log(\u0026#34;reduce setStateå‰çš„count\u0026#34;, this.state.count); this.setState({ count: this.state.count - 1, }); console.log(\u0026#34;reduce setStateåçš„count\u0026#34;, this.state.count); }, 0); }; render() { return ( \u0026lt;div\u0026gt; \u0026lt;button onClick={this.increment}\u0026gt;ç‚¹æˆ‘å¢åŠ \u0026lt;/button\u0026gt; \u0026lt;button onClick={this.triple}\u0026gt;ç‚¹æˆ‘å¢åŠ ä¸‰å€\u0026lt;/button\u0026gt; \u0026lt;button onClick={this.reduce}\u0026gt;ç‚¹æˆ‘å‡å°‘\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); } } ç»“æœæ‰“å°å¦‚ä¸‹ï¼š å¼‚æ­¥çš„åŠ¨æœºå’ŒåŸç†â€”â€”æ‰¹é‡æ›´æ–° ä»å›¾ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªå®Œæ•´çš„æ›´æ–°æµç¨‹ï¼Œæ¶‰åŠäº†åŒ…æ‹¬ re-renderï¼ˆé‡æ¸²æŸ“ï¼‰ åœ¨å†…çš„å¤šä¸ªæ­¥éª¤ã€‚re-render æœ¬èº«æ¶‰åŠå¯¹ DOM çš„æ“ä½œï¼Œå®ƒä¼šå¸¦æ¥è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ã€‚å‡å¦‚è¯´â€œä¸€æ¬¡ setState å°±è§¦å‘ä¸€ä¸ªå®Œæ•´çš„æ›´æ–°æµç¨‹â€è¿™ä¸ªç»“è®ºæˆç«‹ï¼Œé‚£ä¹ˆæ¯ä¸€æ¬¡ setState çš„è°ƒç”¨éƒ½ä¼šè§¦å‘ä¸€æ¬¡ re-renderï¼Œæˆ‘ä»¬çš„è§†å›¾å¾ˆå¯èƒ½æ²¡åˆ·æ–°å‡ æ¬¡å°±å¡æ­»äº†ã€‚è¿™ä¸ªè¿‡ç¨‹å¦‚æˆ‘ä»¬ä¸‹é¢ä»£ç ä¸­çš„ç®­å¤´æµç¨‹å›¾æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 this.setState({ count: this.state.count + 1 ===\u0026gt; shouldComponentUpdate-\u0026gt;componentWillUpdate-\u0026gt;render-\u0026gt;componentDidUpdate }); this.setState({ count: this.state.count + 1 ===\u0026gt; shouldComponentUpdate-\u0026gt;componentWillUpdate-\u0026gt;render-\u0026gt;componentDidUpdate }); this.setState({ count: this.state.count + 1 ===\u0026gt; shouldComponentUpdate-\u0026gt;componentWillUpdate-\u0026gt;render-\u0026gt;componentDidUpdate }); äº‹å®ä¸Šï¼Œè¿™æ­£æ˜¯ setState å¼‚æ­¥çš„ä¸€ä¸ªé‡è¦çš„åŠ¨æœºâ€”â€”é¿å…é¢‘ç¹çš„ re-renderã€‚\nåœ¨å®é™…çš„ React è¿è¡Œæ—¶ä¸­ï¼ŒsetState å¼‚æ­¥çš„å®ç°æ–¹å¼æœ‰ç‚¹ç±»ä¼¼äº Vue çš„ $nextTick å’Œæµè§ˆå™¨é‡Œçš„ Event-Loopï¼šæ¯æ¥ä¸€ä¸ª setStateï¼Œå°±æŠŠå®ƒå¡è¿›ä¸€ä¸ªé˜Ÿåˆ—é‡Œâ€œæ”’èµ·æ¥â€ã€‚ç­‰æ—¶æœºæˆç†Ÿï¼Œå†æŠŠâ€œæ”’èµ·æ¥â€çš„ state ç»“æœåšåˆå¹¶ï¼Œæœ€ååªé’ˆå¯¹æœ€æ–°çš„ state å€¼èµ°ä¸€æ¬¡æ›´æ–°æµç¨‹ã€‚ è¿™ä¸ªè¿‡ç¨‹ï¼Œå«ä½œâ€œæ‰¹é‡æ›´æ–°â€ï¼Œæ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ­£å¦‚ä¸‹é¢ä»£ç ä¸­çš„ç®­å¤´æµç¨‹å›¾æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 this.setState({ count: this.state.count + 1 ===\u0026gt; å…¥é˜Ÿï¼Œ[count + 1çš„ä»»åŠ¡] }); this.setState({ count: this.state.count + 1 ===\u0026gt; å…¥é˜Ÿï¼Œ[count + 1çš„ä»»åŠ¡ï¼Œcount + 1çš„ä»»åŠ¡] }); this.setState({ count: this.state.count + 1 ===\u0026gt; å…¥é˜Ÿ, [count + 1çš„ä»»åŠ¡ï¼Œcount + 1çš„ä»»åŠ¡, count + 1çš„ä»»åŠ¡] }); â†“ åˆå¹¶ stateï¼Œ[count + 1çš„ä»»åŠ¡] â†“ æ‰§è¡Œ count + 1çš„ä»»åŠ¡ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåªè¦æˆ‘ä»¬çš„åŒæ­¥ä»£ç è¿˜åœ¨æ‰§è¡Œï¼Œâ€œæ”’èµ·æ¥â€è¿™ä¸ªåŠ¨ä½œå°±ä¸ä¼šåœæ­¢ã€‚ï¼ˆæ³¨ï¼šè¿™é‡Œä¹‹æ‰€ä»¥å¤šæ¬¡ +1 æœ€ç»ˆåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆï¼Œæ˜¯å› ä¸ºåœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸­å¤šæ¬¡ setState çš„åˆå¹¶åŠ¨ä½œä¸æ˜¯å•çº¯åœ°å°†æ›´æ–°ç´¯åŠ ã€‚æ¯”å¦‚è¿™é‡Œå¯¹äºç›¸åŒå±æ€§çš„è®¾ç½®ï¼ŒReact åªä¼šä¸ºå…¶ä¿ç•™æœ€åä¸€æ¬¡çš„æ›´æ–°ï¼‰ã€‚å› æ­¤å°±ç®—æˆ‘ä»¬åœ¨ React ä¸­å†™äº†è¿™æ ·ä¸€ä¸ª 100 æ¬¡çš„ setState å¾ªç¯ï¼š\n1 2 3 4 5 6 7 8 9 test = () =\u0026gt; { console.log(\u0026#34;å¾ªç¯100æ¬¡ setStateå‰çš„count\u0026#34;, this.state.count); for (let i = 0; i \u0026lt; 100; i++) { this.setState({ count: this.state.count + 1, }); } console.log(\u0026#34;å¾ªç¯100æ¬¡ setStateåçš„count\u0026#34;, this.state.count); }; ä¹Ÿåªæ˜¯ä¼šå¢åŠ  state ä»»åŠ¡å…¥é˜Ÿçš„æ¬¡æ•°ï¼Œå¹¶ä¸ä¼šå¸¦æ¥é¢‘ç¹çš„ re-renderã€‚å½“ 100 æ¬¡è°ƒç”¨ç»“æŸåï¼Œä»…ä»…æ˜¯ state çš„ä»»åŠ¡é˜Ÿåˆ—å†…å®¹å‘ç”Ÿäº†å˜åŒ–ï¼Œ state æœ¬èº«å¹¶ä¸ä¼šç«‹åˆ»æ”¹å˜ï¼š\nâ€œåŒæ­¥ç°è±¡â€èƒŒåçš„æ•…äº‹ï¼šä»æºç è§’åº¦çœ‹ setState å·¥ä½œæµ\nè¯»åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹å¼‚æ­¥è¿™å›äº‹å¤šå°‘æœ‰äº›çœ‰ç›®äº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦é‡ç‚¹ç†è§£åˆšåˆšä»£ç é‡Œæœ€è¯¡å¼‚çš„ä¸€éƒ¨åˆ†â€”â€”setState çš„åŒæ­¥ç°è±¡ï¼š\n1 2 3 4 5 6 7 8 9 reduce = () =\u0026gt; { setTimeout(() =\u0026gt; { console.log(\u0026#34;reduce setStateå‰çš„count\u0026#34;, this.state.count); this.setState({ count: this.state.count - 1, }); console.log(\u0026#34;reduce setStateåçš„count\u0026#34;, this.state.count); }, 0); }; ä»é¢˜ç›®ä¸Šçœ‹ï¼ŒsetState ä¼¼ä¹æ˜¯åœ¨ setTimeout å‡½æ•°çš„â€œä¿æŠ¤â€ä¹‹ä¸‹ï¼Œæ‰æœ‰äº†åŒæ­¥è¿™ä¸€â€œç‰¹å¼‚åŠŸèƒ½â€ã€‚äº‹å®ä¹Ÿçš„ç¡®å¦‚æ­¤ï¼Œå‡å¦‚æˆ‘ä»¬æŠŠ setTimeout æ‘˜æ‰ï¼ŒsetState å‰åçš„ console è¡¨ç°å°†ä¼šä¸ increment æ–¹æ³•ä¸­æ— å¼‚ï¼š\n1 2 3 4 5 6 7 8 9 reduce = () =\u0026gt; { // setTimeout(() =\u0026gt; { console.log(\u0026#34;reduce setStateå‰çš„count\u0026#34;, this.state.count); this.setState({ count: this.state.count - 1, }); console.log(\u0026#34;reduce setStateåçš„count\u0026#34;, this.state.count); // },0); }; ç‚¹å‡»åçš„è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nç°åœ¨é—®é¢˜å°±å˜å¾—æ¸…æ™°å¤šäº†ï¼šä¸ºä»€ä¹ˆ setTimeout å¯ä»¥å°† setState çš„æ‰§è¡Œé¡ºåºä»å¼‚æ­¥å˜ä¸ºåŒæ­¥ï¼Ÿ\nè¿™é‡Œæˆ‘å…ˆç»™å‡ºä¸€ä¸ªç»“è®ºï¼šå¹¶ä¸æ˜¯ setTimeout æ”¹å˜äº† setStateï¼Œè€Œæ˜¯ setTimeout å¸®åŠ© setState â€œé€ƒè„±â€äº† React å¯¹å®ƒçš„ç®¡æ§ã€‚åªè¦æ˜¯åœ¨ React ç®¡æ§ä¸‹çš„ setStateï¼Œä¸€å®šæ˜¯å¼‚æ­¥çš„ã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬å°±ä» React æºç é‡Œï¼Œå»å¯»æ±‚ä½è¯è¿™ä¸ªç»“è®ºçš„çº¿ç´¢ã€‚\nè§£è¯» setState å·¥ä½œæµ æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ²¿ç€è¿™ä¸ªæµç¨‹ï¼Œé€ä¸ªåœ¨æºç ä¸­å¯¹å·å…¥åº§ã€‚é¦–å…ˆæ˜¯ setState å…¥å£å‡½æ•°ï¼š\n1 2 3 4 5 6 ReactComponent.prototype.setState = function (partialState, callback) { this.updater.enqueueSetState(this, partialState); if (callback) { this.updater.enqueueCallback(this, callback, \u0026#34;setState\u0026#34;); } }; å…¥å£å‡½æ•°åœ¨è¿™é‡Œå°±æ˜¯å……å½“ä¸€ä¸ªåˆ†å‘å™¨çš„è§’è‰²ï¼Œæ ¹æ®å…¥å‚çš„ä¸åŒï¼Œå°†å…¶åˆ†å‘åˆ°ä¸åŒçš„åŠŸèƒ½å‡½æ•°ä¸­å»ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥å¯¹è±¡å½¢å¼çš„å…¥å‚ä¸ºä¾‹ï¼Œå¯ä»¥çœ‹åˆ°å®ƒç›´æ¥è°ƒç”¨äº† this.updater.enqueueSetState è¿™ä¸ªæ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 enqueueSetState: function (publicInstance, partialState) { // æ ¹æ® this æ‹¿åˆ°å¯¹åº”çš„ç»„ä»¶å®ä¾‹ var internalInstance = getInternalInstanceReadyForUpdate(publicInstance, \u0026#39;setState\u0026#39;); // è¿™ä¸ª queue å¯¹åº”çš„å°±æ˜¯ä¸€ä¸ªç»„ä»¶å®ä¾‹çš„ state æ•°ç»„ var queue = internalInstance._pendingStateQueue || (internalInstance._pendingStateQueue = []); queue.push(partialState); // enqueueUpdate ç”¨æ¥å¤„ç†å½“å‰çš„ç»„ä»¶å®ä¾‹ enqueueUpdate(internalInstance); } æ€»ç»“ä¸€ä¸‹ï¼ŒenqueueSetState åšäº†ä¸¤ä»¶äº‹ï¼š\nå°†æ–°çš„ state æ”¾è¿›ç»„ä»¶çš„çŠ¶æ€é˜Ÿåˆ—é‡Œï¼› ç”¨ enqueueUpdate æ¥å¤„ç†å°†è¦æ›´æ–°çš„å®ä¾‹å¯¹è±¡ã€‚ ç»§ç»­å¾€ä¸‹èµ°ï¼Œçœ‹çœ‹ enqueueUpdate åšäº†ä»€ä¹ˆï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 function enqueueUpdate(component) { ensureInjected(); // æ³¨æ„è¿™ä¸€å¥æ˜¯é—®é¢˜çš„å…³é”®ï¼ŒisBatchingUpdatesæ ‡è¯†ç€å½“å‰æ˜¯å¦å¤„äºæ‰¹é‡åˆ›å»º/æ›´æ–°ç»„ä»¶çš„é˜¶æ®µ if (!batchingStrategy.isBatchingUpdates) { // è‹¥å½“å‰æ²¡æœ‰å¤„äºæ‰¹é‡åˆ›å»º/æ›´æ–°ç»„ä»¶çš„é˜¶æ®µï¼Œåˆ™ç«‹å³æ›´æ–°ç»„ä»¶ batchingStrategy.batchedUpdates(enqueueUpdate, component); return; } // å¦åˆ™ï¼Œå…ˆæŠŠç»„ä»¶å¡å…¥ dirtyComponents é˜Ÿåˆ—é‡Œï¼Œè®©å®ƒâ€œå†ç­‰ç­‰â€ dirtyComponents.push(component); if (component._updateBatchNumber == null) { component._updateBatchNumber = updateBatchNumber + 1; } } enqueueUpdate å¼•å‡ºäº†ä¸€ä¸ªå…³é”®çš„å¯¹è±¡â€”â€”batchingStrategyï¼Œè¯¥å¯¹è±¡æ‰€å…·å¤‡çš„ isBatchingUpdates å±æ€§ç›´æ¥å†³å®šäº†å½“ä¸‹æ˜¯è¦èµ°æ›´æ–°æµç¨‹ï¼Œè¿˜æ˜¯åº”è¯¥æ’é˜Ÿç­‰å¾…ï¼›å…¶ä¸­çš„ batchedUpdates æ–¹æ³•æ›´æ˜¯èƒ½å¤Ÿç›´æ¥å‘èµ·æ›´æ–°æµç¨‹ã€‚ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¤§èƒ†æ¨æµ‹ï¼ŒbatchingStrategy æˆ–è®¸æ­£æ˜¯ React å†…éƒ¨ä¸“é—¨ç”¨äºç®¡æ§æ‰¹é‡æ›´æ–°çš„å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 /** * batchingStrategyæºç  **/ var ReactDefaultBatchingStrategy = { // å…¨å±€å”¯ä¸€çš„é”æ ‡è¯† isBatchingUpdates: false, // å‘èµ·æ›´æ–°åŠ¨ä½œçš„æ–¹æ³• batchedUpdates: function (callback, a, b, c, d, e) { // ç¼“å­˜é”å˜é‡ var alreadyBatchingStrategy = ReactDefaultBatchingStrategy.isBatchingUpdates; // æŠŠé”â€œé”ä¸Šâ€ ReactDefaultBatchingStrategy.isBatchingUpdates = true; if (alreadyBatchingStrategy) { callback(a, b, c, d, e); } else { // å¯åŠ¨äº‹åŠ¡ï¼Œå°† callback æ”¾è¿›äº‹åŠ¡é‡Œæ‰§è¡Œ transaction.perform(callback, null, a, b, c, d, e); } }, }; batchingStrategy å¯¹è±¡å¹¶ä¸å¤æ‚ï¼Œä½ å¯ä»¥ç†è§£ä¸ºå®ƒæ˜¯ä¸€ä¸ªâ€œé”ç®¡ç†å™¨â€ã€‚\nè¿™é‡Œçš„â€œé”â€ï¼Œæ˜¯æŒ‡ React å…¨å±€å”¯ä¸€çš„ isBatchingUpdates å˜é‡ï¼ŒisBatchingUpdates çš„åˆå§‹å€¼æ˜¯ falseï¼Œæ„å‘³ç€â€œå½“å‰å¹¶æœªè¿›è¡Œä»»ä½•æ‰¹é‡æ›´æ–°æ“ä½œâ€ã€‚æ¯å½“ React è°ƒç”¨ batchedUpdate å»æ‰§è¡Œæ›´æ–°åŠ¨ä½œæ—¶ï¼Œä¼šå…ˆæŠŠè¿™ä¸ªé”ç»™â€œé”ä¸Šâ€ï¼ˆç½®ä¸º trueï¼‰ï¼Œè¡¨æ˜â€œç°åœ¨æ­£å¤„äºæ‰¹é‡æ›´æ–°è¿‡ç¨‹ä¸­â€ã€‚å½“é”è¢«â€œé”ä¸Šâ€çš„æ—¶å€™ï¼Œä»»ä½•éœ€è¦æ›´æ–°çš„ç»„ä»¶éƒ½åªèƒ½æš‚æ—¶è¿›å…¥ dirtyComponents é‡Œæ’é˜Ÿç­‰å€™ä¸‹ä¸€æ¬¡çš„æ‰¹é‡æ›´æ–°ï¼Œè€Œä¸èƒ½éšæ„â€œæ’é˜Ÿâ€ã€‚æ­¤å¤„ä½“ç°çš„â€œä»»åŠ¡é”â€çš„æ€æƒ³ï¼Œæ˜¯ React é¢å¯¹å¤§é‡çŠ¶æ€ä»ç„¶èƒ½å¤Ÿå®ç°æœ‰åºåˆ†æ‰¹å¤„ç†çš„åŸºçŸ³ã€‚\nç†è§£äº†æ‰¹é‡æ›´æ–°æ•´ä½“çš„ç®¡ç†æœºåˆ¶ï¼Œè¿˜éœ€è¦æ³¨æ„ batchedUpdates ä¸­ï¼Œæœ‰ä¸€ä¸ªå¼•äººæ³¨ç›®çš„è°ƒç”¨ï¼š\n1 transaction.perform(callback, null, a, b, c, d, e); è¿™è¡Œä»£ç ä¸ºæˆ‘ä»¬å¼•å‡ºäº†ä¸€ä¸ªæ›´ä¸ºç¡¬æ ¸çš„æ¦‚å¿µâ€”â€”React ä¸­çš„ Transactionï¼ˆäº‹åŠ¡ï¼‰æœºåˆ¶ã€‚\nç†è§£ React ä¸­çš„ Transactionï¼ˆäº‹åŠ¡ï¼‰ æœºåˆ¶ Transaction åœ¨ React æºç ä¸­çš„åˆ†å¸ƒå¯ä»¥è¯´éå¸¸å¹¿æ³›ã€‚å¦‚æœä½ åœ¨ Debug React é¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å‡½æ•°è°ƒç”¨æ ˆä¸­å‡ºç°äº† initializeã€performã€closeã€closeAll æˆ–è€… notifyAll è¿™æ ·çš„æ–¹æ³•åï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ä½ å½“å‰å°±å¤„äºä¸€ä¸ª Trasaction ä¸­ã€‚\nTransaction åœ¨ React æºç ä¸­è¡¨ç°ä¸ºä¸€ä¸ªæ ¸å¿ƒç±»ï¼ŒReact å®˜æ–¹æ›¾ç»è¿™æ ·æè¿°å®ƒï¼šTransaction æ˜¯åˆ›å»ºä¸€ä¸ªé»‘ç›’ï¼Œè¯¥é»‘ç›’èƒ½å¤Ÿå°è£…ä»»ä½•çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œé‚£äº›éœ€è¦åœ¨å‡½æ•°è¿è¡Œå‰ã€åè¿è¡Œçš„æ–¹æ³•å¯ä»¥é€šè¿‡æ­¤æ–¹æ³•å°è£…ï¼ˆå³ä½¿å‡½æ•°è¿è¡Œä¸­æœ‰å¼‚å¸¸æŠ›å‡ºï¼Œè¿™äº›å›ºå®šçš„æ–¹æ³•ä»å¯è¿è¡Œï¼‰ï¼Œå®ä¾‹åŒ– Transaction æ—¶åªéœ€æä¾›ç›¸å…³çš„æ–¹æ³•å³å¯ã€‚\nè¿™æ®µè¯åˆè¯»æœ‰ç‚¹æ‹—å£ï¼Œè¿™é‡Œæˆ‘æ¨èä½ ç»“åˆ React æºç ä¸­çš„ä¸€æ®µé’ˆå¯¹ Transaction çš„æ³¨é‡Šæ¥ç†è§£å®ƒï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 * \u0026lt;pre\u0026gt; * wrappers (injected at creation time) * + + * | | * +-----------------|--------|--------------+ * | v | | * | +---------------+ | | * | +--| wrapper1 |---|----+ | * | | +---------------+ v | | * | | +-------------+ | | * | | +----| wrapper2 |--------+ | * | | | +-------------+ | | | * | | | | | | * | v v v v | wrapper * | +---+ +---+ +---------+ +---+ +---+ | invariants * perform(anyMethod) | | | | | | | | | | | | maintained * +-----------------\u0026gt;|-|---|-|---|--\u0026gt;|anyMethod|---|---|-|---|-|--------\u0026gt; * | | | | | | | | | | | | * | | | | | | | | | | | | * | | | | | | | | | | | | * | +---+ +---+ +---------+ +---+ +---+ | * | initialize close | * +-----------------------------------------+ * \u0026lt;/pre\u0026gt; è¯´ç™½äº†ï¼ŒTransaction å°±åƒæ˜¯ä¸€ä¸ªâ€œå£³å­â€ï¼Œå®ƒé¦–å…ˆä¼šå°†ç›®æ ‡å‡½æ•°ç”¨ wrapperï¼ˆä¸€ç»„ initialize åŠ close æ–¹æ³•ç§°ä¸ºä¸€ä¸ª wrapperï¼‰ å°è£…èµ·æ¥ï¼ŒåŒæ—¶éœ€è¦ä½¿ç”¨ Transaction ç±»æš´éœ²çš„ perform æ–¹æ³•å»æ‰§è¡Œå®ƒã€‚å¦‚ä¸Šé¢çš„æ³¨é‡Šæ‰€ç¤ºï¼Œåœ¨ anyMethod æ‰§è¡Œä¹‹å‰ï¼Œperform ä¼šå…ˆæ‰§è¡Œæ‰€æœ‰ wrapper çš„ initialize æ–¹æ³•ï¼Œæ‰§è¡Œå®Œåï¼Œå†æ‰§è¡Œæ‰€æœ‰ wrapper çš„ close æ–¹æ³•ã€‚è¿™å°±æ˜¯ React ä¸­çš„äº‹åŠ¡æœºåˆ¶ã€‚\nâ€œåŒæ­¥ç°è±¡â€çš„æœ¬è´¨ ä¸‹é¢ç»“åˆå¯¹äº‹åŠ¡æœºåˆ¶çš„ç†è§£ï¼Œæˆ‘ä»¬ç»§ç»­æ¥çœ‹åœ¨ ReactDefaultBatchingStrategy è¿™ä¸ªå¯¹è±¡ã€‚ReactDefaultBatchingStrategy å…¶å®å°±æ˜¯ä¸€ä¸ªæ‰¹é‡æ›´æ–°ç­–ç•¥äº‹åŠ¡ï¼Œå®ƒçš„ wrapper æœ‰ä¸¤ä¸ªï¼šFLUSH_BATCHED_UPDATES å’Œ RESET_BATCHED_UPDATESã€‚\n1 2 3 4 5 6 7 8 9 10 11 var RESET_BATCHED_UPDATES = { initialize: emptyFunction, close: function () { ReactDefaultBatchingStrategy.isBatchingUpdates = false; }, }; var FLUSH_BATCHED_UPDATES = { initialize: emptyFunction, close: ReactUpdates.flushBatchedUpdates.bind(ReactUpdates), }; var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES, RESET_BATCHED_UPDATES]; æˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ª wrapper å¥—è¿› Transaction çš„æ‰§è¡Œæœºåˆ¶é‡Œï¼Œä¸éš¾å¾—å‡ºä¸€ä¸ªè¿™æ ·çš„æµç¨‹ï¼š\nåˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹ isBatchingUpdates ç®¡æ§ä¸‹çš„æ‰¹é‡æ›´æ–°æœºåˆ¶å·²ç»äº†ç„¶äºèƒ¸ã€‚ä½†æ˜¯ setState ä¸ºä½•ä¼šè¡¨ç°åŒæ­¥è¿™ä¸ªé—®é¢˜ï¼Œä¼¼ä¹è¿˜æ˜¯æ²¡æœ‰ä»å½“å‰å±•ç¤ºå‡ºæ¥çš„æºç é‡Œå¾—åˆ°æ ¹æœ¬ä¸Šçš„å›ç­”ã€‚è¿™æ˜¯å› ä¸º batchedUpdates è¿™ä¸ªæ–¹æ³•ï¼Œä¸ä»…ä»…ä¼šåœ¨ setState ä¹‹åæ‰è¢«è°ƒç”¨ã€‚è‹¥æˆ‘ä»¬åœ¨ React æºç ä¸­å…¨å±€æœç´¢ batchedUpdatesï¼Œä¼šå‘ç°è°ƒç”¨å®ƒçš„åœ°æ–¹å¾ˆå¤šï¼Œä½†ä¸æ›´æ–°æµæœ‰å…³çš„åªæœ‰è¿™ä¸¤ä¸ªåœ°æ–¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // ReactMount.js _renderNewRootComponent: function( nextElement, container, shouldReuseMarkup, context ) { // å®ä¾‹åŒ–ç»„ä»¶ var componentInstance = instantiateReactComponent(nextElement); // åˆå§‹æ¸²æŸ“ç›´æ¥è°ƒç”¨ batchedUpdates è¿›è¡ŒåŒæ­¥æ¸²æŸ“ ReactUpdates.batchedUpdates( batchedMountComponentIntoNode, componentInstance, container, shouldReuseMarkup, context ); ... } è¿™æ®µä»£ç æ˜¯åœ¨é¦–æ¬¡æ¸²æŸ“ç»„ä»¶æ—¶ä¼šæ‰§è¡Œçš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒå†…éƒ¨è°ƒç”¨äº†ä¸€æ¬¡ batchedUpdatesï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç»„ä»¶çš„æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œä¼šæŒ‰ç…§é¡ºåºè°ƒç”¨å„ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚å¼€å‘è€…å¾ˆæœ‰å¯èƒ½åœ¨å£°æ˜å‘¨æœŸå‡½æ•°ä¸­è°ƒç”¨ setStateã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å¼€å¯ batch æ¥ç¡®ä¿æ‰€æœ‰çš„æ›´æ–°éƒ½èƒ½å¤Ÿè¿›å…¥ dirtyComponents é‡Œå»ï¼Œè¿›è€Œç¡®ä¿åˆå§‹æ¸²æŸ“æµç¨‹ä¸­æ‰€æœ‰çš„ setState éƒ½æ˜¯ç”Ÿæ•ˆçš„ã€‚\nä¸‹é¢ä»£ç æ˜¯ React äº‹ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚å½“æˆ‘ä»¬åœ¨ç»„ä»¶ä¸Šç»‘å®šäº†äº‹ä»¶ä¹‹åï¼Œäº‹ä»¶ä¸­ä¹Ÿæœ‰å¯èƒ½ä¼šè§¦å‘ setStateã€‚ä¸ºäº†ç¡®ä¿æ¯ä¸€æ¬¡ setState éƒ½æœ‰æ•ˆï¼ŒReact åŒæ ·ä¼šåœ¨æ­¤å¤„æ‰‹åŠ¨å¼€å¯æ‰¹é‡æ›´æ–°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 // ReactEventListener.js dispatchEvent: function (topLevelType, nativeEvent) { ... try { // å¤„ç†äº‹ä»¶ ReactUpdates.batchedUpdates(handleTopLevelImpl, bookKeeping); } finally { TopLevelCallbackBookKeeping.release(bookKeeping); } } è¯è¯´åˆ°è¿™é‡Œï¼Œä¸€åˆ‡éƒ½å˜å¾—æ˜æœ—äº†èµ·æ¥ï¼šisBatchingUpdates è¿™ä¸ªå˜é‡ï¼Œåœ¨ React çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä»¥åŠåˆæˆäº‹ä»¶æ‰§è¡Œå‰ï¼Œå·²ç»è¢« React æ‚„æ‚„ä¿®æ”¹ä¸ºäº† trueï¼Œè¿™æ—¶æˆ‘ä»¬æ‰€åšçš„ setState æ“ä½œè‡ªç„¶ä¸ä¼šç«‹å³ç”Ÿæ•ˆã€‚å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œäº‹åŠ¡çš„ close æ–¹æ³•ä¼šå†æŠŠ isBatchingUpdates æ”¹ä¸º falseã€‚\nä»¥å¼€å¤´ç¤ºä¾‹ä¸­çš„ increment æ–¹æ³•ä¸ºä¾‹ï¼Œæ•´ä¸ªè¿‡ç¨‹åƒæ˜¯è¿™æ ·ï¼š\n1 2 3 4 5 6 7 8 9 10 11 increment = () =\u0026gt; { // è¿›æ¥å…ˆé”ä¸Š isBatchingUpdates = true; console.log(\u0026#34;increment setStateå‰çš„count\u0026#34;, this.state.count); this.setState({ count: this.state.count + 1, }); console.log(\u0026#34;increment setStateåçš„count\u0026#34;, this.state.count); // æ‰§è¡Œå®Œå‡½æ•°å†æ”¾å¼€ isBatchingUpdates = false; }; å¾ˆæ˜æ˜¾ï¼Œåœ¨ isBatchingUpdates çš„çº¦æŸä¸‹ï¼ŒsetState åªèƒ½æ˜¯å¼‚æ­¥çš„ã€‚è€Œå½“ setTimeout ä»ä¸­ä½œç¥Ÿæ—¶ï¼Œäº‹æƒ…å°±ä¼šå‘ç”Ÿä¸€ç‚¹ç‚¹å˜åŒ–ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 reduce = () =\u0026gt; { // è¿›æ¥å…ˆé”ä¸Š isBatchingUpdates = true; setTimeout(() =\u0026gt; { console.log(\u0026#34;reduce setStateå‰çš„count\u0026#34;, this.state.count); this.setState({ count: this.state.count - 1, }); console.log(\u0026#34;reduce setStateåçš„count\u0026#34;, this.state.count); }, 0); // æ‰§è¡Œå®Œå‡½æ•°å†æ”¾å¼€ isBatchingUpdates = false; }; ä¼šå‘ç°ï¼Œå’±ä»¬å¼€å¤´é”ä¸Šçš„é‚£ä¸ª isBatchingUpdatesï¼Œå¯¹ setTimeout å†…éƒ¨çš„æ‰§è¡Œé€»è¾‘å®Œå…¨æ²¡æœ‰çº¦æŸåŠ›ã€‚å› ä¸º isBatchingUpdates æ˜¯åœ¨åŒæ­¥ä»£ç ä¸­å˜åŒ–çš„ï¼Œè€Œ setTimeout çš„é€»è¾‘æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚å½“ this.setState è°ƒç”¨çœŸæ­£å‘ç”Ÿçš„æ—¶å€™ï¼ŒisBatchingUpdates æ—©å·²ç»è¢«é‡ç½®ä¸ºäº† falseï¼Œè¿™å°±ä½¿å¾—å½“å‰åœºæ™¯ä¸‹çš„ setState å…·å¤‡äº†ç«‹åˆ»å‘èµ·åŒæ­¥æ›´æ–°çš„èƒ½åŠ›ã€‚æ‰€ä»¥å’±ä»¬å‰é¢è¯´çš„æ²¡é”™â€”â€”setState å¹¶ä¸æ˜¯å…·å¤‡åŒæ­¥è¿™ç§ç‰¹æ€§ï¼Œåªæ˜¯åœ¨ç‰¹å®šçš„æƒ…å¢ƒä¸‹ï¼Œå®ƒä¼šä» React çš„å¼‚æ­¥ç®¡æ§ä¸­â€œé€ƒè„±â€æ‰ã€‚\n","permalink":"https://zzydev.top/posts/headfirstreact/8_setstate%E6%98%AF%E5%90%8C%E6%AD%A5%E7%9A%84%E8%BF%98%E6%98%AF%E5%BC%82%E6%AD%A5%E7%9A%84/","summary":"ä»ä¸€é“é¢è¯•é¢˜è¯´èµ· å…¶ä»– setState åŸç†çš„æ–‡ç«  æœ¬æ–‡çš„ online Demo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49","title":"8.SetStateæ˜¯åŒæ­¥çš„è¿˜æ˜¯å¼‚æ­¥çš„ï¼Ÿ"},{"content":"è°ƒå’Œï¼ˆReconciliationï¼‰è¿‡ç¨‹ä¸ Diff ç®—æ³• Virtual DOM æ˜¯ä¸€ç§ç¼–ç¨‹æ¦‚å¿µã€‚åœ¨è¿™ä¸ªæ¦‚å¿µé‡Œï¼ŒUI ä»¥ä¸€ç§ç†æƒ³åŒ–çš„ï¼Œæˆ–è€…è¯´â€œè™šæ‹Ÿçš„â€è¡¨ç°å½¢å¼è¢«ä¿å­˜äºå†…å­˜ä¸­ï¼Œå¹¶é€šè¿‡å¦‚ ReactDOM ç­‰ç±»åº“ä½¿ä¹‹ä¸â€œçœŸå®çš„â€ DOM åŒæ­¥ã€‚è¿™ä¸€è¿‡ç¨‹å«ä½œåè°ƒï¼ˆè°ƒå’Œï¼‰ã€‚ â€”â€”â€” React å®˜æ–¹\nReconcilerï¼ˆè°ƒå’Œå™¨ï¼‰æ‰€åšçš„å·¥ä½œæ˜¯ä¸€ç³»åˆ—çš„ï¼ŒåŒ…æ‹¬ç»„ä»¶çš„æŒ‚è½½ã€å¸è½½ã€æ›´æ–°ç­‰è¿‡ç¨‹ï¼Œå…¶ä¸­æ›´æ–°è¿‡ç¨‹æ¶‰åŠå¯¹ Diff ç®—æ³•çš„è°ƒç”¨ã€‚\nDiff ç­–ç•¥çš„è®¾è®¡æ€æƒ³ React å›¢é˜Ÿç»“åˆè®¾è®¡å±‚é¢çš„ä¸€äº›æ¨å¯¼ï¼Œä¸ºå°† O (n3) å¤æ‚åº¦è½¬æ¢æˆ O (n) å¤æ‚åº¦ç¡®ç«‹äº†å¤§å‰æï¼Œæ€»ç»“äº†ä»¥ä¸‹ä¸¤ä¸ªè§„å¾‹ï¼Œï¼š\nè‹¥ä¸¤ä¸ªç»„ä»¶å±äºåŒä¸€ä¸ªç±»å‹ï¼Œé‚£ä¹ˆå®ƒä»¬å°†æ‹¥æœ‰ç›¸åŒçš„ DOM æ ‘å½¢ç»“æ„ï¼› å¤„äºåŒä¸€å±‚çº§çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œå¯ç”¨é€šè¿‡è®¾ç½® key ä½œä¸ºå”¯ä¸€æ ‡è¯†ï¼Œä»è€Œç»´æŒå„ä¸ªèŠ‚ç‚¹åœ¨ä¸åŒæ¸²æŸ“è¿‡ç¨‹ä¸­çš„ç¨³å®šæ€§ã€‚ é™¤äº†è¿™ä¸¤ä¸ªâ€œæ¿ä¸Šé’‰é’‰â€çš„è§„å¾‹ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå’Œå®è·µç»“åˆæ¯”è¾ƒç´§å¯†çš„è§„å¾‹ï¼Œå®ƒä¸º React å®ç°é«˜æ•ˆçš„ Diff æä¾›äº†çµæ„Ÿï¼šDOM èŠ‚ç‚¹ä¹‹é—´çš„è·¨å±‚çº§æ“ä½œå¹¶ä¸å¤šï¼ŒåŒå±‚çº§æ“ä½œæ˜¯ä¸»æµã€‚\næŠŠæ¡ä¸‰ä¸ªâ€œè¦ç‚¹â€ï¼Œå›¾è§£ Diff é€»è¾‘ 1. æ”¹å˜æ—¶é—´å¤æ‚åº¦é‡çº§çš„å†³å®šæ€§æ€è·¯ï¼šåˆ†å±‚å¯¹æ¯” ç»“åˆâ€œDOM èŠ‚ç‚¹ä¹‹é—´çš„è·¨å±‚çº§æ“ä½œå¹¶ä¸å¤šï¼ŒåŒå±‚çº§æ“ä½œæ˜¯ä¸»æµâ€è¿™ä¸€è§„å¾‹ï¼ŒReact çš„ Diff è¿‡ç¨‹ç›´æ¥æ”¾å¼ƒäº†è·¨å±‚çº§çš„èŠ‚ç‚¹æ¯”è¾ƒï¼Œå®ƒåªé’ˆå¯¹ç›¸åŒå±‚çº§çš„èŠ‚ç‚¹ä½œå¯¹æ¯”ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™æ ·ä¸€æ¥ï¼Œåªéœ€è¦ä»ä¸Šåˆ°ä¸‹çš„ä¸€æ¬¡éå†ï¼Œå°±å¯ä»¥å®Œæˆå¯¹æ•´æ£µæ ‘çš„å¯¹æ¯”ï¼Œè¿™æ˜¯é™ä½å¤æ‚åº¦é‡çº§æ–¹é¢çš„ä¸€ä¸ªæœ€é‡è¦çš„è®¾è®¡ã€‚\néœ€è¦æ³¨æ„çš„æ˜¯ï¼šè™½ç„¶æ ˆè°ƒå’Œå°†ä¼ ç»Ÿçš„æ ‘å¯¹æ¯”ç®—æ³•ä¼˜åŒ–ä¸ºäº†åˆ†å±‚å¯¹æ¯”ï¼Œä½†æ•´ä¸ªç®—æ³•ä»ç„¶æ˜¯ä»¥é€’å½’çš„å½¢å¼è¿è½¬çš„ï¼Œåˆ†å±‚é€’å½’ä¹Ÿæ˜¯é€’å½’\né‚£ä¹ˆå¦‚æœçœŸçš„å‘ç”Ÿäº†è·¨å±‚çº§çš„èŠ‚ç‚¹æ“ä½œï¼ˆæ¯”å¦‚å°†ä»¥ B èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ä» A èŠ‚ç‚¹ä¸‹é¢ç§»åŠ¨åˆ° C èŠ‚ç‚¹ä¸‹é¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ä¼šæ€æ ·å‘¢ï¼Ÿå¾ˆé—æ†¾ï¼Œä½œä¸ºâ€œæ¬¡è¦çŸ›ç›¾â€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ React å¹¶ä¸èƒ½å¤Ÿåˆ¤æ–­å‡ºâ€œç§»åŠ¨â€è¿™ä¸ªè¡Œä¸ºï¼Œå®ƒåªèƒ½æœºæ¢°åœ°è®¤ä¸ºç§»å‡ºå­æ ‘é‚£ä¸€å±‚çš„ç»„ä»¶æ¶ˆå¤±äº†ï¼Œå¯¹åº”å­æ ‘éœ€è¦è¢«é”€æ¯ï¼›è€Œç§»å…¥å­æ ‘çš„é‚£ä¸€å±‚æ–°å¢äº†ä¸€ä¸ªç»„ä»¶ï¼Œéœ€è¦é‡æ–°ä¸ºå…¶åˆ›å»ºä¸€æ£µå­æ ‘ã€‚\né”€æ¯ + é‡å»ºçš„ä»£ä»·æ˜¯æ˜‚è´µçš„ï¼Œå› æ­¤ React å®˜æ–¹ä¹Ÿå»ºè®®å¼€å‘è€…ä¸è¦åšè·¨å±‚çº§çš„æ“ä½œï¼Œå°½é‡ä¿æŒ DOM ç»“æ„çš„ç¨³å®šæ€§ã€‚\n2. å‡å°‘é€’å½’çš„â€œä¸€åˆ€åˆ‡â€ç­–ç•¥ï¼šç±»å‹çš„ä¸€è‡´æ€§å†³å®šé€’å½’çš„å¿…è¦æ€§ ç»“åˆâ€œè‹¥ä¸¤ä¸ªç»„ä»¶å±äºåŒä¸€ä¸ªç±»å‹ï¼Œé‚£ä¹ˆå®ƒä»¬å°†æ‹¥æœ‰ç›¸åŒçš„ DOM æ ‘å½¢ç»“æ„â€è¿™ä¸€è§„å¾‹ï¼Œæˆ‘ä»¬è™½ä¸èƒ½ç›´æ¥åæ¨å‡ºâ€œä¸åŒç±»å‹çš„ç»„ä»¶ DOM ç»“æ„ä¸åŒâ€ï¼Œä½†åœ¨å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªç»“è®ºéƒ½æ˜¯æˆç«‹çš„ã€‚æ¯•ç«Ÿï¼Œå®é™…å¼€å‘ä¸­é‡åˆ°ä¸¤ä¸ª DOM ç»“æ„å®Œå…¨ä¸€è‡´ã€è€Œç±»å‹ä¸ä¸€è‡´çš„ç»„ä»¶çš„æ¦‚ç‡ç¡®å®å¤ªä½äº†ã€‚\næœ¬ç€æŠ“â€œä¸»è¦çŸ›ç›¾â€çš„åŸºæœ¬åŸåˆ™ï¼ŒReact è®¤ä¸ºï¼Œåªæœ‰åŒç±»å‹çš„ç»„ä»¶ï¼Œæ‰æœ‰è¿›ä¸€æ­¥å¯¹æ¯”çš„å¿…è¦æ€§ï¼›è‹¥å‚ä¸ Diff çš„ä¸¤ä¸ªç»„ä»¶ç±»å‹ä¸åŒï¼Œé‚£ä¹ˆç›´æ¥æ”¾å¼ƒæ¯”è¾ƒï¼ŒåŸåœ°æ›¿æ¢æ‰æ—§çš„èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚åªæœ‰ç¡®è®¤ç»„ä»¶ç±»å‹ç›¸åŒåï¼ŒReact æ‰ä¼šåœ¨ä¿ç•™ç»„ä»¶å¯¹åº” DOM æ ‘ï¼ˆæˆ–å­æ ‘ï¼‰çš„åŸºç¡€ä¸Šï¼Œå°è¯•å‘æ›´æ·±å±‚æ¬¡å» Diffã€‚\nè¿™æ ·ä¸€æ¥ï¼Œä¾¿èƒ½å¤Ÿä»å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘ Diff è¿‡ç¨‹ä¸­å†—ä½™çš„é€’å½’æ“ä½œã€‚\n3. é‡ç”¨èŠ‚ç‚¹çš„å¥½å¸®æ‰‹ï¼škey å±æ€§å¸® React â€œè®°ä½â€èŠ‚ç‚¹ key æ˜¯ç”¨æ¥å¸®åŠ© React è¯†åˆ«å“ªäº›å†…å®¹è¢«æ›´æ”¹ã€æ·»åŠ æˆ–è€…åˆ é™¤ã€‚key éœ€è¦å†™åœ¨ç”¨æ•°ç»„æ¸²æŸ“å‡ºæ¥çš„å…ƒç´ å†…éƒ¨ï¼Œå¹¶ä¸”éœ€è¦èµ‹äºˆå…¶ä¸€ä¸ªç¨³å®šçš„å€¼ã€‚ç¨³å®šåœ¨è¿™é‡Œå¾ˆé‡è¦ï¼Œå› ä¸ºå¦‚æœ key å€¼å‘ç”Ÿäº†å˜æ›´ï¼ŒReact åˆ™ä¼šè§¦å‘ UI çš„é‡æ¸²æŸ“ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ã€‚ â€”â€”â€” React å¯¹ key çš„å®šä¹‰\nå®ƒè¯•å›¾è§£å†³çš„æ˜¯åŒä¸€å±‚çº§ä¸‹èŠ‚ç‚¹çš„é‡ç”¨é—®é¢˜ã€‚åœ¨å±•å¼€åˆ†æä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç»“åˆåˆ°ç°åœ¨ä¸ºæ­¢å¯¹ Diff è¿‡ç¨‹çš„ç†è§£ï¼Œæ¥æ€è€ƒè¿™æ ·ä¸€ç§æƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nå›¾ä¸­ A ç»„ä»¶åœ¨ä¿æŒç±»å‹å’Œå…¶ä»–å±æ€§å‡ä¸å˜çš„æƒ…å†µä¸‹ï¼Œåœ¨ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼ˆB å’Œ Dï¼‰ä¹‹é—´æ’å…¥äº†ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼ˆCï¼‰ã€‚æŒ‰ç…§å·²çŸ¥çš„ Diff åŸåˆ™ï¼Œä¸¤æ£µæ ‘ä¹‹é—´çš„ Diff è¿‡ç¨‹åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š\né¦–å…ˆå¯¹æ¯”ä½äºç¬¬ 1 å±‚çš„èŠ‚ç‚¹ï¼Œå‘ç°ä¸¤æ£µæ ‘çš„èŠ‚ç‚¹ç±»å‹æ˜¯ä¸€è‡´çš„ï¼ˆéƒ½æ˜¯ Aï¼‰ï¼Œäºæ˜¯è¿›ä¸€æ­¥ Diffï¼› å¼€å§‹å¯¹æ¯”ä½äºç¬¬ 2 å±‚çš„èŠ‚ç‚¹ï¼Œç¬¬ 1 ä¸ªæ¥å—æ¯”è¾ƒçš„æ˜¯ B è¿™ä¸ªä½ç½®ï¼Œå¯¹æ¯”ä¸‹æ¥å‘ç°ä¸¤æ£µæ ‘è¿™ä¸ªä½ç½®ä¸Šçš„èŠ‚ç‚¹éƒ½æ˜¯ Bï¼Œæ²¡æ¯›ç—…ï¼Œæ”¾è¿‡å®ƒï¼› ç¬¬ 2 ä¸ªæ¥å—æ¯”è¾ƒçš„æ˜¯ D è¿™ä¸ªä½ç½®ï¼Œå¯¹æ¯” D å’Œ Cï¼Œå‘ç°å‰åçš„ç±»å‹ä¸ä¸€è‡´ï¼Œç›´æ¥åˆ æ‰ D é‡å»º Cï¼› ç¬¬ 3 ä¸ªæ¥å—æ¯”è¾ƒçš„æ˜¯ E è¿™ä¸ªä½ç½®ï¼Œå¯¹æ¯” E å’Œ Dï¼Œå‘ç°å‰åçš„ç±»å‹ä¸ä¸€è‡´ï¼Œç›´æ¥åˆ æ‰ E é‡å»º Dï¼› æœ€åæ¥å—â€œæ¯”è¾ƒâ€çš„æ˜¯æ ‘ 2 çš„ E èŠ‚ç‚¹è¿™ä¸ªä½ç½®ï¼Œè¿™ä¸ªä½ç½®åœ¨æ ‘ 1 é‡Œæ˜¯ç©ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ ‘ 2 çš„ E æ˜¯ä¸€ä¸ªæ–°å¢èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ–°å¢ä¸€ä¸ª Eã€‚ å¥‡æ€ªçš„äº‹æƒ…å‘ç”Ÿäº†ï¼šCã€Dã€E ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå…¶å®éƒ½æ˜¯å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨çš„ã€‚åŸæœ¬æ–°å¢ 1 ä¸ªèŠ‚ç‚¹å°±èƒ½æå®šçš„äº‹æƒ…ï¼Œç°åœ¨å´åˆæ˜¯åˆ é™¤åˆæ˜¯é‡å»ºåœ°æäº†åŠå¤©ï¼Œè€Œä¸”è¿™ä¸ªè ¢æ“ä½œå’Œè·¨å±‚çº§ç§»åŠ¨èŠ‚ç‚¹è¿˜ä¸å¤ªä¸€æ ·ï¼Œåè€…æœ¬æ¥å°±å±äºä½é¢‘æ“ä½œï¼ŒåŠ ä»¥åˆç†çš„æœ€ä½³å®è·µçº¦æŸä¸€ä¸‹åŸºæœ¬ä¸Šå¯ä»¥å®Œå…¨è§„é¿æ‰ï¼›ä½†å›¾ç¤ºçš„è¿™ç§æ’å…¥èŠ‚ç‚¹çš„å½¢å¼æ˜¯é«˜é¢‘æ“ä½œã€‚é¢‘ç¹å¢åˆ èŠ‚ç‚¹å¿…å®šæ‹–å®æ€§èƒ½ï¼Œè¿™æ—¶å€™å°±éœ€è¦è¯·å‡º key å±æ€§æ¥å¸®æˆ‘ä»¬é‡ç”¨èŠ‚ç‚¹äº†ã€‚\nkey å±æ€§çš„å½¢å¼ï¼Œæˆ‘ä»¬è‚¯å®šéƒ½ä¸é™Œç”Ÿã€‚åœ¨åŸºäºæ•°ç»„åŠ¨æ€ç”ŸæˆèŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šç»™æ¯ä¸ªèŠ‚ç‚¹åŠ è£…ä¸€ä¸ª key å±æ€§ï¼ˆä¸‹é¢æ˜¯ä¸€æ®µä»£ç ç¤ºä¾‹ï¼‰ï¼š\n1 const todoItems = todos.map((todo) =\u0026gt; \u0026lt;li key={todo.id}\u0026gt;{todo.text}\u0026lt;/li\u0026gt;); å¦‚æœä½ å¿˜è®°å†™ keyï¼ŒReact è™½ç„¶ä¸è‡³äºå› æ­¤æŠ¥é”™ï¼Œä½†æ§åˆ¶å°æ ‡çº¢æ˜¯éš¾å…çš„ï¼Œå®ƒä¼šç»™ä½ æŠ›å‡ºä¸€ä¸ªâ€œè¯·ç»™åˆ—è¡¨å…ƒç´ è¡¥é½ key å±æ€§â€çš„ warningï¼Œè¿™ä¸ªå¸¸è§çš„ warning ä¹Ÿä»ä¾§é¢åæ˜ å‡ºäº† key çš„é‡è¦æ€§ã€‚äº‹å®ä¸Šï¼Œå½“æˆ‘ä»¬æ²¡æœ‰è®¾å®š key å€¼çš„æ—¶å€™ï¼ŒDiff çš„è¿‡ç¨‹å°±æ­£å¦‚ä¸Šæ–‡æ‰€æè¿°çš„ä¸€æ ·æƒ¨çƒˆã€‚ä½†åªè¦ä½ æŒ‰ç…§è§„èŒƒåŠ è£…ä¸€ä¸ªåˆé€‚çš„ keyï¼Œè¿™ä¸ª key å°±ä¼šåƒä¸€ä¸ªè®°å·ä¸€æ ·ï¼Œå¸®åŠ© React â€œè®°ä½â€æŸä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œåœ¨åç»­çš„æ›´æ–°ä¸­å®ç°å¯¹è¿™ä¸ªèŠ‚ç‚¹çš„è¿½è¸ªã€‚æ¯”å¦‚è¯´åˆšåˆšé‚£æ£µè™šæ‹Ÿ DOM æ ‘ï¼Œè‹¥æˆ‘ä»¬ç»™ä½äºç¬¬ 2 å±‚çš„æ¯ä¸€ä¸ªå­èŠ‚ç‚¹ä¸€ä¸ª key å€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nè¿™ä¸ª key å°±å……å½“äº†æ¯ä¸ªèŠ‚ç‚¹çš„ IDï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰ï¼Œæœ‰äº†è¿™ä¸ªæ ‡è¯†ä¹‹åï¼Œå½“ C è¢«æ’å…¥åˆ° B å’Œ D ä¹‹é—´æ—¶ï¼ŒReact å¹¶ä¸ä¼šå†è®¤ä¸º Cã€Dã€E è¿™ä¸‰ä¸ªå‘ä½éƒ½éœ€è¦è¢«é‡å»ºâ€”â€”å®ƒä¼šé€šè¿‡è¯†åˆ« IDï¼Œæ„è¯†åˆ° D å’Œ E å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼ˆD çš„ ID ä»ç„¶æ˜¯ 1ï¼ŒE çš„ ID ä»ç„¶æ˜¯ 2ï¼‰ï¼Œè€Œåªæ˜¯è¢«è°ƒæ•´äº†é¡ºåºè€Œå·²ã€‚æ¥ç€ï¼ŒReact ä¾¿èƒ½å¤Ÿè½»æ¾åœ°é‡ç”¨å®ƒâ€œè¿½è¸ªâ€åˆ°æ—§çš„èŠ‚ç‚¹ï¼Œå°† D å’Œ E è½¬ç§»åˆ°æ–°çš„ä½ç½®ï¼Œå¹¶å®Œæˆå¯¹ C çš„æ’å…¥ã€‚è¿™æ ·ä¸€æ¥ï¼ŒåŒå±‚çº§ä¸‹å…ƒç´ çš„æ“ä½œæˆæœ¬ä¾¿å¤§å¤§é™ä½ã€‚\nä½œä¸ºä¸€ä¸ªèŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ï¼Œåœ¨ä½¿ç”¨ key ä¹‹å‰ï¼Œè¯·åŠ¡å¿…ç¡®è®¤ key çš„å”¯ä¸€å’Œç¨³å®šã€‚\n","permalink":"https://zzydev.top/posts/headfirstreact/7_react%E4%B8%AD%E7%9A%84%E6%A0%88%E8%B0%83%E5%92%8C%E8%BF%87%E7%A8%8B%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84/","summary":"è°ƒå’Œï¼ˆReconciliationï¼‰è¿‡ç¨‹ä¸ Diff ç®—æ³• Virtual DOM æ˜¯ä¸€ç§ç¼–ç¨‹æ¦‚å¿µã€‚åœ¨è¿™ä¸ªæ¦‚å¿µé‡Œï¼ŒUI ä»¥ä¸€ç§ç†æƒ³åŒ–çš„ï¼Œæˆ–è€…è¯´â€œè™šæ‹Ÿçš„â€è¡¨ç°å½¢å¼è¢«ä¿å­˜äºå†…å­˜ä¸­","title":"7.Reactä¸­çš„æ ˆè°ƒå’Œè¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ"},{"content":"React ä¸­çš„è™šæ‹Ÿ DOM å¤§è‡´æ˜¯å¦‚ä½•å·¥ä½œçš„? æŒ‚è½½é˜¶æ®µï¼ŒReact å°†ç»“åˆ JSX çš„æè¿°ï¼Œæ„å»ºå‡ºè™šæ‹Ÿ DOM æ ‘ï¼Œç„¶åé€šè¿‡ ReactDOM.render å®ç°è™šæ‹Ÿ DOM åˆ°çœŸå® DOM çš„æ˜ å°„ï¼ˆè§¦å‘æ¸²æŸ“æµæ°´çº¿ï¼‰ï¼›\næ›´æ–°é˜¶æ®µï¼Œé¡µé¢çš„å˜åŒ–åœ¨ä½œç”¨äºçœŸå® DOM ä¹‹å‰ï¼Œä¼šå…ˆä½œç”¨äºè™šæ‹Ÿ DOMï¼Œè™šæ‹Ÿ DOM å°†åœ¨ JS å±‚å€ŸåŠ©ç®—æ³•å…ˆå¯¹æ¯”å‡ºå…·ä½“æœ‰å“ªäº›çœŸå® DOM éœ€è¦è¢«æ”¹å˜ï¼Œç„¶åå†å°†è¿™äº›æ”¹å˜ä½œç”¨äºçœŸå® DOM\næ¨¡æ¿å¼•æ“ä¸è™šæ‹Ÿ DOM æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ æ¨¡æ¿å¼•æ“çš„æ›´æ–°æ–¹å¼æ˜¯å°†å·²ç»æ¸²æŸ“å‡ºæ¥çš„ DOM æ•´ä½“æ³¨é”€åæ•´ä½“é‡æ–°æ¸²æŸ“ã€‚\nVDOM çš„åŒºåˆ«å°±åœ¨äºå¤šå‡ºäº†ä¸€å±‚è™šæ‹Ÿ DOM ä½œä¸ºç¼“å†²å±‚ã€‚è¿™ä¸ªç¼“å†²å±‚å¸¦æ¥çš„åˆ©å¥½æ˜¯ï¼šå½“ DOM æ“ä½œï¼ˆæ¸²æŸ“æ›´æ–°ï¼‰æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œå®ƒä¼šå…ˆå°†å‰åä¸¤æ¬¡çš„è™šæ‹Ÿ DOM æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œå®šä½å‡ºå…·ä½“éœ€è¦æ›´æ–°çš„éƒ¨åˆ†ï¼Œç”Ÿæˆä¸€ä¸ªâ€œè¡¥ä¸é›†â€ï¼Œæœ€ååªæŠŠâ€œè¡¥ä¸â€æ‰“åœ¨éœ€è¦æ›´æ–°çš„é‚£éƒ¨åˆ†çœŸå® DOM ä¸Šï¼Œå®ç°ç²¾å‡†çš„â€œå·®é‡æ›´æ–°â€ã€‚è¿™ä¸ªè¿‡ç¨‹å¯¹åº”çš„è™šæ‹Ÿ DOM å·¥ä½œæµå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nReact é€‰ç”¨è™šæ‹Ÿ DOMï¼ŒçœŸçš„æ˜¯ä¸ºäº†æ›´å¥½çš„æ€§èƒ½å—ï¼Ÿ\nè™šæ‹Ÿ DOM çš„ä¼˜è¶Šä¹‹å¤„åœ¨äºï¼Œå®ƒèƒ½å¤Ÿåœ¨æä¾›æ›´çˆ½ã€æ›´é«˜æ•ˆçš„ç ”å‘æ¨¡å¼ï¼ˆä¹Ÿå°±æ˜¯å‡½æ•°å¼çš„ UI ç¼–ç¨‹æ–¹å¼ï¼‰çš„åŒæ—¶ï¼Œä»ç„¶ä¿æŒä¸€ä¸ªè¿˜ä¸é”™çš„æ€§èƒ½ã€‚\nè™šæ‹Ÿ DOM çš„åŠ£åŠ¿ä¸»è¦åœ¨äº JS è®¡ç®—çš„è€—æ—¶ï¼Œè€Œ DOM æ“ä½œçš„èƒ½è€—å’Œ JS è®¡ç®—çš„èƒ½è€—æ ¹æœ¬ä¸åœ¨ä¸€ä¸ªé‡çº§ã€‚\né‚£ä¹ˆè™šæ‹Ÿ DOM çš„ä»·å€¼åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ ç ”å‘ä½“éªŒ/ç ”å‘æ•ˆç‡çš„é—®é¢˜ï¼šè¿™ä¸€ç‚¹å‰é¢å·²ç»åå¤å¼ºè°ƒè¿‡ï¼ŒDOM æ“ä½œæ¨¡å¼çš„æ¯ä¸€æ¬¡é©æ–°ï¼ŒèƒŒåéƒ½æ˜¯å‰ç«¯å¯¹æ•ˆç‡å’Œä½“éªŒçš„è¿›ä¸€æ­¥è¿½æ±‚ã€‚è™šæ‹Ÿ DOM çš„å‡ºç°ï¼Œä¸ºæ•°æ®é©±åŠ¨è§†å›¾è¿™ä¸€æ€æƒ³æä¾›äº†é«˜åº¦å¯ç”¨çš„è½½ä½“ï¼Œä½¿å¾—å‰ç«¯å¼€å‘èƒ½å¤ŸåŸºäºå‡½æ•°å¼ UI çš„ç¼–ç¨‹æ–¹å¼å®ç°é«˜æ•ˆçš„å£°æ˜å¼ç¼–ç¨‹ã€‚ è·¨å¹³å°çš„é—®é¢˜ï¼šè™šæ‹Ÿ DOM æ˜¯å¯¹çœŸå®æ¸²æŸ“å†…å®¹çš„ä¸€å±‚æŠ½è±¡ã€‚è‹¥æ²¡æœ‰è¿™ä¸€å±‚æŠ½è±¡ï¼Œé‚£ä¹ˆè§†å›¾å±‚å°†å’Œæ¸²æŸ“å¹³å°ç´§å¯†è€¦åˆåœ¨ä¸€èµ·ï¼Œä¸ºäº†æè¿°åŒæ ·çš„è§†å›¾å†…å®¹ï¼Œä½ å¯èƒ½è¦åˆ†åˆ«åœ¨ Web ç«¯å’Œ Native ç«¯å†™å®Œå…¨ä¸åŒçš„ä¸¤å¥—ç”šè‡³å¤šå¥—ä»£ç ã€‚ä½†ç°åœ¨ä¸­é—´å¤šäº†ä¸€å±‚æè¿°æ€§çš„è™šæ‹Ÿ DOMï¼Œå®ƒæè¿°çš„ä¸œè¥¿å¯ä»¥æ˜¯çœŸå® DOMï¼Œä¹Ÿå¯ä»¥æ˜¯ iOS ç•Œé¢ã€å®‰å“ç•Œé¢ã€å°ç¨‹åº\u0026hellip;\u0026hellip;åŒä¸€å¥—è™šæ‹Ÿ DOMï¼Œå¯ä»¥å¯¹æ¥ä¸åŒå¹³å°çš„æ¸²æŸ“é€»è¾‘ï¼Œä»è€Œå®ç°â€œä¸€æ¬¡ç¼–ç ï¼Œå¤šç«¯è¿è¡Œâ€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å…¶å®è¯´åˆ°åº•ï¼Œè·¨å¹³å°ä¹Ÿæ˜¯ç ”å‘ææ•ˆçš„ä¸€ç§æ‰‹æ®µï¼Œå®ƒåœ¨æ€æƒ³ä¸Šå’Œ 1 æ˜¯é«˜åº¦å‘¼åº”çš„ã€‚ ","permalink":"https://zzydev.top/posts/headfirstreact/6_%E7%9C%9F%E6%AD%A3%E7%90%86%E8%A7%A3%E8%99%9A%E6%8B%9Fdomreact%E9%80%89%E5%AE%83%E6%98%AF%E5%9B%A0%E4%B8%BA%E6%80%A7%E8%83%BD%E5%90%97/","summary":"React ä¸­çš„è™šæ‹Ÿ DOM å¤§è‡´æ˜¯å¦‚ä½•å·¥ä½œçš„? æŒ‚è½½é˜¶æ®µï¼ŒReact å°†ç»“åˆ JSX çš„æè¿°ï¼Œæ„å»ºå‡ºè™šæ‹Ÿ DOM æ ‘ï¼Œç„¶åé€šè¿‡ ReactDOM.render å®ç°è™šæ‹Ÿ DOM åˆ°çœŸå® DOM çš„æ˜ å°„ï¼ˆè§¦å‘æ¸²æŸ“æµæ°´çº¿ï¼‰ï¼› æ›´æ–°","title":"6.Reactæ˜¯ä¸ºäº†æ›´å¥½çš„æ€§èƒ½é€‰æ‹©è™šæ‹ŸDOMå—"},{"content":" React å›¢é˜Ÿé¢å‘å¼€å‘è€…ç»™å‡ºäº†ä¸¤æ¡ React-Hooks çš„ä½¿ç”¨åŸåˆ™ï¼ŒåŸåˆ™çš„å†…å®¹å¦‚ä¸‹ï¼š\nåªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hooksï¼› ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hooksã€‚ åŸåˆ™ 2 ä¸­å¼ºè°ƒçš„æ‰€æœ‰â€œä¸è¦â€ï¼Œéƒ½æ˜¯åœ¨æŒ‡å‘åŒä¸€ä¸ªç›®çš„ï¼Œé‚£å°±æ˜¯è¦ç¡®ä¿ Hooks åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¿æŒåŒæ ·çš„æ‰§è¡Œé¡ºåºã€‚ PersonalInfoComponent é‡Œå»ï¼Œçœ‹çœ‹å®é™…é¡¹ç›®ä¸­ï¼Œå˜é‡åˆ°åº•æ˜¯æ€ä¹ˆå‘ç”Ÿå˜åŒ–çš„ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 import React, { useState } from \u0026#34;react\u0026#34;; // isMounted ç”¨äºè®°å½•æ˜¯å¦å·²æŒ‚è½½ï¼ˆæ˜¯å¦æ˜¯é¦–æ¬¡æ¸²æŸ“ï¼‰ let isMounted = false; function PersonalInfoComponent() { // å®šä¹‰å˜é‡çš„é€»è¾‘ä¸å˜ let name, age, career, setName, setCareer; // è¿™é‡Œè¿½åŠ å¯¹ isMounted çš„è¾“å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ª debug æ€§è´¨çš„æ“ä½œ console.log(\u0026#34;isMounted is\u0026#34;, isMounted); // è¿™é‡Œè¿½åŠ  if é€»è¾‘ï¼šåªæœ‰åœ¨é¦–æ¬¡æ¸²æŸ“ï¼ˆç»„ä»¶è¿˜æœªæŒ‚è½½ï¼‰æ—¶ï¼Œæ‰è·å– nameã€age ä¸¤ä¸ªçŠ¶æ€ if (!isMounted) { // eslint-disable-next-line [name, setName] = useState(\u0026#34;zzy\u0026#34;); // eslint-disable-next-line [age] = useState(\u0026#34;99\u0026#34;); // if å†…éƒ¨çš„é€»è¾‘æ‰§è¡Œä¸€æ¬¡åï¼Œå°±å°† isMounted ç½®ä¸º trueï¼ˆè¯´æ˜å·²æŒ‚è½½ï¼Œåç»­éƒ½ä¸å†æ˜¯é¦–æ¬¡æ¸²æŸ“äº†ï¼‰ isMounted = true; } // å¯¹èŒä¸šä¿¡æ¯çš„è·å–é€»è¾‘ä¸å˜ [career, setCareer] = useState(\u0026#34;æˆ‘æ˜¯ä¸€ä¸ªå‰ç«¯ï¼Œçˆ±åƒå°ç†Šé¥¼å¹²\u0026#34;); // è¿™é‡Œè¿½åŠ å¯¹ career çš„è¾“å‡ºï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ª debug æ€§è´¨çš„æ“ä½œ console.log(\u0026#34;career\u0026#34;, career); // UI é€»è¾‘çš„æ”¹åŠ¨åœ¨äºï¼Œname å’Œ age æˆäº†å¯é€‰çš„å±•ç¤ºé¡¹ï¼Œè‹¥å€¼ä¸ºç©ºï¼Œåˆ™ä¸å±•ç¤º return ( \u0026lt;div className=\u0026#34;personalInfo\u0026#34;\u0026gt; {name ? \u0026lt;p\u0026gt;å§“åï¼š{name}\u0026lt;/p\u0026gt; : null} {age ? \u0026lt;p\u0026gt;å¹´é¾„ï¼š{age}\u0026lt;/p\u0026gt; : null} \u0026lt;p\u0026gt;èŒä¸šï¼š{career}\u0026lt;/p\u0026gt; \u0026lt;button onClick={() =\u0026gt; { setName(\u0026#34;å””çŸ¥\u0026#34;); }} \u0026gt; ä¿®æ”¹å§“å \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); } export default PersonalInfoComponent; Hooks çš„æ­£å¸¸è¿ä½œï¼Œåœ¨åº•å±‚ä¾èµ–äºé¡ºåºé“¾è¡¨ ä»¥ useState ä¸ºä¾‹ï¼Œåˆ†æ React-Hooks çš„è°ƒç”¨é“¾è·¯ åœ¨è¿™ä¸ªæµç¨‹ä¸­ï¼ŒuseState è§¦å‘çš„ä¸€ç³»åˆ—æ“ä½œæœ€åä¼šè½åˆ° mountState é‡Œé¢å»ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹éœ€è¦å…³æ³¨çš„å°±æ˜¯ mountState åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 // è¿›å…¥ mounState é€»è¾‘ function mountState(initialState) { // å°†æ–°çš„ hook å¯¹è±¡è¿½åŠ è¿›é“¾è¡¨å°¾éƒ¨ var hook = mountWorkInProgressHook(); // initialState å¯ä»¥æ˜¯ä¸€ä¸ªå›è°ƒï¼Œè‹¥æ˜¯å›è°ƒï¼Œåˆ™å–å›è°ƒæ‰§è¡Œåçš„å€¼ if (typeof initialState === \u0026#34;function\u0026#34;) { // $FlowFixMe: Flow doesn\u0026#39;t like mixed types initialState = initialState(); } // åˆ›å»ºå½“å‰ hook å¯¹è±¡çš„æ›´æ–°é˜Ÿåˆ—ï¼Œè¿™ä¸€æ­¥ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿä¾åºä¿ç•™ dispatch const queue = (hook.queue = { last: null, dispatch: null, lastRenderedReducer: basicStateReducer, lastRenderedState: (initialState: any), }); // å°† initialState ä½œä¸ºä¸€ä¸ªâ€œè®°å¿†å€¼â€å­˜ä¸‹æ¥ hook.memoizedState = hook.baseState = initialState; // dispatch æ˜¯ç”±ä¸Šä¸‹æ–‡ä¸­ä¸€ä¸ªå« dispatchAction çš„æ–¹æ³•åˆ›å»ºçš„ï¼Œè¿™é‡Œä¸å¿…çº ç»“è¿™ä¸ªæ–¹æ³•å…·ä½“åšäº†ä»€ä¹ˆ var dispatch = (queue.dispatch = dispatchAction.bind( null, currentlyRenderingFiber$1, queue )); // è¿”å›ç›®æ ‡æ•°ç»„ï¼Œdispatch å…¶å®å°±æ˜¯ç¤ºä¾‹ä¸­å¸¸å¸¸è§åˆ°çš„ setXXX è¿™ä¸ªå‡½æ•°ï¼Œæƒ³ä¸åˆ°å§ï¼Ÿå“ˆå“ˆ return [hook.memoizedState, dispatch]; } ä»è¿™æ®µæºç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒmounState çš„ä¸»è¦å·¥ä½œæ˜¯åˆå§‹åŒ– Hooksã€‚åœ¨æ•´æ®µæºç ä¸­ï¼Œæœ€éœ€è¦å…³æ³¨çš„æ˜¯ mountWorkInProgressHook æ–¹æ³•ï¼Œå®ƒä¸ºæˆ‘ä»¬é“å‡ºäº† Hooks èƒŒåçš„æ•°æ®ç»“æ„ç»„ç»‡å½¢å¼ã€‚ä»¥ä¸‹æ˜¯ mountWorkInProgressHook æ–¹æ³•çš„æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 function mountWorkInProgressHook() { // æ³¨æ„ï¼Œå•ä¸ª hook æ˜¯ä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨çš„ var hook = { memoizedState: null, baseState: null, baseQueue: null, queue: null, next: null, }; if (workInProgressHook === null) { // è¿™è¡Œä»£ç æ¯ä¸ª React ç‰ˆæœ¬ä¸å¤ªä¸€æ ·ï¼Œä½†åšçš„éƒ½æ˜¯åŒä¸€ä»¶äº‹ï¼šå°† hook ä½œä¸ºé“¾è¡¨çš„å¤´èŠ‚ç‚¹å¤„ç† firstWorkInProgressHook = workInProgressHook = hook; } else { // è‹¥é“¾è¡¨ä¸ä¸ºç©ºï¼Œåˆ™å°† hook è¿½åŠ åˆ°é“¾è¡¨å°¾éƒ¨ workInProgressHook = workInProgressHook.next = hook; } // è¿”å›å½“å‰çš„ hook return workInProgressHook; } åˆ°è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œhook ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯æ”¶æ•›åœ¨ä¸€ä¸ª hook å¯¹è±¡é‡Œï¼Œè€Œ hook å¯¹è±¡ä¹‹é—´ä»¥å•å‘é“¾è¡¨çš„å½¢å¼ç›¸äº’ä¸²è”ã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬å†çœ‹æ›´æ–°è¿‡ç¨‹çš„å¤§å›¾ï¼š\næ ¹æ®å›¾ä¸­é«˜äº®éƒ¨åˆ†çš„æç¤ºä¸éš¾çœ‹å‡ºï¼Œé¦–æ¬¡æ¸²æŸ“å’Œæ›´æ–°æ¸²æŸ“çš„åŒºåˆ«ï¼Œåœ¨äºè°ƒç”¨çš„æ˜¯ mountStateï¼Œè¿˜æ˜¯ updateStateã€‚mountState åšäº†ä»€ä¹ˆï¼Œä½ å·²ç»éå¸¸æ¸…æ¥šäº†ï¼›è€Œ updateState ä¹‹åçš„æ“ä½œé“¾è·¯ï¼Œè™½ç„¶æ¶‰åŠçš„ä»£ç æœ‰å¾ˆå¤šï¼Œä½†å…¶å®åšçš„äº‹æƒ…å¾ˆå®¹æ˜“ç†è§£ï¼šæŒ‰é¡ºåºå»éå†ä¹‹å‰æ„å»ºå¥½çš„é“¾è¡¨ï¼Œå–å‡ºå¯¹åº”çš„æ•°æ®ä¿¡æ¯è¿›è¡Œæ¸²æŸ“ã€‚\næˆ‘ä»¬æŠŠ mountState å’Œ updateState åšçš„äº‹æƒ…æ”¾åœ¨ä¸€èµ·æ¥çœ‹ï¼šmountStateï¼ˆé¦–æ¬¡æ¸²æŸ“ï¼‰æ„å»ºé“¾è¡¨å¹¶æ¸²æŸ“ï¼›updateState ä¾æ¬¡éå†é“¾è¡¨å¹¶æ¸²æŸ“ã€‚\nçœ‹åˆ°è¿™é‡Œï¼Œä½ æ˜¯ä¸æ˜¯å·²ç»å¤§æ¦‚çŸ¥é“æ€ä¹ˆå›äº‹å„¿äº†ï¼Ÿæ²¡é”™ï¼Œhooks çš„æ¸²æŸ“æ˜¯é€šè¿‡â€œä¾æ¬¡éå†â€æ¥å®šä½æ¯ä¸ª hooks å†…å®¹çš„ã€‚å¦‚æœå‰åä¸¤æ¬¡è¯»åˆ°çš„é“¾è¡¨åœ¨é¡ºåºä¸Šå‡ºç°å·®å¼‚ï¼Œé‚£ä¹ˆæ¸²æŸ“çš„ç»“æœè‡ªç„¶æ˜¯ä¸å¯æ§çš„ã€‚\nè¿™ä¸ªç°è±¡æœ‰ç‚¹åƒæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªé•¿åº¦ç¡®å®šçš„æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå‘ä½éƒ½å¯¹åº”ç€ä¸€å—ç¡®åˆ‡çš„ä¿¡æ¯ï¼Œåç»­æ¯æ¬¡ä»æ•°ç»„é‡Œå–å€¼çš„æ—¶å€™ï¼Œåªèƒ½å¤Ÿé€šè¿‡ç´¢å¼•ï¼ˆä¹Ÿå°±æ˜¯ä½ç½®ï¼‰æ¥å®šä½æ•°æ®ã€‚Hooks çš„æœ¬è´¨å…¶å®æ˜¯é“¾è¡¨ã€‚\nç«™åœ¨åº•å±‚è§†è§’ï¼Œé‡ç° PersonalInfoComponent ä»ä»£ç é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥æå–å‡ºæ¥çš„ useState è°ƒç”¨æœ‰ä¸‰ä¸ªï¼š\n1 2 3 [name, setName] = useState(\u0026#34;zzy\u0026#34;); [age] = useState(\u0026#34;99\u0026#34;); [career, setCareer] = useState(\u0026#34;æˆ‘æ˜¯ä¸€ä¸ªå‰ç«¯ï¼Œçˆ±åƒå°ç†Šé¥¼å¹²\u0026#34;); å½“é¦–æ¬¡æ¸²æŸ“ç»“æŸï¼Œè¿›è¡ŒäºŒæ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œå®é™…å‘ç”Ÿçš„ useState è°ƒç”¨åªæœ‰ä¸€ä¸ªï¼š\n1 useState(\u0026#34;æˆ‘æ˜¯ä¸€ä¸ªå‰ç«¯ï¼Œçˆ±åƒå°ç†Šé¥¼å¹²\u0026#34;); é“¾è¡¨æ­¤æ—¶çš„çŠ¶æ€å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\næ›´æ–°ï¼ˆäºŒæ¬¡æ¸²æŸ“ï¼‰çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼šupdateState ä¼šä¾æ¬¡éå†é“¾è¡¨ã€è¯»å–æ•°æ®å¹¶æ¸²æŸ“ã€‚æ³¨æ„è¿™ä¸ªè¿‡ç¨‹å°±åƒä»æ•°ç»„ä¸­ä¾æ¬¡å–å€¼ä¸€æ ·ï¼Œæ˜¯å®Œå…¨æŒ‰ç…§é¡ºåºï¼ˆæˆ–è€…è¯´ç´¢å¼•ï¼‰æ¥çš„ã€‚å› æ­¤ React ä¸ä¼šçœ‹ä½ å‘½åçš„å˜é‡åæ˜¯ career è¿˜æ˜¯åˆ«çš„ä»€ä¹ˆï¼Œå®ƒåªè®¤ä½ è¿™ä¸€æ¬¡ useState è°ƒç”¨ï¼Œäºæ˜¯å®ƒä¼šè®¤ä¸ºï¼šä½ æƒ³è¦çš„æ˜¯ç¬¬ä¸€ä¸ªä½ç½®çš„ hook ã€‚\nç„¶åå°±ä¼šæœ‰ä¸‹é¢è¿™æ ·çš„æ•ˆæœï¼š\n","permalink":"https://zzydev.top/posts/headfirstreact/5_%E6%B7%B1%E5%85%A5react-hooks%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/","summary":"React å›¢é˜Ÿé¢å‘å¼€å‘è€…ç»™å‡ºäº†ä¸¤æ¡ React-Hooks çš„ä½¿ç”¨åŸåˆ™ï¼ŒåŸåˆ™çš„å†…å®¹å¦‚ä¸‹ï¼š åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hooksï¼› ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hooksã€‚ åŸåˆ™ 2 ä¸­å¼ºè°ƒ","title":"5.æ·±å…¥React Hookså·¥ä½œæœºåˆ¶,Hooksæœ¬è´¨æ˜¯é“¾è¡¨"},{"content":"å‡½æ•°ç»„ä»¶ä¼šæ•è· render å†…éƒ¨çš„çŠ¶æ€ï¼Œè¿™æ˜¯ä¸¤ç±»ç»„ä»¶æœ€å¤§çš„ä¸åŒã€‚ React æ¡†æ¶çš„ä¸»è¦å·¥ä½œï¼Œå°±æ˜¯åŠæ—¶åœ°æŠŠå£°æ˜å¼çš„ä»£ç è½¬æ¢ä¸ºå‘½ä»¤å¼çš„ DOM æ“ä½œï¼ŒæŠŠæ•°æ®å±‚é¢çš„æè¿°æ˜ å°„åˆ°ç”¨æˆ·å¯è§çš„ UI å˜åŒ–ä¸­å»ã€‚è¿™å°±æ„å‘³ç€ä»åŸåˆ™ä¸Šæ¥è®²ï¼ŒReact çš„æ•°æ®åº”è¯¥æ€»æ˜¯ç´§ç´§åœ°å’Œæ¸²æŸ“ç»‘å®šåœ¨ä¸€èµ·çš„ï¼Œè€Œç±»ç»„ä»¶åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚\nå¦‚æœä½ åœ¨è¿™ä¸ªåœ¨çº¿ Demoä¸­å°è¯•ç‚¹å‡»åŸºäºç±»ç»„ä»¶å½¢å¼ç¼–å†™çš„ ProfilePage æŒ‰é’®å 3s å†…æŠŠç”¨æˆ·åˆ‡æ¢ä¸º Sophieï¼Œä½ å°±ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ•ˆæœï¼š\næ˜æ˜æˆ‘ä»¬æ˜¯åœ¨ Dan çš„ä¸»é¡µç‚¹å‡»çš„å…³æ³¨ï¼Œç»“æœå´æç¤ºäº†â€œFollowed Sophieâ€ï¼\nè¿™ä¸ªç°è±¡å¿…ç„¶è®©è®¸å¤šäººæ„Ÿåˆ°å›°æƒ‘ï¼šuser çš„å†…å®¹æ˜¯é€šè¿‡ props ä¸‹å‘çš„ï¼Œprops ä½œä¸ºä¸å¯å˜å€¼ï¼Œä¸ºä»€ä¹ˆä¼šä» Dan å˜æˆ Sophie å‘¢ï¼Ÿ\nå› ä¸ºè™½ç„¶ props æœ¬èº«æ˜¯ä¸å¯å˜çš„ï¼Œä½† this å´æ˜¯å¯å˜çš„ï¼Œthis ä¸Šçš„æ•°æ®æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼Œthis.props çš„è°ƒç”¨æ¯æ¬¡éƒ½ä¼šè·å–æœ€æ–°çš„ propsï¼Œè€Œè¿™æ­£æ˜¯ React ç¡®ä¿æ•°æ®å®æ—¶æ€§çš„ä¸€ä¸ªé‡è¦æ‰‹æ®µã€‚\nå¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨ React ç”Ÿå‘½å‘¨æœŸå¯¹æ‰§è¡Œé¡ºåºçš„è°ƒæ§ä¸‹ï¼Œthis.props å’Œ this.state çš„å˜åŒ–éƒ½èƒ½å¤Ÿå’Œé¢„æœŸä¸­çš„æ¸²æŸ“åŠ¨ä½œä¿æŒä¸€è‡´ã€‚ä½†åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ setTimeout å°†é¢„æœŸä¸­çš„æ¸²æŸ“æ¨è¿Ÿäº† 3sï¼Œæ‰“ç ´äº† this.props å’Œæ¸²æŸ“åŠ¨ä½œä¹‹é—´çš„è¿™ç§æ—¶æœºä¸Šçš„å…³è”ï¼Œè¿›è€Œå¯¼è‡´æ¸²æŸ“æ—¶æ•è·åˆ°çš„æ˜¯ä¸€ä¸ªé”™è¯¯çš„ã€ä¿®æ”¹åçš„ this.propsã€‚è¿™å°±æ˜¯é—®é¢˜çš„æ‰€åœ¨ã€‚\nä½†å¦‚æœæˆ‘ä»¬æŠŠ ProfilePage æ”¹é€ ä¸ºä¸€ä¸ªåƒè¿™æ ·çš„å‡½æ•°ç»„ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 function ProfilePage(props) { const showMessage = () =\u0026gt; { alert(\u0026#34;Followed \u0026#34; + props.user); }; const handleClick = () =\u0026gt; { setTimeout(showMessage, 3000); }; return \u0026lt;button onClick={handleClick}\u0026gt;Follow\u0026lt;/button\u0026gt;; } äº‹æƒ…å°±ä¼šå¤§ä¸ä¸€æ ·ã€‚\nprops ä¼šåœ¨ ProfilePage å‡½æ•°æ‰§è¡Œçš„ä¸€ç¬é—´å°±è¢«æ•è·ï¼Œè€Œ props æœ¬èº«åˆæ˜¯ä¸€ä¸ªä¸å¯å˜å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å……åˆ†ç¡®ä¿ä»ç°åœ¨å¼€å§‹ï¼Œåœ¨ä»»ä½•æ—¶æœºä¸‹è¯»å–åˆ°çš„ propsï¼Œéƒ½æ˜¯æœ€åˆæ•è·åˆ°çš„é‚£ä¸ª propsã€‚å½“çˆ¶ç»„ä»¶ä¼ å…¥æ–°çš„ props æ¥å°è¯•é‡æ–°æ¸²æŸ“ ProfilePage æ—¶ï¼Œæœ¬è´¨ä¸Šæ˜¯åŸºäºæ–°çš„ props å…¥å‚å‘èµ·äº†ä¸€æ¬¡å…¨æ–°çš„å‡½æ•°è°ƒç”¨ï¼Œå¹¶ä¸ä¼šå½±å“ä¸Šä¸€æ¬¡è°ƒç”¨å¯¹ä¸Šä¸€ä¸ª props çš„æ•è·ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ä¾¿ç¡®ä¿äº†æ¸²æŸ“ç»“æœç¡®å®èƒ½å¤Ÿç¬¦åˆé¢„æœŸã€‚\næ€»ç»“ï¼šâ€œå‡½æ•°ç»„ä»¶ä¼šæ•è· render å†…éƒ¨çš„çŠ¶æ€â€ï¼Œå‡½æ•°ç»„ä»¶çœŸæ­£åœ°æŠŠæ•°æ®å’Œæ¸²æŸ“ç»‘å®šåˆ°äº†ä¸€èµ·ã€‚\nå‡½æ•°ç»„ä»¶æ˜¯ä¸€ä¸ªæ›´åŠ åŒ¹é… React è®¾è®¡ç†å¿µã€ä¹Ÿæ›´æœ‰åˆ©äºé€»è¾‘æ‹†åˆ†ä¸é‡ç”¨çš„ç»„ä»¶è¡¨è¾¾å½¢å¼\nä»æ ¸å¿ƒ API çœ‹ Hooks çš„åŸºæœ¬å½¢æ€ useState()ï¼šä¸ºå‡½æ•°ç»„ä»¶å¼•å…¥çŠ¶æ€ 1 2 3 4 5 6 7 8 9 10 11 12 const [state, setState] = useState(initialState); //çŠ¶æ€å’Œä¿®æ”¹çŠ¶æ€çš„ API åéƒ½æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ const [text, setText] = useState(\u0026#34;åˆå§‹æ–‡æœ¬\u0026#34;); //å®ƒå°±åƒç±»ç»„ä»¶ä¸­ state å¯¹è±¡çš„æŸä¸€ä¸ªå±æ€§ä¸€æ ·ï¼Œå¯¹åº”ç€ä¸€ä¸ªå•ç‹¬çš„çŠ¶æ€ï¼Œå…è®¸ä½ å­˜å‚¨ä»»æ„ç±»å‹çš„å€¼ // å®šä¹‰ä¸ºæ•°ç»„ const [author, setAuthor] = useState([\u0026#34;zzydev\u0026#34;, \u0026#34;zzy\u0026#34;]); // å®šä¹‰ä¸ºæ•°å€¼ const [length, setLength] = useState(100); // å®šä¹‰ä¸ºå­—ç¬¦ä¸² const [text, setText] = useState(\u0026#34;åˆå§‹æ–‡æœ¬\u0026#34;); state ä¸­æ°¸è¿œä¸è¦ä¿å­˜å¯ä»¥é€šè¿‡è®¡ç®—å¾—åˆ°çš„å€¼ã€‚ æ¯”å¦‚ï¼š\nä» props ä¼ é€’è¿‡æ¥çš„å€¼ã€‚æœ‰æ—¶å€™ props ä¼ é€’è¿‡æ¥çš„å€¼æ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯è¦é€šè¿‡ä¸€å®šçš„è®¡ç®—åå†åœ¨ UI ä¸Šå±•ç¤ºï¼Œæ¯”å¦‚è¯´æ’åºã€‚é‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯æ¯æ¬¡ç”¨çš„æ—¶å€™ï¼Œéƒ½é‡æ–°æ’åºä¸€ä¸‹ï¼Œæˆ–è€…åˆ©ç”¨æŸäº› cache æœºåˆ¶ï¼Œè€Œä¸æ˜¯å°†ç»“æœç›´æ¥æ”¾åˆ° state é‡Œã€‚ ä» URL ä¸­è¯»åˆ°çš„å€¼ã€‚æœ‰æ—¶æˆ‘ä»¬è¦è¯»å– URL ä¸­çš„å‚æ•°ï¼ŒæŠŠå®ƒä½œä¸ºç»„ä»¶çš„ä¸€éƒ¨åˆ†çŠ¶æ€ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨æ¯æ¬¡éœ€è¦ç”¨çš„æ—¶å€™ï¼Œä» URL ä¸­è¯»å–ï¼Œè€Œä¸æ˜¯è¯»å‡ºæ¥æ”¾åœ¨ state ä¸­ã€‚ ä» cookieã€localStorage ä¸­è¯»å–çš„å€¼ã€‚é€šå¸¸æ¯æ¬¡è¦ç”¨çš„æ—¶å€™ç›´æ¥å»è¯»å–ï¼Œè€Œä¸æ˜¯è¯»å‡ºæ¥æ”¾åˆ° state ä¸­ã€‚ state è™½ç„¶ä¾¿äºç»´æŠ¤çŠ¶æ€ï¼Œä½†ä¹Ÿæœ‰è‡ªå·±çš„å¼Šç«¯ã€‚ä¸€æ—¦ç»„ä»¶æœ‰è‡ªå·±çŠ¶æ€ï¼Œæ„å‘³ç€ç»„ä»¶å¦‚æœé‡æ–°åˆ›å»ºï¼Œå°±éœ€è¦æœ‰æ¢å¤çŠ¶æ€çš„è¿‡ç¨‹ï¼Œè¿™é€šå¸¸ä¼šè®©ç»„ä»¶å˜å¾—æ›´å¤æ‚ã€‚æ¯”å¦‚ä¸€ä¸ªç»„ä»¶æƒ³åœ¨æœåŠ¡å™¨ç«¯è¯·æ±‚è·å–ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨å¹¶æ˜¾ç¤ºï¼Œå¦‚æœæŠŠè¯»å–åˆ°çš„æ•°æ®æ”¾åˆ°æœ¬åœ°çš„ state é‡Œï¼Œé‚£ä¹ˆæ¯ä¸ªç”¨åˆ°è¿™ä¸ªç»„ä»¶çš„åœ°æ–¹ï¼Œå°±éƒ½éœ€è¦é‡æ–°è·å–ä¸€éã€‚\nuseEffect()ï¼šå…è®¸å‡½æ•°ç»„ä»¶æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œ useEffect èƒ½å¤Ÿä¸ºå‡½æ•°ç»„ä»¶å¼•å…¥å‰¯ä½œç”¨ã€‚è¿‡å»æˆ‘ä»¬ä¹ æƒ¯æ”¾åœ¨ componentDidMountã€componentDidUpdate å’Œ componentWillUnmount ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œæ¥åšçš„äº‹ï¼Œç°åœ¨å¯ä»¥æ”¾åœ¨ useEffect é‡Œæ¥åšï¼Œæ¯”å¦‚æ“ä½œ DOMã€è®¢é˜…äº‹ä»¶ã€è°ƒç”¨å¤–éƒ¨ API è·å–æ•°æ®ç­‰ã€‚\nuseEffect æ˜¯æ¯æ¬¡ç»„ä»¶ render å®Œååˆ¤æ–­ä¾èµ–å¹¶æ‰§è¡Œ\næ²¡æœ‰ä¾èµ–é¡¹ï¼Œåˆ™æ¯æ¬¡ render åéƒ½ä¼šé‡æ–°æ‰§è¡Œã€‚ 1 2 3 4 useEffect(() =\u0026gt; { // æ¯æ¬¡ render å®Œéƒ½ä¼šæ‰§è¡Œ console.log(\u0026#34;re-rendered\u0026#34;); }); ä»…åœ¨æŒ‚è½½é˜¶æ®µæ‰§è¡Œä¸€æ¬¡çš„å‰¯ä½œç”¨ï¼šä¼ å…¥å›è°ƒå‡½æ•°ï¼Œä¸”è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ä½œä¸ºä¾èµ–é¡¹ã€‚å¯¹åº”åˆ° Class ç»„ä»¶å°±æ˜¯ componentDidMountã€‚ 1 2 3 4 useEffect(() =\u0026gt; { // è¿™é‡Œæ˜¯ä¸šåŠ¡é€»è¾‘ console.log(\u0026#34;did mount\u0026#34;); }, []); ä»…åœ¨æŒ‚è½½é˜¶æ®µå’Œå¸è½½é˜¶æ®µæ‰§è¡Œçš„å‰¯ä½œç”¨ï¼šä¼ å…¥å›è°ƒå‡½æ•°ï¼Œä¸”è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„ã€‚å‡å¦‚å›è°ƒå‡½æ•°æœ¬èº«è®°ä¸º Aï¼Œ è¿”å›çš„å‡½æ•°è®°ä¸º Bï¼Œé‚£ä¹ˆå°†åœ¨æŒ‚è½½é˜¶æ®µæ‰§è¡Œ Aï¼Œå¸è½½é˜¶æ®µæ‰§è¡Œ Bã€‚è¿™ä¸ªæœºåˆ¶å°±å‡ ä¹ç­‰ä»·äºç±»ç»„ä»¶ä¸­çš„ componentWillUnmountã€‚ 1 2 3 4 5 6 useEffect(() =\u0026gt; { // è¿™é‡Œæ˜¯ A çš„ä¸šåŠ¡é€»è¾‘ // è¿”å›ä¸€ä¸ªå‡½æ•°è®°ä¸º B return () =\u0026gt; {}; }, []); useEffect å›è°ƒä¸­è¿”å›çš„å‡½æ•°è¢«ç§°ä¸ºâ€œæ¸…é™¤å‡½æ•°â€ï¼Œå½“ React è¯†åˆ«åˆ°æ¸…é™¤å‡½æ•°æ—¶ï¼Œä¼šåœ¨å¸è½½æ—¶æ‰§è¡Œæ¸…é™¤å‡½æ•°å†…éƒ¨çš„é€»è¾‘ã€‚è¿™ä¸ªè§„å¾‹ä¸ä¼šå—ç¬¬äºŒä¸ªå‚æ•°æˆ–è€…å…¶ä»–å› ç´ çš„å½±å“ï¼Œåªè¦ä½ åœ¨ useEffect å›è°ƒä¸­è¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°±ä¼šè¢«ä½œä¸ºæ¸…é™¤å‡½æ•°æ¥å¤„ç†ã€‚\næ¯ä¸€æ¬¡æ¸²æŸ“éƒ½è§¦å‘ï¼Œä¸”å¸è½½é˜¶æ®µä¹Ÿä¼šè¢«è§¦å‘çš„å‰¯ä½œç”¨ï¼šä¼ å…¥å›è°ƒå‡½æ•°ï¼Œä¸”è¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°ã€‚ 1 2 3 4 5 6 7 useEffect(() =\u0026gt; { // è¿™é‡Œæ˜¯ A çš„ä¸šåŠ¡é€»è¾‘ // è¿”å›ä¸€ä¸ªå‡½æ•°è®°ä¸º B return () =\u0026gt; {}; }); //React åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½å»è§¦å‘ A é€»è¾‘ï¼Œå¹¶ä¸”åœ¨ä¸‹ä¸€æ¬¡ A é€»è¾‘è¢«è§¦å‘ä¹‹å‰å»è§¦å‘ B é€»è¾‘ã€‚ æ ¹æ®ä¸€å®šçš„ä¾èµ–æ¡ä»¶æ¥è§¦å‘çš„å‰¯ä½œç”¨ï¼šä¼ å…¥å›è°ƒå‡½æ•°ï¼ˆè‹¥è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»ç„¶ä»…å½±å“å¸è½½é˜¶æ®µå¯¹å‰¯ä½œç”¨çš„å¤„ç†ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ï¼‰ï¼ŒåŒæ—¶ä¼ å…¥ä¸€ä¸ªéç©ºçš„æ•°ç»„ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 useEffect(() =\u0026gt; { // è¿™æ˜¯å›è°ƒå‡½æ•°çš„ä¸šåŠ¡é€»è¾‘ // è‹¥ xxx æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™ xxx ä¼šåœ¨ç»„ä»¶å¸è½½æ—¶è¢«è§¦å‘ return xxx; }, [num1, num2, num3]); /* æ•°ç»„ä¸­çš„å˜é‡ä¸€èˆ¬éƒ½æ˜¯æ¥æºäºç»„ä»¶æœ¬èº«çš„æ•°æ®ï¼ˆprops æˆ–è€… stateï¼‰ã€‚ è‹¥æ•°ç»„ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆ React å°±ä¼šåœ¨æ–°çš„ä¸€æ¬¡æ¸²æŸ“åå»å¯¹æ¯”å‰åä¸¤æ¬¡çš„æ¸²æŸ“ï¼Œ æŸ¥çœ‹æ•°ç»„å†…æ˜¯å¦æœ‰å˜é‡å‘ç”Ÿäº†æ›´æ–°ï¼ˆåªè¦æœ‰ä¸€ä¸ªæ•°ç»„å…ƒç´ å˜äº†ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ›´æ–°å‘ç”Ÿäº†ï¼‰ï¼Œ å¹¶åœ¨æœ‰æ›´æ–°çš„å‰æä¸‹å»è§¦å‘ useEffect ä¸­å®šä¹‰çš„å‰¯ä½œç”¨é€»è¾‘ã€‚ */ ç†è§£ Hooks çš„ä¾èµ– Hooks(useEffectã€useCallbackã€useMemo) æä¾›äº†è®©ä½ ç›‘å¬æŸä¸ªæ•°æ®å˜åŒ–çš„èƒ½åŠ›ã€‚è¿™ä¸ªå˜åŒ–å¯èƒ½ä¼šè§¦å‘ç»„ä»¶çš„åˆ·æ–°ï¼Œä¹Ÿå¯èƒ½æ˜¯å»åˆ›å»ºä¸€ä¸ªå‰¯ä½œç”¨ï¼Œåˆæˆ–è€…æ˜¯åˆ·æ–°ä¸€ä¸ªç¼“å­˜ã€‚é‚£ä¹ˆå®šä¹‰è¦ç›‘å¬å“ªäº›æ•°æ®å˜åŒ–çš„æœºåˆ¶ï¼Œå…¶å®å°±æ˜¯æŒ‡å®š Hooks çš„ä¾èµ–é¡¹ã€‚\né‚£ä¹ˆåœ¨å®šä¹‰ä¾èµ–é¡¹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸‰ç‚¹ï¼š\nä¾èµ–é¡¹ä¸­å®šä¹‰çš„å˜é‡ä¸€å®šæ˜¯ä¼šåœ¨å›è°ƒå‡½æ•°ä¸­ç”¨åˆ°çš„ï¼Œå¦åˆ™å£°æ˜ä¾èµ–é¡¹å…¶å®æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ ä¾èµ–é¡¹ä¸€èˆ¬æ˜¯ä¸€ä¸ªå¸¸é‡æ•°ç»„ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå˜é‡ã€‚å› ä¸ºä¸€èˆ¬åœ¨åˆ›å»º callback çš„æ—¶å€™ï¼Œä½ å…¶å®éå¸¸æ¸…æ¥šå…¶ä¸­è¦ç”¨åˆ°å“ªäº›ä¾èµ–é¡¹äº†ã€‚ React ä¼šä½¿ç”¨æµ…æ¯”è¾ƒæ¥å¯¹æ¯”ä¾èµ–é¡¹æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥è¦ç‰¹åˆ«æ³¨æ„æ•°ç»„æˆ–è€…å¯¹è±¡ç±»å‹ã€‚å¦‚æœä½ æ˜¯æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå³ä½¿å’Œä¹‹å‰çš„å€¼æ˜¯ç­‰ä»·çš„ï¼Œä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯ä¾èµ–é¡¹å‘ç”Ÿäº†å˜åŒ–ã€‚è¿™æ˜¯ä¸€ä¸ªåˆšå¼€å§‹ä½¿ç”¨ Hooks æ—¶å¾ˆå®¹æ˜“å¯¼è‡´ Bug çš„åœ°æ–¹ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š 1 2 3 4 5 6 7 function Sample() { // è¿™é‡Œåœ¨æ¯æ¬¡ç»„ä»¶æ‰§è¡Œæ—¶åˆ›å»ºäº†ä¸€ä¸ªæ–°æ•°ç»„ const todos = [{ text: \u0026#34;Learn hooks.\u0026#34; }]; useEffect(() =\u0026gt; { console.log(\u0026#34;Todos changed.\u0026#34;); }, [todos]); } ä»£ç çš„åŸæ„å¯èƒ½æ˜¯åœ¨ todos å˜åŒ–çš„æ—¶å€™å»äº§ç”Ÿä¸€äº›å‰¯ä½œç”¨ï¼Œä½†æ˜¯è¿™é‡Œçš„ todos å˜é‡æ˜¯åœ¨å‡½æ•°å†…åˆ›å»ºçš„ï¼Œå®é™…ä¸Šæ¯æ¬¡éƒ½äº§ç”Ÿäº†ä¸€ä¸ªæ–°æ•°ç»„ã€‚æ‰€ä»¥åœ¨ä½œä¸ºä¾èµ–é¡¹çš„æ—¶å€™è¿›è¡Œå¼•ç”¨çš„æ¯”è¾ƒï¼Œå®é™…ä¸Šè¢«è®¤ä¸ºæ˜¯å‘ç”Ÿäº†å˜åŒ–çš„ã€‚\nReact ä¸ºä»€ä¹ˆè¦å‘æ˜ Hooks å‘Šåˆ«éš¾ä»¥ç†è§£çš„ Class: Class çš„â€œç—›ç‚¹â€:\nç”Ÿå‘½å‘¨æœŸ\nç”Ÿå‘½å‘¨æœŸçš„å¸¦æ¥çš„éº»çƒ¦æç°åœ¨ï¼šå­¦ä¹ æˆæœ¬å’Œä¸åˆç†çš„é€»è¾‘è§„åˆ’æ–¹å¼ React ç»„ä»¶ä¹‹é—´æ˜¯ä¸ä¼šç›¸äº’ç»§æ‰¿çš„\næ¯”å¦‚è¯´ï¼Œä½ ä¸ä¼šåˆ›å»ºä¸€ä¸ª Button ç»„ä»¶ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ª DropdownButton ç»„ä»¶æ¥ç»§æ‰¿ Buttonã€‚React å®é™…ä¸Šæ²¡åˆ©ç”¨åˆ° Class çš„ç»§æ‰¿ç‰¹æ€§çš„ã€‚ UI ç”±çŠ¶æ€é©±åŠ¨ï¼Œå¾ˆå°‘åœ¨å¤–éƒ¨è°ƒç”¨ç±»å®ä¾‹ï¼ˆå³ç»„ä»¶ï¼‰çš„æ–¹æ³•ã€‚\nç»„ä»¶æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯åœ¨ç±»å†…éƒ¨è°ƒç”¨æˆ–è€…ä½œä¸ºç”Ÿå‘½å‘¨æœŸå‡½æ•°è¢«è‡ªåŠ¨è°ƒç”¨ã€‚ this 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 class Example extends Component { state = { name: \u0026#39;zzydev\u0026#39;, age: \u0026#39;99\u0026#39;; }; changeAge() { // è¿™é‡Œä¼šæŠ¥é”™ this.setState({ age: \u0026#39;100\u0026#39; }); } render() { return \u0026lt;button onClick={this.changeAge}\u0026gt;{this.state.name}çš„å¹´é¾„æ˜¯{this.state.age}\u0026lt;/button\u0026gt; } } changeAge è¿™ä¸ªæ–¹æ³•ï¼šå®ƒæ˜¯ button æŒ‰é’®çš„äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚å½“æˆ‘ç‚¹å‡» button æŒ‰é’®æ—¶ï¼Œå¸Œæœ›å®ƒèƒ½å¤Ÿå¸®æˆ‘ä¿®æ”¹çŠ¶æ€ï¼Œä½†äº‹å®æ˜¯ï¼Œç‚¹å‡»å‘ç”Ÿåï¼Œç¨‹åºä¼šæŠ¥é”™ã€‚åŸå› å¾ˆç®€å•ï¼ŒchangeAge é‡Œå¹¶ä¸èƒ½æ‹¿åˆ°ç»„ä»¶å®ä¾‹çš„ thisã€‚ä¸ºäº†è§£å†³ this ä¸ç¬¦åˆé¢„æœŸçš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ this.changeAga = this.changeAga.bind(this) æˆ– ç®­å¤´å‡½æ•°çš„æ–¹å¼ï¼Œä½†è¿™ä¸¤ç§æ–¹å¼ æœ¬è´¨ä¸Šéƒ½æ˜¯åœ¨ç”¨å®è·µå±‚é¢çš„çº¦æŸæ¥è§£å†³è®¾è®¡å±‚é¢çš„é—®é¢˜\nHooks å¦‚ä½•å®ç°æ›´å¥½çš„é€»è¾‘æ‹†åˆ† è¿‡å»æˆ‘ä»¬ç»„ç»‡è‡ªå·±ä¸šåŠ¡é€»è¾‘çš„æ–¹å¼ï¼šå…ˆæƒ³æ¸…æ¥šä¸šåŠ¡çš„éœ€è¦æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œç„¶åå°†å¯¹åº”çš„ä¸šåŠ¡é€»è¾‘æ‹†åˆ°ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°é‡Œå»ã€‚é€»è¾‘ä¸ç”Ÿå‘½å‘¨æœŸè€¦åˆåœ¨ä¸€èµ·ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 componentDidMount() { // 1. è¿™é‡Œå‘èµ·å¼‚æ­¥è°ƒç”¨ // 2. è¿™é‡Œä» props é‡Œè·å–æŸä¸ªæ•°æ®ï¼Œæ ¹æ®è¿™ä¸ªæ•°æ®æ›´æ–° DOM // 3. è¿™é‡Œè®¾ç½®ä¸€ä¸ªè®¢é˜… // 4. è¿™é‡Œéšä¾¿å¹²ç‚¹åˆ«çš„ä»€ä¹ˆ // ... } componentWillUnMount() { // åœ¨è¿™é‡Œå¸è½½è®¢é˜… } componentDidUpdate() { // 1. åœ¨è¿™é‡Œæ ¹æ® DidMount è·å–åˆ°çš„å¼‚æ­¥æ•°æ®æ›´æ–° DOM // 2. è¿™é‡Œä» props é‡Œè·å–æŸä¸ªæ•°æ®ï¼Œæ ¹æ®è¿™ä¸ªæ•°æ®æ›´æ–° DOMï¼ˆå’Œ DidMount çš„ç¬¬2æ­¥ä¸€æ ·ï¼‰ } åƒè¿™æ ·çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå®ƒçš„ä½“ç§¯è¿‡äºåºå¤§ï¼Œåšçš„äº‹æƒ…è¿‡äºå¤æ‚ï¼Œä¼šç»™é˜…è¯»å’Œç»´æŠ¤è€…å¸¦æ¥å¾ˆå¤šéº»çƒ¦ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œè¿™äº›äº‹æƒ…ä¹‹é—´çœ‹ä¸Šå»æ¯«æ— å…³è”ï¼Œé€»è¾‘å°±åƒæ˜¯è¢«â€œæ‰“æ•£â€è¿›ç”Ÿå‘½å‘¨æœŸé‡Œäº†ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œè®¾ç½®è®¢é˜…å’Œå¸è½½è®¢é˜…çš„é€»è¾‘ï¼Œè™½ç„¶å®ƒä»¬åœ¨é€»è¾‘ä¸Šæ˜¯æœ‰å¼ºå…³è”çš„ï¼Œä½†æ˜¯å´åªèƒ½è¢«åˆ†æ•£åˆ°ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°é‡Œå»å¤„ç†ï¼Œè¿™æ— è®ºå¦‚ä½•ä¹Ÿä¸èƒ½ç®—ä½œæ˜¯ä¸€ä¸ªéå¸¸åˆç†çš„è®¾è®¡ã€‚\nè€Œåœ¨ Hooks çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠè¿™äº›ç¹æ‚çš„æ“ä½œæŒ‰ç…§é€»è¾‘ä¸Šçš„å…³è”æ‹†åˆ†è¿›ä¸åŒçš„å‡½æ•°ç»„ä»¶é‡Œï¼šæˆ‘ä»¬å¯ä»¥æœ‰ä¸“é—¨ç®¡ç†è®¢é˜…çš„å‡½æ•°ç»„ä»¶ã€ä¸“é—¨å¤„ç† DOM çš„å‡½æ•°ç»„ä»¶ã€ä¸“é—¨è·å–æ•°æ®çš„å‡½æ•°ç»„ä»¶ç­‰ã€‚Hooks èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®ç°ä¸šåŠ¡é€»è¾‘çš„èšåˆï¼Œé¿å…å¤æ‚çš„ç»„ä»¶å’Œå†—ä½™çš„ä»£ç ã€‚\nçŠ¶æ€å¤ç”¨ï¼šHooks å°†å¤æ‚çš„é—®é¢˜å˜ç®€å• è¿‡å»æˆ‘ä»¬å¤ç”¨çŠ¶æ€é€»è¾‘ï¼Œé çš„æ˜¯ HOCï¼ˆé«˜é˜¶ç»„ä»¶ï¼‰å’Œ Render Props è¿™äº›ç»„ä»¶è®¾è®¡æ¨¡å¼ï¼Œè¿™æ˜¯å› ä¸º React åœ¨åŸç”Ÿå±‚é¢å¹¶æ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›ç›¸å…³çš„é€”å¾„ã€‚ä½†è¿™äº›è®¾è®¡æ¨¡å¼å¹¶éä¸‡èƒ½ï¼Œå®ƒä»¬åœ¨å®ç°é€»è¾‘å¤ç”¨çš„åŒæ—¶ï¼Œä¹Ÿç ´åç€ç»„ä»¶çš„ç»“æ„ï¼Œå…¶ä¸­ä¸€ä¸ªæœ€å¸¸è§çš„é—®é¢˜å°±æ˜¯â€œåµŒå¥—åœ°ç‹±â€ç°è±¡ã€‚\nHooks å¯ä»¥è§†ä½œæ˜¯ React ä¸ºè§£å†³çŠ¶æ€é€»è¾‘å¤ç”¨è¿™ä¸ªé—®é¢˜æ‰€æä¾›çš„ä¸€ä¸ªåŸç”Ÿé€”å¾„ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ Hookï¼Œè¾¾åˆ°æ—¢ä¸ç ´åç»„ä»¶ç»“æ„ã€åˆèƒ½å¤Ÿå®ç°é€»è¾‘å¤ç”¨çš„æ•ˆæœã€‚\nReact Hooks çš„å±€é™æ€§ Hooks æš‚æ—¶è¿˜ä¸èƒ½å®Œå…¨åœ°ä¸ºå‡½æ•°ç»„ä»¶è¡¥é½ç±»ç»„ä»¶çš„èƒ½åŠ› æ¯”å¦‚ getSnapshotBeforeUpdateã€componentDidCatch è¿™äº›ç”Ÿå‘½å‘¨æœŸï¼Œç›®å‰éƒ½è¿˜æ˜¯å¼ºä¾èµ–ç±»ç»„ä»¶çš„ã€‚\nHooks åœ¨ä½¿ç”¨å±‚é¢æœ‰ç€ä¸¥æ ¼çš„è§„åˆ™çº¦æŸ Hooks çš„ä½¿ç”¨è§„åˆ™åŒ…æ‹¬ä»¥ä¸‹ä¸¤ä¸ª: åªèƒ½åœ¨å‡½æ•°ç»„ä»¶çš„é¡¶çº§ä½œç”¨åŸŸä½¿ç”¨ï¼›åªèƒ½åœ¨å‡½æ•°ç»„ä»¶æˆ–è€…å…¶ä»– Hooks ä¸­ä½¿ç”¨ã€‚ æ‰€è°“é¡¶å±‚ä½œç”¨åŸŸï¼Œå°±æ˜¯ Hooks ä¸èƒ½åœ¨å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­æˆ–è€…åµŒå¥—å‡½æ•°å†…æ‰§è¡Œï¼Œè€Œå¿…é¡»æ˜¯åœ¨é¡¶å±‚ã€‚åŒæ—¶ Hooks åœ¨ç»„ä»¶çš„å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ï¼Œå¿…é¡»æŒ‰é¡ºåºè¢«æ‰§è¡Œã€‚Hooks ä½¿ç”¨è§„åˆ™èƒŒåçš„â€åŸç†â€œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 function MyComp() { const [count, setCount] = useState(0); if (count \u0026gt; 10) { // âš ï¸ é”™è¯¯ï¼šä¸èƒ½å°† Hook ç”¨åœ¨æ¡ä»¶åˆ¤æ–­é‡Œ useEffect(() =\u0026gt; { // ... }, [count]); } // âš ï¸ è¿™é‡Œå¯èƒ½æå‰è¿”å›ç»„ä»¶æ¸²æŸ“ç»“æœï¼Œåé¢å°±ä¸èƒ½å†ç”¨ Hooks äº† if (count === 0) { return \u0026#34;No content\u0026#34;; } // âš ï¸ é”™è¯¯ï¼šä¸èƒ½å°† Hook æ”¾åœ¨å¯èƒ½çš„ return ä¹‹å const [loading, setLoading] = useState(false); //... return \u0026lt;div\u0026gt;{count}\u0026lt;/div\u0026gt;; } Hooks ä½œä¸ºä¸“é—¨ä¸ºå‡½æ•°ç»„ä»¶è®¾è®¡çš„æœºåˆ¶ï¼Œä½¿ç”¨çš„æƒ…å†µåªæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯åœ¨å‡½æ•°ç»„ä»¶å†…ï¼Œå¦å¤–ä¸€ç§åˆ™æ˜¯åœ¨è‡ªå®šä¹‰çš„ Hooks é‡Œé¢ã€‚ ä½†æ˜¯å¦‚æœä¸€å®šè¦åœ¨ Class ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œé‚£åº”è¯¥å¦‚ä½•åšå‘¢ï¼Ÿå…¶å®æœ‰ä¸€ä¸ªé€šç”¨çš„æœºåˆ¶ï¼Œé‚£å°±æ˜¯åˆ©ç”¨é«˜é˜¶ç»„ä»¶çš„æ¨¡å¼ï¼Œå°† Hooks å°è£…æˆé«˜é˜¶ç»„ä»¶ï¼Œä»è€Œè®©ç±»ç»„ä»¶ä½¿ç”¨ã€‚ ä¸¾ä¸ªä¾‹å­ã€‚æˆ‘ä»¬å·²ç»å®šä¹‰äº†ç›‘å¬çª—å£å¤§å°å˜åŒ–çš„ä¸€ä¸ª Hookï¼šuseWindowSizeã€‚é‚£ä¹ˆå¾ˆå®¹æ˜“å°±å¯ä»¥å°†å…¶è½¬æ¢ä¸ºé«˜é˜¶ç»„ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 import React from \u0026#34;react\u0026#34;; import { useWindowSize } from \u0026#34;../hooks/useWindowSize\u0026#34;; export const withWindowSize = (Comp) =\u0026gt; { return (props) =\u0026gt; { const windowSize = useWindowSize(); return \u0026lt;Comp windowSize={windowSize} {...props} /\u0026gt;; }; }; é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç æ¥ä½¿ç”¨è¿™ä¸ªé«˜é˜¶ç»„ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 import React from \u0026#34;react\u0026#34;; import { withWindowSize } from \u0026#34;./withWindowSize\u0026#34;; class MyComp { render() { const { windowSize } = this.props; // ... } } // é€šè¿‡ withWindowSize é«˜é˜¶ç»„ä»¶ç»™ MyComp æ·»åŠ  windowSize å±æ€§ export default withWindowSize(MyComp); è¿™æ ·ï¼Œé€šè¿‡ withWindowSize è¿™æ ·ä¸€ä¸ªé«˜é˜¶ç»„ä»¶æ¨¡å¼ï¼Œä½ å°±å¯ä»¥æŠŠ useWindowSize çš„ç»“æœä½œä¸ºå±æ€§ï¼Œä¼ é€’ç»™éœ€è¦ä½¿ç”¨çª—å£å¤§å°çš„ç±»ç»„ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°åœ¨ Class ç»„ä»¶ä¸­å¤ç”¨ Hooks çš„é€»è¾‘äº†ã€‚\nä½¿ç”¨ ESLint æ’ä»¶å¸®åŠ©æ£€æŸ¥ Hooks çš„ä½¿ç”¨ 1 yarn add eslint-plugin-react-hooks -S ç„¶ååœ¨ä½ çš„ ESLint é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä¸¤ä¸ªè§„åˆ™ï¼šrules-of-hooks å’Œ exhaustive-depsã€‚å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 { \u0026#34;plugins\u0026#34;: [ // ... \u0026#34;react-hooks\u0026#34; ], \u0026#34;rules\u0026#34;: { // ... // æ£€æŸ¥ Hooks çš„ä½¿ç”¨è§„åˆ™ \u0026#34;react-hooks/rules-of-hooks\u0026#34;: \u0026#34;error\u0026#34;, // æ£€æŸ¥ä¾èµ–é¡¹çš„å£°æ˜ \u0026#34;react-hooks/exhaustive-deps\u0026#34;: \u0026#34;warn\u0026#34; } } ","permalink":"https://zzydev.top/posts/headfirstreact/4_react-hooks%E8%AE%BE%E8%AE%A1%E5%8A%A8%E6%9C%BA%E4%B8%8E%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F/","summary":"å‡½æ•°ç»„ä»¶ä¼šæ•è· render å†…éƒ¨çš„çŠ¶æ€ï¼Œè¿™æ˜¯ä¸¤ç±»ç»„ä»¶æœ€å¤§çš„ä¸åŒã€‚ React æ¡†æ¶çš„ä¸»è¦å·¥ä½œï¼Œå°±æ˜¯åŠæ—¶åœ°æŠŠå£°æ˜å¼çš„ä»£ç è½¬æ¢ä¸ºå‘½ä»¤å¼çš„ DOM æ“ä½œï¼ŒæŠŠæ•°æ®å±‚é¢çš„æè¿°æ˜ å°„åˆ°ç”¨","title":"4.React Hooksè®¾è®¡åŠ¨æœºä¸å·¥ä½œæ¨¡å¼"},{"content":"React çš„æ ¸å¿ƒç‰¹å¾æ˜¯â€œæ•°æ®é©±åŠ¨è§†å›¾â€ï¼Œå³ UI = render(data)\nåŸºäº props çš„å•å‘æ•°æ®æµ æ‰€è°“å•å‘æ•°æ®æµï¼ŒæŒ‡çš„å°±æ˜¯å½“å‰ç»„ä»¶çš„ state ä»¥ props çš„å½¢å¼æµåŠ¨æ—¶ï¼Œåªèƒ½æµå‘ç»„ä»¶æ ‘ä¸­æ¯”è‡ªå·±å±‚çº§æ›´ä½çš„ç»„ä»¶ã€‚ æ¯”å¦‚åœ¨çˆ¶-å­ç»„ä»¶è¿™ç§åµŒå¥—å…³ç³»ä¸­ï¼Œåªèƒ½ç”±çˆ¶ç»„ä»¶ä¼  props ç»™å­ç»„ä»¶ï¼Œè€Œä¸èƒ½åè¿‡æ¥ã€‚ çˆ¶å­ç»„ä»¶é€šä¿¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 // å­ç»„ä»¶ function Child(props) { return ( \u0026lt;div className=\u0026#34;child\u0026#34;\u0026gt; \u0026lt;p\u0026gt;{`å­ç»„ä»¶æ‰€æ¥æ”¶åˆ°çš„æ¥è‡ªçˆ¶ç»„ä»¶çš„æ–‡æœ¬å†…å®¹æ˜¯ï¼š[${props.fatherText}]`}\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ); } //çˆ¶ç»„ä»¶ class Father extends React.Component { // åˆå§‹åŒ–çˆ¶ç»„ä»¶çš„ state state = { text: \u0026#34;åˆå§‹åŒ–çš„çˆ¶ç»„ä»¶çš„æ–‡æœ¬\u0026#34;, }; // æŒ‰é’®çš„ç›‘å¬å‡½æ•°ï¼Œç”¨äºæ›´æ–° text å€¼ changeText = () =\u0026gt; { this.setState({ text: \u0026#34;æ”¹å˜åçš„çˆ¶ç»„ä»¶æ–‡æœ¬\u0026#34;, }); }; // æ¸²æŸ“çˆ¶ç»„ä»¶ render() { return ( \u0026lt;div className=\u0026#34;father\u0026#34;\u0026gt; \u0026lt;button onClick={this.changeText}\u0026gt; ç‚¹å‡»ä¿®æ”¹çˆ¶ç»„ä»¶ä¼ å…¥å­ç»„ä»¶çš„æ–‡æœ¬ \u0026lt;/button\u0026gt; {/* å¼•å…¥å­ç»„ä»¶ï¼Œå¹¶é€šè¿‡ props ä¸‹å‘å…·ä½“çš„çŠ¶æ€å€¼å®ç°çˆ¶-å­é€šä¿¡ */} \u0026lt;Child fatherText={this.state.text} /\u0026gt; \u0026lt;/div\u0026gt; ); } } å­-çˆ¶ç»„ä»¶é€šä¿¡ è€ƒè™‘åˆ° props æ˜¯å•å‘çš„ï¼Œå­ç»„ä»¶å¹¶ä¸èƒ½ç›´æ¥å°†è‡ªå·±çš„æ•°æ®å¡ç»™çˆ¶ç»„ä»¶ï¼Œä½† props çš„å½¢å¼ä¹Ÿå¯ä»¥æ˜¯å¤šæ ·çš„ã€‚å‡å¦‚çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶çš„æ˜¯ä¸€ä¸ªç»‘å®šäº†è‡ªèº«ä¸Šä¸‹æ–‡çš„å‡½æ•°ï¼Œé‚£ä¹ˆå­ç»„ä»¶åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œå°±å¯ä»¥å°†æƒ³è¦äº¤ç»™çˆ¶ç»„ä»¶çš„æ•°æ®ä»¥å‡½æ•°å…¥å‚çš„å½¢å¼ç»™å‡ºå»ï¼Œä»¥æ­¤æ¥é—´æ¥åœ°å®ç°æ•°æ®ä»å­ç»„ä»¶åˆ°çˆ¶ç»„ä»¶çš„æµåŠ¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 class Child extends React.Component { // åˆå§‹åŒ–å­ç»„ä»¶çš„ state state = { text: \u0026#39;å­ç»„ä»¶çš„æ–‡æœ¬\u0026#39; } // å­ç»„ä»¶çš„æŒ‰é’®ç›‘å¬å‡½æ•° changeText = () =\u0026gt; { // changeText ä¸­ï¼Œè°ƒç”¨äº†çˆ¶ç»„ä»¶ä¼ å…¥çš„ changeFatherText æ–¹æ³• this.props.changeFatherText(this.state.text) } render() { return ( \u0026lt;div className=\u0026#34;child\u0026#34;\u0026gt; {/* æ³¨æ„è¿™é‡ŒæŠŠä¿®æ”¹çˆ¶ç»„ä»¶æ–‡æœ¬çš„åŠ¨ä½œæ”¾åœ¨äº† Child é‡Œ */} \u0026lt;button onClick={this.changeText}\u0026gt; ç‚¹å‡»æ›´æ–°çˆ¶ç»„ä»¶çš„æ–‡æœ¬ \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); } } class Father extends React.Component { // åˆå§‹åŒ–çˆ¶ç»„ä»¶çš„ state state = { text: \u0026#34;åˆå§‹åŒ–çš„çˆ¶ç»„ä»¶çš„æ–‡æœ¬\u0026#34; }; // è¿™ä¸ªæ–¹æ³•ä¼šä½œä¸º props ä¼ ç»™å­ç»„ä»¶ï¼Œç”¨äºæ›´æ–°çˆ¶ç»„ä»¶ text å€¼ã€‚newText æ­£æ˜¯å¼€æ”¾ç»™å­ç»„ä»¶çš„æ•°æ®é€šä¿¡å…¥å£ changeText = (newText) =\u0026gt; { this.setState({ text: newText }); }; // æ¸²æŸ“çˆ¶ç»„ä»¶ render() { return ( \u0026lt;div className=\u0026#34;father\u0026#34;\u0026gt; \u0026lt;p\u0026gt;{`çˆ¶ç»„ä»¶çš„æ–‡æœ¬å†…å®¹æ˜¯ï¼š[${this.state.text}]`}\u0026lt;/p\u0026gt; {/* å¼•å…¥å­ç»„ä»¶ï¼Œå¹¶é€šè¿‡ props ä¸­ä¸‹å‘å¯ä¼ å‚çš„å‡½æ•° å®ç°å­-çˆ¶é€šä¿¡ */} \u0026lt;Child changeFatherText={this.changeText} /\u0026gt; \u0026lt;/div\u0026gt; ); } å…„å¼Ÿç»„ä»¶é€šä¿¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 function Child(props) { return ( \u0026lt;div className=\u0026#34;child\u0026#34;\u0026gt; \u0026lt;p\u0026gt;{`å­ç»„ä»¶æ‰€æ¥æ”¶åˆ°çš„æ¥è‡ªçˆ¶ç»„ä»¶çš„æ–‡æœ¬å†…å®¹æ˜¯ï¼š[${props.fatherText}]`}\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ); } class NewChild extends React.Component { state = { text: \u0026#34;æ¥è‡ª newChild çš„æ–‡æœ¬\u0026#34;, }; // NewChild ç»„ä»¶çš„æŒ‰é’®ç›‘å¬å‡½æ•° changeText = () =\u0026gt; { // changeText ä¸­ï¼Œè°ƒç”¨äº†çˆ¶ç»„ä»¶ä¼ å…¥çš„ changeFatherText æ–¹æ³• this.props.changeFatherText(this.state.text); }; render() { return ( \u0026lt;div className=\u0026#34;child\u0026#34;\u0026gt; {/* æ³¨æ„è¿™é‡ŒæŠŠä¿®æ”¹çˆ¶ç»„ä»¶æ–‡æœ¬ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ Child ç»„ä»¶çš„æ–‡æœ¬ï¼‰çš„åŠ¨ä½œæ”¾åœ¨äº† NewChild é‡Œ */} \u0026lt;button onClick={this.changeText}\u0026gt;ç‚¹å‡»æ›´æ–° Child ç»„ä»¶çš„æ–‡æœ¬\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; ); } } class Father extends React.Component { // åˆå§‹åŒ–çˆ¶ç»„ä»¶çš„ state state = { text: \u0026#34;åˆå§‹åŒ–çš„çˆ¶ç»„ä»¶çš„æ–‡æœ¬\u0026#34;, }; // ä¼ ç»™ NewChild ç»„ä»¶æŒ‰é’®çš„ç›‘å¬å‡½æ•°ï¼Œç”¨äºæ›´æ–°çˆ¶ç»„ä»¶ text å€¼ï¼ˆè¿™ä¸ª text å€¼åŒæ—¶ä¹Ÿæ˜¯ Child çš„ propsï¼‰ changeText = (newText) =\u0026gt; { this.setState({ text: newText, }); }; // æ¸²æŸ“çˆ¶ç»„ä»¶ render() { return ( \u0026lt;div className=\u0026#34;father\u0026#34;\u0026gt; {/* å¼•å…¥ Child ç»„ä»¶ï¼Œå¹¶é€šè¿‡ props ä¸­ä¸‹å‘å…·ä½“çš„çŠ¶æ€å€¼ å®ç°çˆ¶-å­é€šä¿¡ */} \u0026lt;Child fatherText={this.state.text} /\u0026gt; {/* å¼•å…¥ NewChild ç»„ä»¶ï¼Œå¹¶é€šè¿‡ props ä¸­ä¸‹å‘å¯ä¼ å‚çš„å‡½æ•° å®ç°å­-çˆ¶é€šä¿¡ */} \u0026lt;NewChild changeFatherText={this.changeText} /\u0026gt; \u0026lt;/div\u0026gt; ); } } åˆ©ç”¨â€œå‘å¸ƒ-è®¢é˜…â€æ¨¡å¼é©±åŠ¨æ•°æ®æµ ä½¿ç”¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¼˜ç‚¹åœ¨äºï¼Œç›‘å¬äº‹ä»¶çš„ä½ç½®å’Œè§¦å‘äº‹ä»¶çš„ä½ç½®æ˜¯ä¸å—é™çš„ï¼Œåªè¦å®ƒä»¬åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡é‡Œï¼Œå°±èƒ½å¤Ÿå½¼æ­¤æ„ŸçŸ¥ã€‚è¿™ä¸ªç‰¹æ€§ï¼Œå¤ªé€‚åˆç”¨æ¥åº”å¯¹â€œä»»æ„ç»„ä»¶é€šä¿¡â€è¿™ç§åœºæ™¯äº†ã€‚\nå‘å¸ƒ-è®¢é˜…æ¨¡å‹ API è®¾è®¡æ€è·¯ on()ï¼šè´Ÿè´£æ³¨å†Œäº‹ä»¶çš„ç›‘å¬å™¨ï¼ŒæŒ‡å®šäº‹ä»¶è§¦å‘æ—¶çš„å›è°ƒå‡½æ•°ã€‚ emit()ï¼šè´Ÿè´£è§¦å‘äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¼ å‚ä½¿å…¶åœ¨è§¦å‘çš„æ—¶å€™æºå¸¦æ•°æ® ã€‚ off()ï¼šè´Ÿè´£ç›‘å¬å™¨çš„åˆ é™¤ã€‚ å‘å¸ƒ-è®¢é˜…æ¨¡å‹ç¼–ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 class myEventEmitter { constructor() { // eventMap ç”¨æ¥å­˜å‚¨äº‹ä»¶å’Œç›‘å¬å‡½æ•°ä¹‹é—´çš„å…³ç³» this.eventMap = {}; } // type è¿™é‡Œå°±ä»£è¡¨äº‹ä»¶çš„åç§° on(type, handler) { // hanlder å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœä¸æ˜¯ç›´æ¥æŠ¥é”™ if (!(handler instanceof Function)) { throw new Error(\u0026#34;hanlderå¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°\u0026#34;); } // åˆ¤æ–­ type äº‹ä»¶å¯¹åº”çš„é˜Ÿåˆ—æ˜¯å¦å­˜åœ¨ if (!this.eventMap[type]) { // è‹¥ä¸å­˜åœ¨ï¼Œæ–°å»ºè¯¥é˜Ÿåˆ— this.eventMap[type] = []; } // è‹¥å­˜åœ¨ï¼Œç›´æ¥å¾€é˜Ÿåˆ—é‡Œæ¨å…¥ handler this.eventMap[type].push(handler); } // åˆ«å¿˜äº†æˆ‘ä»¬å‰é¢è¯´è¿‡è§¦å‘æ—¶æ˜¯å¯ä»¥æºå¸¦æ•°æ®çš„ï¼Œparams å°±æ˜¯æ•°æ®çš„è½½ä½“ emit(type, params) { // å‡è®¾è¯¥äº‹ä»¶æ˜¯æœ‰è®¢é˜…çš„ï¼ˆå¯¹åº”çš„äº‹ä»¶é˜Ÿåˆ—å­˜åœ¨ï¼‰ if (this.eventMap[type]) { // å°†äº‹ä»¶é˜Ÿåˆ—é‡Œçš„ handler ä¾æ¬¡æ‰§è¡Œå‡ºé˜Ÿ this.eventMap[type].forEach((handler, index) =\u0026gt; { // æ³¨æ„åˆ«å¿˜äº†è¯»å– params handler(params); }); } } off(type, handler) { if (this.eventMap[type]) { // indexOfæ‰¾ä¸åˆ°å…ƒç´ ä¼šè¿”å›-1ï¼Œspliceä»å³å¾€å·¦æˆªå–ï¼Œå³ç§»è¿ç®—ä¼šå°†-1å˜æˆ4294967295 this.eventMap[type].splice(this.eventMap[type].indexOf(handler) \u0026gt;\u0026gt;\u0026gt; 0, 1); } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 // æ³¨æ„è¿™ä¸ª myEvent æ˜¯æå‰å®ä¾‹åŒ–å¹¶æŒ‚è½½åˆ°å…¨å±€çš„ï¼Œæ­¤å¤„ä¸å†é‡å¤ç¤ºèŒƒå®ä¾‹åŒ–è¿‡ç¨‹ const globalEvent = window.myEvent; class B extends React.Component { // è¿™é‡Œçœç•¥æ‰å…¶ä»–ä¸šåŠ¡é€»è¾‘ state = { newParams: \u0026#34;\u0026#34;, }; handler = (params) =\u0026gt; { this.setState({ newParams: params, }); }; bindHandler = () =\u0026gt; { globalEvent.on(\u0026#34;someEvent\u0026#34;, this.handler); }; render() { return ( \u0026lt;div\u0026gt; \u0026lt;button onClick={this.bindHandler}\u0026gt;ç‚¹æˆ‘ç›‘å¬Açš„åŠ¨ä½œ\u0026lt;/button\u0026gt; \u0026lt;div\u0026gt;Aä¼ å…¥çš„å†…å®¹æ˜¯[{this.state.newParams}]\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; ); } } class A extends React.Component { // è¿™é‡Œçœç•¥æ‰å…¶ä»–ä¸šåŠ¡é€»è¾‘ state = { infoToB: \u0026#34;å“ˆå“ˆå“ˆå“ˆæˆ‘æ¥è‡ªA\u0026#34;, }; reportToB = () =\u0026gt; { // è¿™é‡Œçš„ infoToB è¡¨ç¤º A è‡ªèº«çŠ¶æ€ä¸­éœ€è¦è®© B æ„ŸçŸ¥çš„é‚£éƒ¨åˆ†æ•°æ® globalEvent.emit(\u0026#34;someEvent\u0026#34;, this.state.infoToB); }; render() { return \u0026lt;button onClick={this.reportToB}\u0026gt;ç‚¹æˆ‘æŠŠstateä¼ é€’ç»™B\u0026lt;/button\u0026gt;; } } export default function App() { return ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;B /\u0026gt; \u0026lt;A /\u0026gt; \u0026lt;/div\u0026gt; ); } ä½¿ç”¨ Context ç»´æŠ¤å…¨å±€çŠ¶æ€ useContext\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 //ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªcontextå¯¹è±¡,å¯ä»¥é€‰æ‹©æ€§åœ°ä¼ å…¥ä¸€ä¸ªdefaultValue const AppContext = React.createContext(defaultValue) //ä»åˆ›å»ºå‡ºçš„contextå¯¹è±¡ä¸­ï¼Œå¯ä»¥è¯»å–åˆ° Provider å’Œ Consumer const { Provider, Consumer } = AppContext //ä½¿ç”¨ Provider å¯¹ç»„ä»¶æ ‘ä¸­çš„æ ¹ç»„ä»¶è¿›è¡ŒåŒ…è£¹ï¼Œ //ç„¶åä¼ å…¥åä¸ºâ€œvalueâ€çš„å±æ€§ï¼Œè¿™ä¸ª value å°±æ˜¯åç»­åœ¨ç»„ä»¶æ ‘ä¸­æµåŠ¨çš„â€œæ•°æ®â€ï¼Œ //å®ƒå¯ä»¥è¢« Consumer æ¶ˆè´¹ã€‚ \u0026lt;Provider value={title: this.state.title, content: this.state.content}\u0026gt; \u0026lt;Title /\u0026gt; \u0026lt;Content /\u0026gt; \u0026lt;/Provider\u0026gt; //Consumerï¼Œé¡¾åæ€ä¹‰å°±æ˜¯â€œæ•°æ®çš„æ¶ˆè´¹è€…â€ï¼Œå®ƒå¯ä»¥è¯»å– Provider ä¸‹å‘ä¸‹æ¥çš„æ•°æ® //å…¶ç‰¹ç‚¹æ˜¯éœ€è¦æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå­å…ƒç´ ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªç»„ä»¶ã€‚ \u0026lt;Consumer\u0026gt; {value =\u0026gt; \u0026lt;div\u0026gt;{value.title}\u0026lt;/div\u0026gt;} \u0026lt;/Consumer\u0026gt; //æ³¨æ„: å½“ Consumer æ²¡æœ‰å¯¹åº”çš„ Provider æ—¶ï¼Œ //value å‚æ•°ä¼šç›´æ¥å–åˆ›å»º context æ—¶ä¼ é€’ç»™ createContext çš„ defaultValueã€‚ Redux createStore.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 const createStore = (reducer, enhancer) =\u0026gt; { if (enhancer) { return enhancer(createStore)(reducer); } let currentState = void 0; let currentListeners = []; const getState = () =\u0026gt; currentState; const dispatch = (action) =\u0026gt; { currentState = reducer(currentState, action); currentListeners.forEach((listener) =\u0026gt; listener()); }; const subscribe = (listener) =\u0026gt; { currentListeners.push(listener); return () =\u0026gt; { const index = currentListeners.indexOf(listener); currentListeners.splice(index, 1); }; }; //æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡è®¢é˜…ï¼ŒåŠ ä¸Šé»˜è®¤å€¼ dispatch({ type: \u0026#34;@zâ€”redux/INIT\u0026#34; }); return { getState, dispatch, subscribe, }; }; export default createStore; applyMiddleware.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 const applyMiddleware = (...middleware) =\u0026gt; { return (createStore) =\u0026gt; (reducer) =\u0026gt; { const store = createStore(reducer); let dispatch = store.dispatch; const midApi = { getState: store.getState, dispatch: (action, ...args) =\u0026gt; dispatch(action, ...args), }; const chain = middleware.map((middleware) =\u0026gt; middleware(midApi)); dispatch = compose(...chain)(store.dispatch); return { ...store, dispatch, }; }; }; const compose = (...funcs) =\u0026gt; { if (funcs.length === 0) { return (arg) =\u0026gt; arg; } if (funcs.length === 1) { return funcs[0]; } return funcs.reduce( (a, b) =\u0026gt; (...args) =\u0026gt; a(b(...args)) ); }; export default applyMiddleware; combineReducer.js\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 const combineReducers = (reducers) =\u0026gt; (state = {}, action) =\u0026gt; { let nextState = {}; let hasChange = false; for (let key in reducers) { const reducer = reducers[key]; nextState[key] = reducer(state[key], action); hasChange = hasChange || nextState[key] !== state[key]; } hasChange = hasChange || Object.keys(nextState) !== Object.keys(state); return hasChange ? nextState : state; }; export default combineReducers; React-Redux 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 import { useReducer } from \u0026#34;react\u0026#34;; import React from \u0026#34;react\u0026#34;; import { useCallback, useState, useEffect, useLayoutEffect, useContext, } from \u0026#34;react\u0026#34;; const Context = React.createContext(); export const Provider = ({ store, children }) =\u0026gt; { return \u0026lt;Context.Provider value={store}\u0026gt;{children}\u0026lt;/Context.Provider\u0026gt;; }; export const connect = (mapStateToProps = (state) =\u0026gt; state, mapDispatchToProps) =\u0026gt; (WrapperComponent) =\u0026gt; (props) =\u0026gt; { const store = useContext(Context); const { getState, dispatch, subscribe } = store; const stateProps = mapStateToProps(getState()); let dispatchProps = { dispatch }; if (typeof mapDispatchToProps === \u0026#34;object\u0026#34;) { dispatchProps = { ...bindActionCreators(mapDispatchToProps, dispatch), dispatch, }; } else if (typeof mapDispatchToProps === \u0026#34;function\u0026#34;) { dispatchProps = mapDispatchToProps(dispatch); } const forceUpdate = useForceUpdate(); useLayoutEffect(() =\u0026gt; { const unsubscribe = subscribe(() =\u0026gt; { forceUpdate(); }); return () =\u0026gt; { if (unsubscribe) { unsubscribe(); } }; }, []); return \u0026lt;WrapperComponent {...props} {...stateProps} {...dispatchProps} /\u0026gt;; }; function bindActionCreator(creator, dispatch) { return (...args) =\u0026gt; dispatch(creator(...args)); } export const bindActionCreators = (creators, dispatch) =\u0026gt; { let obj = {}; for (let key in creators) { obj[key] = bindActionCreator(creators[key], dispatch); } return obj; }; const useForceUpdate = () =\u0026gt; { const [state, setState] = useState(0); //const [, setState] = useReducer((prev) =\u0026gt; prev + 1, 0); const update = useCallback(() =\u0026gt; { setState((prev) =\u0026gt; prev + 1); }, []); return update; }; ","permalink":"https://zzydev.top/posts/headfirstreact/3_%E6%95%B0%E6%8D%AE%E6%98%AF%E5%A6%82%E4%BD%95%E5%9C%A8react%E7%BB%84%E4%BB%B6%E4%B9%8B%E9%97%B4%E6%B5%81%E5%8A%A8%E7%9A%84/","summary":"React çš„æ ¸å¿ƒç‰¹å¾æ˜¯â€œæ•°æ®é©±åŠ¨è§†å›¾â€ï¼Œå³ UI = render(data) åŸºäº props çš„å•å‘æ•°æ®æµ æ‰€è°“å•å‘æ•°æ®æµï¼ŒæŒ‡çš„å°±æ˜¯å½“å‰ç»„ä»¶çš„ state ä»¥ props çš„å½¢å¼æµåŠ¨æ—¶ï¼Œåªèƒ½æµå‘ç»„ä»¶æ ‘ä¸­æ¯”è‡ªå·±å±‚çº§æ›´","title":"3.æ•°æ®æ˜¯å¦‚ä½•åœ¨Reactç»„ä»¶ä¹‹é—´æµåŠ¨çš„ï¼Ÿ"},{"content":"React15 çš„ç”Ÿå‘½å‘¨æœŸ Mounting é˜¶æ®µï¼šç»„ä»¶çš„åˆå§‹åŒ–æ¸²æŸ“ æŒ‚è½½è¿‡ç¨‹åœ¨ç»„ä»¶çš„ä¸€ç”Ÿä¸­ä»…ä¼šå‘ç”Ÿä¸€æ¬¡ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç»„ä»¶è¢«åˆå§‹åŒ–ï¼Œç„¶åä¼šè¢«æ¸²æŸ“åˆ°çœŸå® DOM é‡Œï¼Œå®Œæˆâ€œé¦–æ¬¡æ¸²æŸ“â€ã€‚\næ³¨æ„ render åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¹¶ä¸ä¼šå»æ“ä½œçœŸå® DOMï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸ä¼šæ¸²æŸ“ï¼‰ï¼Œå®ƒçš„èŒèƒ½æ˜¯æŠŠéœ€è¦æ¸²æŸ“çš„å†…å®¹è¿”å›å‡ºæ¥ã€‚çœŸå® DOM çš„æ¸²æŸ“å·¥ä½œï¼Œåœ¨æŒ‚è½½é˜¶æ®µæ˜¯ç”± ReactDOM.render æ¥åšçš„ã€‚\ncomponentDidMount æ–¹æ³•åœ¨æ¸²æŸ“ç»“æŸåè¢«è§¦å‘ï¼Œæ­¤æ—¶å› ä¸ºçœŸå® DOM å·²ç»æŒ‚è½½åˆ°äº†é¡µé¢ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œæ‰§è¡ŒçœŸå® DOM ç›¸å…³çš„æ“ä½œï¼Œç±»ä¼¼äºå‘èµ·å¼‚æ­¥è¯·æ±‚ã€æ•°æ®åˆå§‹åŒ–è¿™æ ·çš„æ“ä½œä¹Ÿå¤§å¯ä»¥æ”¾åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ¥åšã€‚\nUpdating é˜¶æ®µï¼šç»„ä»¶çš„æ›´æ–° componentWillReceiProps(nextProps) æ˜¯ç”±ä»€ä¹ˆè§¦å‘çš„ï¼Ÿ åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•é‡Œï¼ŒnextProps è¡¨ç¤ºçš„æ˜¯æ¥æ”¶åˆ°æ–° props å†…å®¹ï¼Œè€Œç°æœ‰çš„ props ï¼ˆç›¸å¯¹äº nextProps çš„â€œæ—§ propsâ€ï¼‰å¯ä»¥é€šè¿‡ this.props æ‹¿åˆ°ï¼Œç”±æ­¤ä¾¿èƒ½å¤Ÿæ„ŸçŸ¥åˆ° props çš„å˜åŒ–ã€‚\ncomponentReceiveProps å¹¶ä¸æ˜¯ç”± props çš„å˜åŒ–è§¦å‘çš„ï¼Œè€Œæ˜¯ç”±çˆ¶ç»„ä»¶çš„æ›´æ–°è§¦å‘çš„ã€‚\nå¦‚æœçˆ¶ç»„ä»¶å¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œå³ä½¿ props æ²¡æœ‰æ›´æ”¹ä¹Ÿä¼šè°ƒç”¨æ­¤æ–¹æ³•ï¼ˆcomponentWillReceivePropsï¼‰ å¦‚æœåªæƒ³å¤„ç†æ›´æ”¹ï¼Œè¯·ç¡®ä¿å½“å‰å€¼ä¸å˜æ›´å€¼çš„æ¯”è¾ƒ\n\u0026mdash;\u0026mdash; React å®˜æ–¹\nç»„ä»¶è‡ªèº« setState è§¦å‘çš„æ›´æ–° componentWillUpdate ä¼šåœ¨ render å‰è¢«è§¦å‘ï¼Œå®ƒå’Œ componentWillMount ç±»ä¼¼ï¼Œå…è®¸ä½ åœ¨é‡Œé¢åšä¸€äº›ä¸æ¶‰åŠçœŸå® DOM æ“ä½œçš„å‡†å¤‡å·¥ä½œï¼›è€Œ componentDidUpdate åˆ™åœ¨ç»„ä»¶æ›´æ–°å®Œæ¯•åè¢«è§¦å‘ï¼Œå’Œ componentDidMount ç±»ä¼¼ï¼Œè¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¹Ÿç»å¸¸è¢«ç”¨æ¥å¤„ç† DOM æ“ä½œã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¸¸å¸¸å°† componentDidUpdate çš„æ‰§è¡Œä½œä¸ºå­ç»„ä»¶æ›´æ–°å®Œæ¯•çš„æ ‡å¿—é€šçŸ¥åˆ°çˆ¶ç»„ä»¶ã€‚\nrender ä¸æ€§èƒ½ï¼š shouldComponentUpdate(nextProps, nextState) React ç»„ä»¶ä¼šæ ¹æ® shouldComponentUpdate çš„è¿”å›å€¼ï¼Œæ¥å†³å®šæ˜¯å¦æ‰§è¡Œè¯¥æ–¹æ³•ä¹‹åçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿›è€Œå†³å®šæ˜¯å¦å¯¹ç»„ä»¶è¿›è¡Œre-renderï¼ˆé‡æ¸²æŸ“ï¼‰ã€‚shouldComponentUpdate çš„é»˜è®¤å€¼ä¸º trueï¼Œä¹Ÿå°±æ˜¯è¯´â€œæ— æ¡ä»¶ re-renderâ€ã€‚åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€é€šè¿‡æ‰‹åŠ¨å¾€ shouldComponentUpdate ä¸­å¡«å……åˆ¤å®šé€»è¾‘ï¼Œæˆ–è€…ç›´æ¥åœ¨é¡¹ç›®ä¸­å¼•å…¥ PureComponent ç­‰æœ€ä½³å®è·µï¼Œæ¥å®ç°â€œæœ‰æ¡ä»¶çš„ re-renderâ€ã€‚\nUnmounting é˜¶æ®µï¼šç»„ä»¶çš„å¸è½½ ç»„ä»¶é”€æ¯çš„å¸¸è§åŸå› æœ‰ä»¥ä¸‹ä¸¤ä¸ªã€‚\nç»„ä»¶åœ¨çˆ¶ç»„ä»¶ä¸­è¢«ç§»é™¤äº†ï¼šè¿™ç§æƒ…å†µç›¸å¯¹æ¯”è¾ƒç›´è§‚ ç»„ä»¶ä¸­è®¾ç½®äº† key å±æ€§ï¼Œçˆ¶ç»„ä»¶åœ¨ render çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç° key å€¼å’Œä¸Šä¸€æ¬¡ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆè¿™ä¸ªç»„ä»¶å°±ä¼šè¢«é”€æ¯ã€‚ React16 çš„ç”Ÿå‘½å‘¨æœŸ æ¨è ğŸ‘‰ğŸ» React16 ç”Ÿå‘½å‘¨æœŸå›¾ç¤º\nMounting é˜¶æ®µï¼šç»„ä»¶çš„åˆå§‹åŒ–æ¸²æŸ“ è®¤è¯† getDerivedStateFromProps(props,state) getDerivedStateFromProps è¿™ä¸ª APIï¼Œå…¶è®¾è®¡çš„åˆè¡·ä¸æ˜¯è¯•å›¾æ›¿æ¢æ‰componentWillMount ï¼Œè€Œæ˜¯è¯•å›¾æ›¿æ¢æ‰ componentWillReceivePropsï¼Œå› æ­¤å®ƒæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªç”¨é€”:ä½¿ç”¨ props æ¥æ´¾ç”Ÿ/æ›´æ–° state\ngetDerivedStateFromProps æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œé™æ€æ–¹æ³•ä¸ä¾èµ–ç»„ä»¶å®ä¾‹è€Œå­˜åœ¨ï¼Œå› æ­¤åœ¨è¿™ä¸ªæ–¹æ³•å†…éƒ¨æ˜¯è®¿é—®ä¸åˆ° this çš„ã€‚\nè¯¥æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šprops å’Œ stateï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨å½“å‰ç»„ä»¶æ¥æ”¶åˆ°çš„æ¥è‡ªçˆ¶ç»„ä»¶çš„ props å’Œå½“å‰ç»„ä»¶è‡ªèº«çš„ stateã€‚\ngetDerivedStateFromProps éœ€è¦ä¸€ä¸ªå¯¹è±¡æ ¼å¼çš„è¿”å›å€¼ã€‚å¦‚æœä½ æ²¡æœ‰æŒ‡å®šè¿™ä¸ªè¿”å›å€¼ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡ä¼šè¢« React è­¦å‘Šä¸€ç•ªã€‚\ngetDerivedStateFromProps æ–¹æ³•å¯¹ state çš„æ›´æ–°åŠ¨ä½œå¹¶éâ€œè¦†ç›–â€å¼çš„æ›´æ–°ï¼Œè€Œæ˜¯é’ˆå¯¹æŸä¸ªå±æ€§çš„å®šå‘æ›´æ–°ã€‚æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬åœ¨ getDerivedStateFromProps é‡Œè¿”å›çš„æ˜¯è¿™æ ·ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ª fatherText å±æ€§ç”¨äºè¡¨ç¤ºâ€œçˆ¶ç»„ä»¶èµ‹äºˆçš„æ–‡æœ¬â€ï¼š\n1 2 3 { fatherText: props.text; } è¯¥å¯¹è±¡å¹¶ä¸ä¼šæ›¿æ¢æ‰ç»„ä»¶åŸå§‹çš„è¿™ä¸ª stateï¼š\n1 this.state = { text: \u0026#34;å­ç»„ä»¶çš„æ–‡æœ¬\u0026#34; }; è€Œæ˜¯ä»…ä»…é’ˆå¯¹ fatherText è¿™ä¸ªå±æ€§ä½œæ›´æ–°ï¼ˆè¿™é‡ŒåŸæœ‰çš„ state é‡Œæ²¡æœ‰ fatherTextï¼Œå› æ­¤ç›´æ¥æ–°å¢ï¼‰ã€‚æ›´æ–°åï¼ŒåŸæœ‰å±æ€§ä¸æ–°å±æ€§æ˜¯å…±å­˜çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Updating é˜¶æ®µï¼šç»„ä»¶çš„æ›´æ–° React 16.4 çš„æŒ‚è½½å’Œå¸è½½æµç¨‹éƒ½æ˜¯ä¸ React 16.3 ä¿æŒä¸€è‡´çš„ï¼Œå·®å¼‚åœ¨äºæ›´æ–°æµç¨‹ä¸Šï¼š\nåœ¨ React 16.4 ä¸­ï¼Œä»»ä½•å› ç´ è§¦å‘çš„ç»„ä»¶æ›´æ–°æµç¨‹ï¼ˆåŒ…æ‹¬ç”± this.setState å’Œ forceUpdate è§¦å‘çš„æ›´æ–°æµç¨‹ï¼‰éƒ½ä¼šè§¦å‘ getDerivedStateFromPropsï¼›\nè€Œåœ¨ v 16.3 ç‰ˆæœ¬æ—¶ï¼Œåªæœ‰çˆ¶ç»„ä»¶çš„æ›´æ–°ä¼šè§¦å‘è¯¥ç”Ÿå‘½å‘¨æœŸã€‚\nä¸ºä»€ä¹ˆè¦ç”¨ getDerivedStateFromProps ä»£æ›¿ componentWillReceivePropsï¼Ÿ åšåˆç†çš„å‡æ³•ï¼š\ngetDerivedStateFromProps ç›´æ¥è¢«å®šä¹‰ä¸º static æ–¹æ³•ï¼Œstatic æ–¹æ³•å†…éƒ¨æ‹¿ä¸åˆ°ç»„ä»¶å®ä¾‹çš„ thisï¼Œè¿™å°±å¯¼è‡´ä½ æ— æ³•åœ¨ getDerivedStateFromProps é‡Œé¢åšä»»ä½•ç±»ä¼¼äº this.fetch()ã€ä¸åˆç†çš„ this.setStateï¼ˆä¼šå¯¼è‡´æ­»å¾ªç¯çš„é‚£ç§ï¼‰è¿™ç±»å¯èƒ½ä¼šäº§ç”Ÿå‰¯ä½œç”¨çš„æ“ä½œã€‚ è¿™æ˜¯ React 16 åœ¨å¼ºåˆ¶æ¨è¡Œâ€œåªç”¨ getDerivedStateFromProps æ¥å®Œæˆ props åˆ° state çš„æ˜ å°„â€è¿™ä¸€æœ€ä½³å®è·µã€‚æ„åœ¨ç¡®ä¿ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„è¡Œä¸ºæ›´åŠ å¯æ§å¯é¢„æµ‹ï¼Œä»æ ¹æºä¸Šå¸®å¼€å‘è€…é¿å…ä¸åˆç†çš„ç¼–ç¨‹æ–¹å¼ï¼Œé¿å…ç”Ÿå‘½å‘¨æœŸçš„æ»¥ç”¨ï¼›åŒæ—¶ï¼Œä¹Ÿæ˜¯åœ¨ä¸ºæ–°çš„ Fiber æ¶æ„é“ºè·¯ã€‚ æ¶ˆå¤±çš„ componentWillUpdate ä¸æ–°å¢çš„ getSnapshotBeforeUpdate(prevProps, prevState) getSnapshotBeforeUpdate æ–¹æ³•éœ€è¦ä¸€ä¸ªè¿”å›å€¼ï¼Œå®ƒçš„è¿”å›å€¼ä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ç»™åˆ° componentDidUpdateã€‚å®ƒçš„æ‰§è¡Œæ—¶æœºæ˜¯åœ¨ render æ–¹æ³•ä¹‹åï¼ŒçœŸå® DOM æ›´æ–°ä¹‹å‰ã€‚åœ¨è¿™ä¸ªé˜¶æ®µé‡Œï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶è·å–åˆ°æ›´æ–°å‰çš„çœŸå® DOM å’Œæ›´æ–°å‰åçš„ state\u0026amp;props çš„ä¿¡æ¯ã€‚\né‡ç‚¹æŠŠæ¡å®ƒä¸ componentDidUpdate é—´çš„é€šä¿¡è¿‡ç¨‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 // ç»„ä»¶æ›´æ–°æ—¶è°ƒç”¨ getSnapshotBeforeUpdate(prevProps, prevState) { console.log(\u0026#34;getSnapshotBeforeUpdateæ–¹æ³•æ‰§è¡Œ\u0026#34;); return \u0026#34;haha\u0026#34;; } // ç»„ä»¶æ›´æ–°åè°ƒç”¨ componentDidUpdate(prevProps, prevState, valueFromSnapshot) { console.log(\u0026#34;componentDidUpdateæ–¹æ³•æ‰§è¡Œ\u0026#34;); console.log(\u0026#34;ä» getSnapshotBeforeUpdate è·å–åˆ°çš„å€¼æ˜¯\u0026#34;, valueFromSnapshot); } è¿™ä¸ªç”Ÿå‘½å‘¨æœŸçš„è®¾è®¡åˆè¡·ï¼Œæ˜¯ä¸ºäº†â€œä¸ componentDidUpdate ä¸€èµ·ï¼Œæ¶µç›–è¿‡æ—¶çš„ componentWillUpdate çš„æ‰€æœ‰ç”¨ä¾‹â€ã€‚getSnapshotBeforeUpdate è¦æƒ³å‘æŒ¥ä½œç”¨ï¼Œç¦»ä¸å¼€ componentDidUpdate çš„é…åˆã€‚\nReact16 ä¸ºä½•ä¸¤æ¬¡æ±‚å˜ï¼Ÿ Fiber ä¼šä½¿åŸæœ¬åŒæ­¥çš„æ¸²æŸ“è¿‡ç¨‹å˜æˆå¼‚æ­¥çš„ã€‚ åŒæ­¥æ›´æ–°ä¸å¼‚æ­¥æ›´æ–°å¯¹æ¯” Demo\nåŒæ­¥æ¸²æŸ“çš„é€’å½’è°ƒç”¨æ ˆæ˜¯éå¸¸æ·±çš„ï¼Œåªæœ‰æœ€åº•å±‚çš„è°ƒç”¨è¿”å›äº†ï¼Œæ•´ä¸ªæ¸²æŸ“è¿‡ç¨‹æ‰ä¼šå¼€å§‹é€å±‚è¿”å›ã€‚è¿™ä¸ªæ¼«é•¿ä¸”ä¸å¯æ‰“æ–­çš„æ›´æ–°è¿‡ç¨‹ï¼Œå°†ä¼šå¸¦æ¥ç”¨æˆ·ä½“éªŒå±‚é¢çš„å·¨å¤§é£é™©ï¼šåŒæ­¥æ¸²æŸ“ä¸€æ—¦å¼€å§‹ï¼Œä¾¿ä¼šæŠ“ä½ä¸»çº¿ç¨‹ä¸æ”¾ï¼Œç›´åˆ°é€’å½’å½»åº•å®Œæˆã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨æ²¡æœ‰åŠæ³•å¤„ç†ä»»ä½•æ¸²æŸ“ä¹‹å¤–çš„äº‹æƒ…ï¼Œä¼šè¿›å…¥ä¸€ç§æ— æ³•å¤„ç†ç”¨æˆ·äº¤äº’çš„çŠ¶æ€ã€‚å› æ­¤è‹¥æ¸²æŸ“æ—¶é—´ç¨å¾®é•¿ä¸€ç‚¹ï¼Œé¡µé¢å°±ä¼šé¢ä¸´å¡é¡¿ç”šè‡³å¡æ­»çš„é£é™©ã€‚\nè€Œ React 16 å¼•å…¥çš„ Fiber æ¶æ„ï¼Œæ°å¥½èƒ½å¤Ÿè§£å†³æ‰è¿™ä¸ªé£é™©ï¼šFiber ä¼šå°†ä¸€ä¸ªå¤§çš„æ›´æ–°ä»»åŠ¡æ‹†è§£ä¸ºè®¸å¤šä¸ªå°ä»»åŠ¡ã€‚æ¯å½“æ‰§è¡Œå®Œä¸€ä¸ªå°ä»»åŠ¡æ—¶ï¼Œæ¸²æŸ“çº¿ç¨‹éƒ½ä¼šæŠŠä¸»çº¿ç¨‹äº¤å›å»ï¼Œè°ƒåº¦å™¨ä¼šçœ‹æœ‰æ²¡æœ‰ä¼˜å…ˆçº§æ›´é«˜çš„å·¥ä½œè¦å¤„ç†ï¼Œç¡®ä¿ä¸ä¼šå‡ºç°å…¶ä»–ä»»åŠ¡è¢«â€œé¥¿æ­»â€çš„æƒ…å†µï¼Œè¿›è€Œé¿å…åŒæ­¥æ¸²æŸ“å¸¦æ¥çš„å¡é¡¿ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¸²æŸ“çº¿ç¨‹ä¸å†â€œä¸€å»ä¸å›å¤´â€ï¼Œè€Œæ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œå¼‚æ­¥æ¸²æŸ“â€ã€‚\næ¢ä¸ªè§’åº¦çœ‹ç”Ÿå‘½å‘¨æœŸå·¥ä½œæµ Fiber æ¶æ„çš„é‡è¦ç‰¹å¾å°±æ˜¯å¯ä»¥è¢«æ‰“æ–­çš„å¼‚æ­¥æ¸²æŸ“æ¨¡å¼ã€‚ä½†è¿™ä¸ªâ€œæ‰“æ–­â€æ˜¯æœ‰åŸåˆ™çš„ï¼Œæ ¹æ®â€œèƒ½å¦è¢«æ‰“æ–­â€è¿™ä¸€æ ‡å‡†ï¼ŒReact 16 çš„ç”Ÿå‘½å‘¨æœŸè¢«åˆ’åˆ†ä¸ºäº† render å’Œ commit ä¸¤ä¸ªé˜¶æ®µï¼Œè€Œ commit é˜¶æ®µåˆè¢«ç»†åˆ†ä¸ºäº† pre-commit å’Œ commitã€‚æ¯ä¸ªé˜¶æ®µæ‰€æ¶µç›–çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\næ€»çš„æ¥è¯´ï¼Œrender é˜¶æ®µåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å…è®¸è¢«æ‰“æ–­ï¼Œè€Œ commit é˜¶æ®µåˆ™æ€»æ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚\nä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼Œç”±äº render é˜¶æ®µçš„æ“ä½œå¯¹ç”¨æˆ·æ¥è¯´å…¶å®æ˜¯â€œä¸å¯è§â€çš„ï¼Œæ‰€ä»¥å°±ç®—æ‰“æ–­å†é‡å¯ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ä¹Ÿæ˜¯é›¶æ„ŸçŸ¥ã€‚è€Œ commit é˜¶æ®µçš„æ“ä½œåˆ™æ¶‰åŠçœŸå® DOM çš„æ¸²æŸ“ï¼Œè¿™ä¸ªè¿‡ç¨‹å¿…é¡»ç”¨åŒæ­¥æ¸²æŸ“ã€‚\nç”Ÿå‘½å‘¨æœŸå˜æ›´çš„è€ƒé‡ åœ¨ Fiber æœºåˆ¶ä¸‹ï¼Œrender é˜¶æ®µæ˜¯å…è®¸æš‚åœã€ç»ˆæ­¢å’Œé‡å¯çš„ã€‚å½“ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œåˆ°ä¸€åŠè¢«æ‰“æ–­åï¼Œä¸‹ä¸€æ¬¡æ¸²æŸ“çº¿ç¨‹æŠ¢å›ä¸»åŠ¨æƒæ—¶ï¼Œè¿™ä¸ªä»»åŠ¡è¢«é‡å¯çš„å½¢å¼æ˜¯â€œé‡å¤æ‰§è¡Œä¸€éæ•´ä¸ªä»»åŠ¡â€è€Œéâ€œæ¥ç€ä¸Šæ¬¡æ‰§è¡Œåˆ°çš„é‚£è¡Œä»£ç å¾€ä¸‹èµ°â€ã€‚è¿™å°±å¯¼è‡´ render é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸéƒ½æ˜¯æœ‰å¯èƒ½è¢«é‡å¤æ‰§è¡Œçš„ã€‚\nå¸¦ç€è¿™ä¸ªç»“è®ºï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ React 16 æ‰“ç®—åºŸå¼ƒçš„æ˜¯å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼š\ncomponentWillMountï¼› componentWillUpdateï¼› componentWillReceivePropsã€‚ è¿™äº›ç”Ÿå‘½å‘¨æœŸçš„å…±æ€§ï¼Œå°±æ˜¯å®ƒä»¬éƒ½å¤„äº render é˜¶æ®µï¼Œéƒ½å¯èƒ½é‡å¤è¢«æ‰§è¡Œï¼Œè€Œä¸”ç”±äºè¿™äº› API å¸¸å¹´è¢«æ»¥ç”¨ï¼Œå®ƒä»¬åœ¨é‡å¤æ‰§è¡Œçš„è¿‡ç¨‹ä¸­éƒ½å­˜åœ¨ç€ä¸å¯å°è§‘çš„é£é™©ã€‚\nåœ¨â€œcomponentWillâ€å¼€å¤´çš„ç”Ÿå‘½å‘¨æœŸé‡Œï¼Œä½ ä¹ æƒ¯äºåšçš„äº‹æƒ…å¯èƒ½åŒ…æ‹¬ä½†ä¸é™äº:\nsetState()ï¼› fetch å‘èµ·å¼‚æ­¥è¯·æ±‚ï¼› æ“ä½œçœŸå® DOMã€‚ è¿™äº›æ“ä½œçš„é—®é¢˜ï¼ˆæˆ–ä¸å¿…è¦æ€§ï¼‰åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹ 3 ç‚¹ï¼š\nå®Œå…¨å¯ä»¥è½¬ç§»åˆ°å…¶ä»–ç”Ÿå‘½å‘¨æœŸï¼ˆå°¤å…¶æ˜¯ componentDidxxxï¼‰é‡Œå»åšã€‚\næ¯”å¦‚åœ¨ componentWillMount é‡Œå‘èµ·å¼‚æ­¥è¯·æ±‚ï¼Œä»¥ä¸ºè¿™æ ·åšå°±å¯ä»¥æ›´å¿«å¾—åˆ°å¼‚æ­¥è¯·æ±‚è¿”å›çš„ç»“æœï¼Œä»è€Œé¿å…é¦–æ¬¡æ¸²æŸ“ç™½å±ã€‚\nä½†æ˜¯ï¼ˆReact 15 ä¸‹ï¼‰åŒæ­¥çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å¿…ç„¶å…ˆäºå¼‚æ­¥è¯·æ±‚æ‰§è¡Œã€‚componentWillMount ç»“æŸåï¼Œrender ä¼šè¿…é€Ÿåœ°è¢«è§¦å‘ï¼Œæ‰€ä»¥è¯´é¦–æ¬¡æ¸²æŸ“ä¾ç„¶ä¼šåœ¨æ•°æ®è¿”å›ä¹‹å‰æ‰§è¡Œã€‚è¿™æ ·åšä¸ä»…æ²¡æœ‰è¾¾åˆ°ä½ é¢„æƒ³çš„ç›®çš„ï¼Œè¿˜ä¼šå¯¼è‡´æœåŠ¡ç«¯æ¸²æŸ“åœºæ™¯ä¸‹çš„å†—ä½™è¯·æ±‚ç­‰é¢å¤–é—®é¢˜ã€‚\nåœ¨ Fiber å¸¦æ¥çš„å¼‚æ­¥æ¸²æŸ“æœºåˆ¶ä¸‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„ Bugã€‚\næ¯”å¦‚åœ¨ componentWillxxx é‡Œå‘èµ·äº†ä¸€ä¸ªä»˜æ¬¾è¯·æ±‚ã€‚ç”±äº render é˜¶æ®µé‡Œçš„ç”Ÿå‘½å‘¨æœŸéƒ½å¯ä»¥é‡å¤æ‰§è¡Œï¼Œåœ¨ componentWillxxx è¢«æ‰“æ–­ + é‡å¯å¤šæ¬¡åï¼Œå°±ä¼šå‘å‡ºå¤šä¸ªä»˜æ¬¾è¯·æ±‚ã€‚\nåˆæˆ–è€…ä½ å¯èƒ½ä¼šä¹ æƒ¯åœ¨ componentWillReceiveProps é‡Œæ“ä½œ DOMï¼ˆæ¯”å¦‚è¯´åˆ é™¤ç¬¦åˆæŸä¸ªç‰¹å¾çš„å…ƒç´ ï¼‰ï¼Œé‚£ä¹ˆ componentWillReceiveProps è‹¥æ˜¯æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œä½ å¯èƒ½å°±ä¼šä¸€å£æ°”åˆ æ‰ä¸¤ä¸ªç¬¦åˆè¯¥ç‰¹å¾çš„å…ƒç´ ã€‚\ngetDerivedStateFromProps ä¸ºä½•ä¼šåœ¨è®¾è®¡å±‚é¢ç›´æ¥è¢«çº¦æŸä¸ºä¸€ä¸ªè§¦ç¢°ä¸åˆ° this çš„é™æ€æ–¹æ³•ï¼Œå…¶èƒŒåçš„åŸå› ä¹Ÿå°±æ›´åŠ å……åˆ†äº†â€”â€”â€”é¿å…å¼€å‘è€…è§¦ç¢° thisï¼Œå°±æ˜¯åœ¨é¿å…å„ç§å±é™©çš„é”™è¯¯æ“ä½œã€‚\nå³ä½¿ä½ æ²¡æœ‰å¼€å¯å¼‚æ­¥ï¼ŒReact 15 ä¸‹ä¹Ÿæœ‰ä¸å°‘äººèƒ½æŠŠè‡ªå·±â€œç©æ­»â€ã€‚\næ¯”å¦‚åœ¨ componentWillReceiveProps å’Œ componentWillUpdate é‡Œæ»¥ç”¨ setState å¯¼è‡´é‡å¤æ¸²æŸ“æ­»å¾ªç¯çš„ã€‚\næ€»çš„æ¥è¯´ï¼ŒReact 16 æ”¹é€ ç”Ÿå‘½å‘¨æœŸçš„ä¸»è¦åŠ¨æœºæ˜¯ä¸ºäº†é…åˆ Fiber æ¶æ„å¸¦æ¥çš„å¼‚æ­¥æ¸²æŸ“æœºåˆ¶ã€‚åœ¨è¿™ä¸ªæ”¹é€ çš„è¿‡ç¨‹ä¸­ï¼ŒReact å›¢é˜Ÿé’ˆå¯¹ç”Ÿå‘½å‘¨æœŸä¸­é•¿æœŸè¢«æ»¥ç”¨çš„éƒ¨åˆ†æ¨è¡Œäº†å…·æœ‰å¼ºåˆ¶æ€§çš„æœ€ä½³å®è·µã€‚è¿™ä¸€ç³»åˆ—çš„å·¥ä½œåšä¸‹æ¥ï¼Œé¦–å…ˆæ˜¯ç¡®ä¿äº† Fiber æœºåˆ¶ä¸‹æ•°æ®å’Œè§†å›¾çš„å®‰å…¨æ€§ï¼ŒåŒæ—¶ä¹Ÿ ç¡®ä¿äº†ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„è¡Œä¸ºæ›´åŠ çº¯ç²¹ã€å¯æ§ã€å¯é¢„æµ‹ ã€‚\n","permalink":"https://zzydev.top/posts/headfirstreact/2_react%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/","summary":"React15 çš„ç”Ÿå‘½å‘¨æœŸ Mounting é˜¶æ®µï¼šç»„ä»¶çš„åˆå§‹åŒ–æ¸²æŸ“ æŒ‚è½½è¿‡ç¨‹åœ¨ç»„ä»¶çš„ä¸€ç”Ÿä¸­ä»…ä¼šå‘ç”Ÿä¸€æ¬¡ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç»„ä»¶è¢«åˆå§‹åŒ–ï¼Œç„¶åä¼šè¢«æ¸²æŸ“åˆ°çœŸå® DOM é‡Œï¼Œå®Œæˆâ€œé¦–æ¬¡æ¸²æŸ“â€","title":"2.Reactç”Ÿå‘½å‘¨æœŸ"},{"content":" JSX çš„æœ¬è´¨ï¼šJavaScript çš„è¯­æ³•ç³– JSX ä¼šè¢«ç¼–è¯‘ä¸º React.createElement()ï¼Œ React.createElement() å°†è¿”å›ä¸€ä¸ªå«ä½œâ€œReact Elementâ€çš„ JS å¯¹è±¡ã€‚\nBabel å…·å¤‡å°† JSX è¯­æ³•è½¬æ¢ä¸º javascript çš„èƒ½åŠ›\nBabel çš„åœ¨çº¿ playground\nJSX æ˜¯å¦‚ä½•æ˜ å°„ä¸º DOM çš„ createElement æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 //Reactçš„åˆ›å»ºå…ƒç´ æ–¹æ³• export function createElement(type, config, children) { // propName å˜é‡ç”¨äºå‚¨å­˜åé¢éœ€è¦ç”¨åˆ°çš„å…ƒç´ å±æ€§ let propName; // props å˜é‡ç”¨äºå‚¨å­˜å…ƒç´ å±æ€§çš„é”®å€¼å¯¹é›†åˆ const props = {}; // keyã€refã€selfã€source å‡ä¸º React å…ƒç´ çš„å±æ€§ï¼Œæ­¤å¤„ä¸å¿…æ·±ç©¶ let key = null; let ref = null; let self = null; let source = null; // config å¯¹è±¡ä¸­å­˜å‚¨çš„æ˜¯å…ƒç´ çš„å±æ€§ if (config != null) { // è¿›æ¥ä¹‹ååšçš„ç¬¬ä¸€ä»¶äº‹ï¼Œæ˜¯ä¾æ¬¡å¯¹ refã€keyã€self å’Œ source å±æ€§èµ‹å€¼ if (hasValidRef(config)) { ref = config.ref; } // æ­¤å¤„å°† key å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸² if (hasValidKey(config)) { key = \u0026#34;\u0026#34; + config.key; } self = config.__self === undefined ? null : config.__self; source = config.__source === undefined ? null : config.__source; // æ¥ç€å°±æ˜¯è¦æŠŠ config é‡Œé¢çš„å±æ€§éƒ½ä¸€ä¸ªä¸€ä¸ªæŒªåˆ° props è¿™ä¸ªä¹‹å‰å£°æ˜å¥½çš„å¯¹è±¡é‡Œé¢ for (propName in config) { if ( // ç­›é€‰å‡ºå¯ä»¥æè¿› props å¯¹è±¡é‡Œçš„å±æ€§ hasOwnProperty.call(config, propName) \u0026amp;\u0026amp; !RESERVED_PROPS.hasOwnProperty(propName) ) { props[propName] = config[propName]; } } } // childrenLength æŒ‡çš„æ˜¯å½“å‰å…ƒç´ çš„å­å…ƒç´ çš„ä¸ªæ•°ï¼Œå‡å»çš„ 2 æ˜¯ type å’Œ config ä¸¤ä¸ªå‚æ•°å ç”¨çš„é•¿åº¦ const childrenLength = arguments.length - 2; // å¦‚æœæŠ›å»typeå’Œconfigï¼Œå°±åªå‰©ä¸‹ä¸€ä¸ªå‚æ•°ï¼Œä¸€èˆ¬æ„å‘³ç€æ–‡æœ¬èŠ‚ç‚¹å‡ºç°äº† if (childrenLength === 1) { // ç›´æ¥æŠŠè¿™ä¸ªå‚æ•°çš„å€¼èµ‹ç»™props.children props.children = children; // å¤„ç†åµŒå¥—å¤šä¸ªå­å…ƒç´ çš„æƒ…å†µ } else if (childrenLength \u0026gt; 1) { // å£°æ˜ä¸€ä¸ªå­å…ƒç´ æ•°ç»„ const childArray = Array(childrenLength); // æŠŠå­å…ƒç´ æ¨è¿›æ•°ç»„é‡Œ for (let i = 0; i \u0026lt; childrenLength; i++) { childArray[i] = arguments[i + 2]; } // æœ€åæŠŠè¿™ä¸ªæ•°ç»„èµ‹å€¼ç»™props.children props.children = childArray; } // å¤„ç† defaultProps if (type \u0026amp;\u0026amp; type.defaultProps) { const defaultProps = type.defaultProps; for (propName in defaultProps) { if (props[propName] === undefined) { props[propName] = defaultProps[propName]; } } } // æœ€åè¿”å›ä¸€ä¸ªè°ƒç”¨ReactElementæ‰§è¡Œæ–¹æ³•ï¼Œå¹¶ä¼ å…¥åˆšæ‰å¤„ç†è¿‡çš„å‚æ•° return ReactElement( type, key, ref, self, source, ReactCurrentOwner.current, props ); } createElement å…¥å‚è§£æ 1 export function createElement(type, config, children) typeï¼šç”¨äºæ ‡è¯†èŠ‚ç‚¹çš„ç±»å‹ã€‚å®ƒå¯ä»¥æ˜¯ç±»ä¼¼â€œh1â€ã€â€œdivâ€è¿™æ ·çš„æ ‡å‡† HTML æ ‡ç­¾å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ React ç»„ä»¶ç±»å‹æˆ– React fragment ç±»å‹ã€‚ configï¼šä»¥å¯¹è±¡å½¢å¼ä¼ å…¥ï¼Œç»„ä»¶æ‰€æœ‰çš„å±æ€§éƒ½ä¼šä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨åœ¨ config å¯¹è±¡ä¸­ã€‚ childrenï¼šä»¥å¯¹è±¡å½¢å¼ä¼ å…¥ï¼Œå®ƒè®°å½•çš„æ˜¯ç»„ä»¶æ ‡ç­¾ä¹‹é—´åµŒå¥—çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œå­èŠ‚ç‚¹â€â€œå­å…ƒç´ â€ã€‚ createElement å‡½æ•°æ‹†è§£ createElement çš„æ¯ä¸€ä¸ªæ­¥éª¤å‡ ä¹éƒ½æ˜¯åœ¨æ ¼å¼åŒ–æ•°æ®\ncreateElement å°±åƒæ˜¯å¼€å‘è€…å’Œ ReactElement è°ƒç”¨ä¹‹é—´çš„ä¸€ä¸ªæ•°æ®å¤„ç†å±‚ã€‚å®ƒå¯ä»¥ä»å¼€å‘è€…å¤„æ¥å—ç›¸å¯¹ç®€å•çš„å‚æ•°ï¼Œç„¶åå°†è¿™äº›å‚æ•°æŒ‰ç…§ ReactElement çš„é¢„æœŸåšä¸€å±‚æ ¼å¼åŒ–ï¼Œæœ€ç»ˆé€šè¿‡è°ƒç”¨ ReactElement æ¥å®ç°å…ƒç´ çš„åˆ›å»ºã€‚æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\ncreateElement å‡ºå‚è§£æ ReactElement æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 const ReactElement = function (type, key, ref, self, source, owner, props) { const element = { // This tag allows us to uniquely identify this as a React Element $$typeof: REACT_ELEMENT_TYPE, // Built-in properties that belong on the element type: type, key: key, ref: ref, props: props, // Record the component responsible for creating this element. _owner: owner, }; if (DEV) { /*è¿™é‡Œæ˜¯ä¸€äº›é’ˆå¯¹ __DEV__ ç¯å¢ƒä¸‹çš„å¤„ç†ï¼Œå¯¹äºç†è§£ä¸»è¦é€»è¾‘æ„ä¹‰ä¸å¤§ï¼Œæ•…çœç•¥*/ } return element; }; æ‰“å°è¾“å‡º JSX éƒ¨åˆ†ï¼š\n1 2 3 4 5 6 7 8 const AppJSX = ( \u0026lt;div className=\u0026#34;App\u0026#34;\u0026gt; \u0026lt;h1 className=\u0026#34;title\u0026#34;\u0026gt;I am the title\u0026lt;/h1\u0026gt; \u0026lt;p className=\u0026#34;content\u0026#34;\u0026gt;I am the content\u0026lt;/p\u0026gt; \u0026lt;/div\u0026gt; ); console.log(AppJSX); ä½ ä¼šå‘ç°å®ƒç¡®å®æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ ReactElement å¯¹è±¡å®ä¾‹ï¼Œå¦‚ä¸‹å›¾ï¼š\nè¿™ä¸ª ReactElement å¯¹è±¡å®ä¾‹ï¼Œæœ¬è´¨ä¸Šæ˜¯ ä»¥ JavaScript å¯¹è±¡å½¢å¼å­˜åœ¨çš„å¯¹ DOM çš„æè¿° ï¼Œä¹Ÿå°±æ˜¯ è™šæ‹Ÿ DOM ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ ã€‚\nReact æä¾›äº†éªŒè¯åˆæ³• React Element çš„å…¨å±€ API React.isValidElementï¼Œæˆ‘ä»¬çœ‹ä¸‹ä»–çš„å®ç°ï¼š\n1 2 3 4 5 6 7 export function isValidElement(object) { return ( typeof object === \u0026#34;object\u0026#34; \u0026amp;\u0026amp; object !== null \u0026amp;\u0026amp; object.$$typeof === REACT_ELEMENT_TYPE ); } â€œè™šæ‹Ÿ DOMâ€éœ€è¦é€šè¿‡ ReactDOM.renderæ–¹æ³•ï¼Œå˜æˆæ¸²æŸ“åˆ°é¡µé¢ä¸Šçš„çœŸå® DOM\n","permalink":"https://zzydev.top/posts/headfirstreact/1_jsx%E6%98%AF%E5%A6%82%E4%BD%95%E5%8F%98%E6%88%90%E4%B8%BAdom%E7%9A%84/","summary":"JSX çš„æœ¬è´¨ï¼šJavaScript çš„è¯­æ³•ç³– JSX ä¼šè¢«ç¼–è¯‘ä¸º React.createElement()ï¼Œ React.createElement() å°†è¿”å›ä¸€ä¸ªå«ä½œâ€œReact Elementâ€çš„","title":"1.JSX æ˜¯å¦‚ä½•å˜æˆä¸º DOM çš„"}]